
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/introduccion_bioinformatica/practicos/TP08_Clustering_Data_Mining/">
      
      
      
      
      <link rel="icon" href="../../img/logo-unsam-negro.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Practico Ocho - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cabin";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-8-clustering-y-data-mining" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Practico Ocho
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="cyan"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="cyan"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Compartir" aria-label="Compartir" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Inicio

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../info/acerca/" class="md-tabs__link">
          
  
  
  Información General

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../teoricas/inicio/" class="md-tabs__link">
          
  
  
  Teóricas

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../inicio/" class="md-tabs__link">
          
  
  
  Prácticos

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../instructivos/inicio/" class="md-tabs__link">
          
  
  
  Instructivos

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Información General
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Información General
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/acerca/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>
  
  <span class="md-ellipsis">
    Acerca de la Materia
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/comollegar/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m15 19-6-2.11V5l6 2.11M20.5 3h-.16L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5a.5.5 0 0 0 .5.5c.05 0 .11 0 .16-.03L9 18.9l6 2.1 5.64-1.9c.21-.1.36-.25.36-.48V3.5a.5.5 0 0 0-.5-.5"/></svg>
  
  <span class="md-ellipsis">
    Cómo Llegar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/contenidos/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"/></svg>
  
  <span class="md-ellipsis">
    Programa
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/evaluacion/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 7 1.3 2.8 3.2-.4-2 2.6 1.9 2.5-3.2-.4L12 17l-1.3-2.8-3.2.4 2-2.6-1.9-2.5 3.2.4zm0-5L9.5 7.7 3.3 7 7 12l-3.6 5 6.2-.7L12 22l2.5-5.7 6.2.6L17 12l3.6-5-6.2.7z"/></svg>
  
  <span class="md-ellipsis">
    Evaluación
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/cronograma/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
  
  <span class="md-ellipsis">
    Cronograma
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/docentes/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M10.561 8.073a6 6 0 0 1 3.432 5.142.75.75 0 1 1-1.498.07 4.5 4.5 0 0 0-8.99 0 .75.75 0 0 1-1.498-.07 6 6 0 0 1 3.431-5.142 3.999 3.999 0 1 1 5.123 0M10.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0"/></svg>
  
  <span class="md-ellipsis">
    Docentes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Teóricas
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Teóricas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M120 56c0-30.9 25.1-56 56-56h24c17.7 0 32 14.3 32 32v448c0 17.7-14.3 32-32 32h-32c-29.8 0-54.9-20.4-62-48h-2c-44.2 0-80-35.8-80-80 0-18 6-34.6 16-48-19.4-14.6-32-37.8-32-64 0-30.9 17.6-57.8 43.2-71.1-7.1-12-11.2-26-11.2-40.9 0-44.2 35.8-80 80-80zm272 0v24c44.2 0 80 35.8 80 80 0 15-4.1 29-11.2 40.9C486.5 214.2 504 241 504 272c0 26.2-12.6 49.4-32 64 10 13.4 16 30 16 48 0 44.2-35.8 80-80 80h-2c-7.1 27.6-32.2 48-62 48h-32c-17.7 0-32-14.3-32-32V32c0-17.7 14.3-32 32-32h24c30.9 0 56 25.1 56 56"/></svg>
  
  <span class="md-ellipsis">
    Teórica 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M120 56c0-30.9 25.1-56 56-56h24c17.7 0 32 14.3 32 32v448c0 17.7-14.3 32-32 32h-32c-29.8 0-54.9-20.4-62-48h-2c-44.2 0-80-35.8-80-80 0-18 6-34.6 16-48-19.4-14.6-32-37.8-32-64 0-30.9 17.6-57.8 43.2-71.1-7.1-12-11.2-26-11.2-40.9 0-44.2 35.8-80 80-80zm272 0v24c44.2 0 80 35.8 80 80 0 15-4.1 29-11.2 40.9C486.5 214.2 504 241 504 272c0 26.2-12.6 49.4-32 64 10 13.4 16 30 16 48 0 44.2-35.8 80-80 80h-2c-7.1 27.6-32.2 48-62 48h-32c-17.7 0-32-14.3-32-32V32c0-17.7 14.3-32 32-32h24c30.9 0 56 25.1 56 56"/></svg>
  
  <span class="md-ellipsis">
    Teórica 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/3-Teorica-Tres/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M120 56c0-30.9 25.1-56 56-56h24c17.7 0 32 14.3 32 32v448c0 17.7-14.3 32-32 32h-32c-29.8 0-54.9-20.4-62-48h-2c-44.2 0-80-35.8-80-80 0-18 6-34.6 16-48-19.4-14.6-32-37.8-32-64 0-30.9 17.6-57.8 43.2-71.1-7.1-12-11.2-26-11.2-40.9 0-44.2 35.8-80 80-80zm272 0v24c44.2 0 80 35.8 80 80 0 15-4.1 29-11.2 40.9C486.5 214.2 504 241 504 272c0 26.2-12.6 49.4-32 64 10 13.4 16 30 16 48 0 44.2-35.8 80-80 80h-2c-7.1 27.6-32.2 48-62 48h-32c-17.7 0-32-14.3-32-32V32c0-17.7 14.3-32 32-32h24c30.9 0 56 25.1 56 56"/></svg>
  
  <span class="md-ellipsis">
    Teórica 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/4-Teorica-Cuatro/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M120 56c0-30.9 25.1-56 56-56h24c17.7 0 32 14.3 32 32v448c0 17.7-14.3 32-32 32h-32c-29.8 0-54.9-20.4-62-48h-2c-44.2 0-80-35.8-80-80 0-18 6-34.6 16-48-19.4-14.6-32-37.8-32-64 0-30.9 17.6-57.8 43.2-71.1-7.1-12-11.2-26-11.2-40.9 0-44.2 35.8-80 80-80zm272 0v24c44.2 0 80 35.8 80 80 0 15-4.1 29-11.2 40.9C486.5 214.2 504 241 504 272c0 26.2-12.6 49.4-32 64 10 13.4 16 30 16 48 0 44.2-35.8 80-80 80h-2c-7.1 27.6-32.2 48-62 48h-32c-17.7 0-32-14.3-32-32V32c0-17.7 14.3-32 32-32h24c30.9 0 56 25.1 56 56"/></svg>
  
  <span class="md-ellipsis">
    Teórica 4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prácticos
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Prácticos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25Zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM7.25 8a.75.75 0 0 1-.22.53l-2.25 2.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L5.44 8 3.72 6.28a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l2.25 2.25c.141.14.22.331.22.53m1.5 1.5h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5"/></svg>
  
  <span class="md-ellipsis">
    TP 1 - Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TP02_EMBOSS/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M246.9 18.3 271 3.8c21.6-13 46.3-19.8 71.5-19.8 36.8 0 72.2 14.6 98.2 40.7l63.9 63.9c15 15 23.4 35.4 23.4 56.6v30.9l19.7 19.7c15.6-15.6 40.9-15.6 56.6 0s15.6 40.9 0 56.6l-64 64c-15.6 15.6-40.9 15.6-56.6 0s-15.6-40.9 0-56.6L464 240h-30.9c-21.2 0-41.6-8.4-56.6-23.4l-49.1-49.1c-15-15-23.4-35.4-23.4-56.6V98.2c0-11.2-5.9-21.7-15.5-27.4l-41.6-25c-10.4-6.2-10.4-21.2 0-27.4zM50.7 402.7l222.1-222.1 90.5 90.5-222.1 222.1c-25 25-65.5 25-90.5 0s-25-65.5 0-90.5"/></svg>
  
  <span class="md-ellipsis">
    TP 2 - EMBOSS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TP03_Alineamientos/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M246.9 18.3 271 3.8c21.6-13 46.3-19.8 71.5-19.8 36.8 0 72.2 14.6 98.2 40.7l63.9 63.9c15 15 23.4 35.4 23.4 56.6v30.9l19.7 19.7c15.6-15.6 40.9-15.6 56.6 0s15.6 40.9 0 56.6l-64 64c-15.6 15.6-40.9 15.6-56.6 0s-15.6-40.9 0-56.6L464 240h-30.9c-21.2 0-41.6-8.4-56.6-23.4l-49.1-49.1c-15-15-23.4-35.4-23.4-56.6V98.2c0-11.2-5.9-21.7-15.5-27.4l-41.6-25c-10.4-6.2-10.4-21.2 0-27.4zM50.7 402.7l222.1-222.1 90.5 90.5-222.1 222.1c-25 25-65.5 25-90.5 0s-25-65.5 0-90.5"/></svg>
  
  <span class="md-ellipsis">
    TP 3 - Alineamientos de a pares
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TP04_Busqueda_por_similitud/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M246.9 18.3 271 3.8c21.6-13 46.3-19.8 71.5-19.8 36.8 0 72.2 14.6 98.2 40.7l63.9 63.9c15 15 23.4 35.4 23.4 56.6v30.9l19.7 19.7c15.6-15.6 40.9-15.6 56.6 0s15.6 40.9 0 56.6l-64 64c-15.6 15.6-40.9 15.6-56.6 0s-15.6-40.9 0-56.6L464 240h-30.9c-21.2 0-41.6-8.4-56.6-23.4l-49.1-49.1c-15-15-23.4-35.4-23.4-56.6V98.2c0-11.2-5.9-21.7-15.5-27.4l-41.6-25c-10.4-6.2-10.4-21.2 0-27.4zM50.7 402.7l222.1-222.1 90.5 90.5-222.1 222.1c-25 25-65.5 25-90.5 0s-25-65.5 0-90.5"/></svg>
  
  <span class="md-ellipsis">
    TP 4 - Búsqueda por similitud
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Instructivos
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Instructivos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/replit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Replit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/R/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R y Rstudio
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#slides-mostrados-en-clase" class="md-nav__link">
    <span class="md-ellipsis">
      Slides mostrados en clase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-a-usar" class="md-nav__link">
    <span class="md-ellipsis">
      Software a usar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursos-online" class="md-nav__link">
    <span class="md-ellipsis">
      Recursos Online
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objetivos" class="md-nav__link">
    <span class="md-ellipsis">
      Objetivos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduccion-al-tema" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción al tema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-1-clustering-jerarquico-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 1 - Clustering Manual
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-2-agrupando-flores-por-especies" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 2 - Agrupando flores por especies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicio 2 - Agrupando flores por especies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduccion-al-data-set" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción al data set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problema-a-resolver" class="md-nav__link">
    <span class="md-ellipsis">
      Problema a resolver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guardar-el-plot-en-un-pdf" class="md-nav__link">
    <span class="md-ellipsis">
      Guardar el plot en un PDF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clustering-jerarquico" class="md-nav__link">
    <span class="md-ellipsis">
      Clustering jerárquico
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Clustering jerárquico">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mejorar-el-plot-del-clustering-jerarquico" class="md-nav__link">
    <span class="md-ellipsis">
      Mejorar el plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-linkage" class="md-nav__link">
    <span class="md-ellipsis">
      Single Linkage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asignando-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Asignando clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hacer-clusters-y-plots" class="md-nav__link">
    <span class="md-ellipsis">
      Hacer clusters y plots
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k-means" class="md-nav__link">
    <span class="md-ellipsis">
      K-means
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#silhouette" class="md-nav__link">
    <span class="md-ellipsis">
      Silhouette
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios-adicionales" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicios adicionales
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-adicional-1-mejores-plots-ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio adicional 1 - Mejores plots: ggplot2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicio adicional 1 - Mejores plots: ggplot2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cambiar-la-estetica-del-plot-segun-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Estética variable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nombres-y-estilo-de-los-ejes-y-el-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Nombres de los ejes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fondo-del-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Fondo del plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#otros-tipos-de-plots" class="md-nav__link">
    <span class="md-ellipsis">
      Otros tipos de plots
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-adicional-2-analizando-el-efecto-de-dos-inhibidores" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio adicional 2 - Analizando el efecto de dos inhibidores
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicio adicional 2 - Analizando el efecto de dos inhibidores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leer-los-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Leer los datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estandarizar-los-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Estandarizar los datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combinar-las-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      Combinar las réplicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcular-el-fold-change" class="md-nav__link">
    <span class="md-ellipsis">
      Calcular el Fold Change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformar-el-fold-change" class="md-nav__link">
    <span class="md-ellipsis">
      Transformar el Fold Change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotear-el-heatmap" class="md-nav__link">
    <span class="md-ellipsis">
      Plotear el Heatmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcular-genes-mas-afectados" class="md-nav__link">
    <span class="md-ellipsis">
      Genes más afectados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buscar-nuestros-genes-en-bases-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Bases de datos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliografia" class="md-nav__link">
    <span class="md-ellipsis">
      Bibliografía
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bibliografía">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consola-de-r" class="md-nav__link">
    <span class="md-ellipsis">
      Consola de R
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div><p><a class="glightbox" href="img/clustering2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img _="," align="left" alt="Image" src="img/clustering2.png" width="250"></a></p>
<h1 id="tp-8-clustering-y-data-mining" markdown="markdown"><strong>TP 8</strong>. Clustering y Data Mining</h1>
<p><br>
<br></p>
<p><a class="md-button md-button--primary" href="https://drive.google.com/file/d/1zyjFtV2jWfCyJ4Pgw2ENtGBCJ1vRu6eO/view?usp=sharing"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M256 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v210.7l-41.4-41.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 242.7zM64 320c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64h-46.9l-56.6 56.6c-31.2 31.2-81.9 31.2-113.1 0L110.9 320zm304 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"></path></svg></span> Materiales</a></p>
<h3 id="slides-mostrados-en-clase">Slides mostrados en clase</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M208 48H96c-8.8 0-16 7.2-16 16v384c0 8.8 7.2 16 16 16h80v48H96c-35.3 0-64-28.7-64-64V64C32 28.7 60.7 0 96 0h133.5c17 0 33.3 6.7 45.3 18.7l122.5 122.6c12 12 18.7 28.3 18.7 45.3v149.5h-48v-128h-88c-39.8 0-72-32.2-72-72v-88zm140.1 112L256 67.9V136c0 13.3 10.7 24 24 24zM240 380h32c33.1 0 60 26.9 60 60s-26.9 60-60 60h-12v28c0 11-9 20-20 20s-20-9-20-20V400c0-11 9-20 20-20m32 80c11 0 20-9 20-20s-9-20-20-20h-12v40zm96-80h32c28.7 0 52 23.3 52 52v64c0 28.7-23.3 52-52 52h-32c-11 0-20-9-20-20V400c0-11 9-20 20-20m32 128c6.6 0 12-5.4 12-12v-64c0-6.6-5.4-12-12-12h-12v88zm76-108c0-11 9-20 20-20h48c11 0 20 9 20 20s-9 20-20 20h-28v24h28c11 0 20 9 20 20s-9 20-20 20h-28v44c0 11-9 20-20 20s-20-9-20-20z"></path></svg></span> <a href="https://drive.google.com/file/d/1rsqPLINlb0HquB66hj4aSr6GcCd0xbvq/view?usp=sharing">Slides</a></li>
</ul>
<h3 id="software-a-usar">Software a usar</h3>
<ul>
<li>R (ya instalado en la VM).</li>
<li>RStudio (ya instalado en la VM)</li>
</ul>
<h3 id="recursos-online">Recursos Online</h3>
<ul>
<li>Introducción a <strong>R</strong>, <strong>TPP</strong> de esta materia: <a href="../TPPa_Programando_en_Biologia/">Parte 1</a> y <a href="../TPPb_Programando_en_Biologia/">Parte 2</a></li>
<li><a href="https://www.datanovia.com/en/lessons/agglomerative-hierarchical-clustering/">Clustering jerárquico en <strong>R</strong></a></li>
<li><a href="https://www.cienciadedatos.net/documentos/37_clustering_y_heatmaps#Average_silhouette_method">Detalles del cálculo de Silhouette (y mucho más)</a></li>
<li><a href="https://www.coursera.org/learn/r-programming">Curso online de R de Coursera</a> (se puede hacer gratis) (en ese caso no da certificado)</li>
<li>Data Tables: <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html">Introducción oficial</a> y <a href="https://bookdown.org/paradinas_iosu/CursoR/data-table.html">otra página con más info</a></li>
<li>ggplot2: <a href="https://bookdown.org/paradinas_iosu/CursoR/ggplot2.html">Vistazo rápido</a>, <a href="http://sthda.com/english/wiki/ggplot2-essentials">detalles sobre los tipos de plots</a>, <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> e <a href="https://jfly.uni-koeln.de/color/">información sobre colores y daltonismo</a></li>
<li>dendextend: <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/dendextend.html">Detalle del paquete</a></li>
</ul>
<h3 id="objetivos">Objetivos</h3>
<ul>
<li>Familiarizarse con el funcionamiento del <em>clustering jerárquico aglomerativo</em>.</li>
<li>Familiarizarse con el método de clustering particional <em>K-means</em>.</li>
<li>Explorar algunas medidas de calidad de los clusters, como la silueta o <em>silhouette</em>.</li>
<li>Usar métodos de clustering con herramientas de programación para resolver problemas biológicos</li>
</ul>
<h2 id="introduccion-al-tema"><strong>Introducción al tema</strong></h2>
<p>Hoy vamos a retomar el trabajo con <strong>R</strong>. Recomendamos repasar o tener a mano los TPPs de esta materia por si necesitan recordar como hacer ciertos comandos (<a href="../TPPa_Programando_en_Biologia/">Parte 1</a> y <a href="../TPPb_Programando_en_Biologia/">Parte 2</a>).</p>
<p>Como mencionamos en los <strong>TPPs</strong>, es cada vez más normal que experimentos biológicos nos permitan analizar miles a millones de interacciones biológicas a la vez, lo que resulta en tablas con millones de datos. Esto hace necesario entonces saber utilizar herramientas que nos permitan extraer, o <em>minar</em>, información de estos enormes conjuntos de datos. A este proceso lo vamos a denominar <em>Data Mining</em>.</p>
<p>En este TP nos vamos a enfocar en métodos de clustering, los cuales nos permiten agrupar elementos analizados en base a datos observados sobre ellos. Esto tiene muchas utilidades, como puede ser entender mejor las diferencias entre grupos conocidos, encontrar diferentes grupos dentro del conjunto datos analizado, o remover datos redundantes, entre otros.</p>
<p>Si bien este TP vamos a enfocarnos más que nada en aprender las técnicas, el objetivo final de este proceso es identificar agrupamientos naturales en los datos con alguna relevancia biológica.</p>
<h2 id="ejercicio-1-clustering-jerarquico-manual" markdown="markdown"><strong>Ejercicio 1 - Clustering Jerárquico Manual</strong></h2>
<p>Para empezar este TP vamos a realizar un pequeño <em>clustering jerárquico</em> a mano para repasar el concepto.</p>
<p>Supongamos que tenemos cuatro genes (A, B, C y D) para los cuales medimos el nivel de expresión a las 0hs, 1hs y 2hs luego de algún tratamiento:</p>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">gen</th>
<th data-sort-method="none" style="text-align: center;">t_0h</th>
<th data-sort-method="none" style="text-align: center;">t_1h</th>
<th data-sort-method="none" style="text-align: center;">t_2h</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">genA</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: center;">genB</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-2</td>
</tr>
<tr>
<td style="text-align: center;">genC</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">genD</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-6</td>
</tr>
</tbody>
</table>
</figure>
<p>Queremos entonces agrupar a los diferentes genes por como varían sus niveles de expresión cuando se aplica dicho tratamiento. Para hacer esto vamos a:</p>
<p><strong>1.</strong> Calcular la distancia euclidiana entre los diferentes genes</p>
<p><strong>2.</strong> Construir una matriz de distancias</p>
<p><strong>3.</strong> Agruparlos usando <em>clustering jerárquico</em> donde el criterio de agregación va a ser "vecino más lejano" o <em>complete linkage</em></p>
<p><strong>4.</strong> Armar un esquema del dendograma o árbol de similitud que resulta de este clustering</p>
<p><strong>5.</strong> Repetir todo lo anterior, pero estandarizando previamente los datos de niveles de expresión</p>
<p>Si no entienden algunos de estos conceptos pueden leer un poco más sobre ellos a continuación (y más todavía en la teórica):</p>
<details class="info">
<summary>Distancia euclidiana</summary>
<p>Es una de las varias formas de calcular una distancia entre dos vectores de datos, lo cual es necesario al momento de calcular una matriz de distancias. Por ejemplo, suponiendo que tenemos 2 vectores de forma <span class="arithmatex">\(V = (x, y, z)\)</span> la distancia euclidiana entre ellos se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclidiana(V_1, V_2) = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2}
\]</div>
<p>Aplicando esto a nuestros datos, la distancia entre los genes A y B se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclidiana(genA, genB) = \sqrt{(2 - (-1))^2 + (4 - (-1))^2 + (8 - (-2))^2} = 11,58
\]</div>
</details>
<details class="info">
<summary>Matriz de distancias</summary>
<p>Es una matriz donde tanto las filas como las columnas representan un mismo conjunto de elementos y en cada intersección se pone la distancia (en nuestro caso euclidiana) entre dos elementos específicos. Es la base de muchos métodos de clustering.</p>
<p>Para nuestros datos la matriz de distancias entre los cuatro genes es:</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th data-sort-method="none" style="text-align: center;">genA</th>
<th data-sort-method="none" style="text-align: center;">genB</th>
<th data-sort-method="none" style="text-align: center;">genC</th>
<th data-sort-method="none" style="text-align: center;">genD</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">genA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genB</td>
<td style="text-align: center;">11,58</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genC</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">3,32</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genD</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">4,12</td>
<td style="text-align: center;">7,35</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p>Como el orden de los elementos es igual para las filas que para las columnas, en la diagonal se compara cada elemento contra sí mismo por lo que la distancia es 0. Por otro lado, estamos llenando solo la mitad de la matriz ya que las matrices de distancia son matrices simétricas, es decir, que el triángulo superior derecho de la matriz va a ser un reflejo del triángulo inferior izquierdo.</p>
</details>
<details class="info">
<summary>Clustering jerárquico</summary>
<p>El <em>clustering jerárquico</em> es una forma de agrupar elementos dependiendo de que tan similares son entre ellos. Usa un algoritmo bastante sencillo de entender que se basa en una matriz de distancias:</p>
<ol>
<li>
<p>Sin considerar a la diagonal, encontrar el par de elementos (fila, columna) que son más similares entre sí (el menor número en la matriz de distancias). En nuestra matriz de distancias los elementos más parecidos son <strong>"genB"</strong> y <strong>"genC"</strong> ya que tienen la menor similitud (3,32)</p>
</li>
<li>
<p>Dejar constancia de dicha similitud y reconstruir la matriz, reemplazando ambos elementos por uno nuevo (saco los elementos <strong>"genB"</strong> y <strong>"genC"</strong> y agrego el elemento <strong>"genB+C"</strong>)</p>
</li>
<li>
<p>Al momento de calcular la nueva distancia entre este nuevo elemento (<strong>"genB+C"</strong>) y el resto de los elementos de la matriz, usar algún criterio de agregación (por ejemplo: <em>single linkage</em>, <em>average linkage</em> o <em>complete linkage</em>)</p>
</li>
<li>
<p>Volver al paso 1 hasta que todos los elementos estén unidos entre sí</p>
</li>
</ol>
<p>Una vez hecho esto puedo dibujar el <em>clustering jerárquico</em> teniendo en cuenta qué elementos se juntaron con qué elementos.</p>
</details>
<details class="info">
<summary>Criterios de agregación</summary>
<p>Los criterios de agregación indican que operación hay que hacer al momento de calcular la distancia entre un nuevo elemento creado en una matriz de distancias y los ya existentes. Cada uno tiene sus ventajas y desventajas.</p>
<p>Siguiendo con nuestro ejemplo, si queremos calcular la distancia entre el nuevo elemento <strong>"genB+C"</strong> y el <strong>"genA"</strong>:</p>
<ul>
<li><strong>Single Linkage:</strong> la nueva distancia es la <strong><em>menor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Complete Linkage:</strong> la nueva distancia es la <strong><em>mayor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Average Linkage:</strong> la nueva distancia es el <strong><em>promedio</em></strong> de las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
</ul>
</details>
<p>Para simplificar las cuentas durante la clase, les dejamos acá la tabla con los datos estandarizados. Para estandarizar, restamos a cada dato el promedio de los tres tiempos para ese gen y dividimos el resultado por la desviación estándar de los tres tiempos para ese gen, es decir:</p>
<div class="arithmatex">\[
datoEstandarizado(genA, t_0) = \frac{dato(genA, t_0) - promedio(genA)}{desviacionEstandar(genA)}
\]</div>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">gen</th>
<th data-sort-method="none" style="text-align: center;">t_0h</th>
<th data-sort-method="none" style="text-align: center;">t_1h</th>
<th data-sort-method="none" style="text-align: center;">t_2h</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">genA</td>
<td style="text-align: center;">-0.87</td>
<td style="text-align: center;">-0.22</td>
<td style="text-align: center;">1.09</td>
</tr>
<tr>
<td style="text-align: center;">genB</td>
<td style="text-align: center;">0.58</td>
<td style="text-align: center;">0.58</td>
<td style="text-align: center;">-1.15</td>
</tr>
<tr>
<td style="text-align: center;">genC</td>
<td style="text-align: center;">-1.09</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.87</td>
</tr>
<tr>
<td style="text-align: center;">genD</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">-1.14</td>
</tr>
</tbody>
</table>
</figure>
<p><strong>6.</strong> Comparando los clusterings obtenidos con los datos estandarizados y sin estandarizar.</p>
<ol>
<li>
<p>¿Qué diferencias observan?</p>
</li>
<li>
<p>¿Cuál de los dos clusterings les parece mejor para este escenario donde queríamos evaluar cómo afecta un tratamiento los niveles de expresión de diferentes genes?</p>
</li>
<li>
<p>¿Les parece qué es siempre correcto estandarizar los datos de esta forma o se les ocurre escenarios donde no es así?</p>
</li>
</ol>
<h2 id="ejercicio-2-agrupando-flores-por-especies" markdown="markdown"><strong>Ejercicio 2 - Agrupando flores por especies</strong></h2>
<h3 id="introduccion-al-data-set">Introducción al data set</h3>
<p>En este ejercicio vamos a trabajar una vez más con el data set <strong>iris</strong>, el cual es un set de datos que viene por defecto con <strong>R</strong> y está siempre cargado en memoria.</p>
<p>Este data set contiene las medidas de ancho (<em>width</em>) y largo (<em>length</em>) de los sépalos y los pétalos para 3 especies de flores diferentes: setosa, versicolor, y virginica (todas del Genus <em>Iris</em>). Tiene mediciones de 150 flores, 50 por especie.</p>
<details class="info">
<summary>Sépalo vs pétalo</summary>
<p><figure markdown>
<a class="glightbox" href="img/sepal_vs_petal.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="SepalPetal" max-width="400" src="img/sepal_vs_petal.png"></a>
</figure></p>
</details>
<p>Antes que nada vamos a familiarizarnos un poco con este data set.</p>
<p><strong>1)</strong> Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Transformo a iris en un *Data Table* (que aca realmente no hace falta, pero para despues)</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1">#Hago un plot comparando el largo de los sepalos y los petalos</span>
<span class="c1">#Estoy cambiando la forma y el color segun la especie</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>Podemos ver que con solo plotear el largo de los pétalos y los sépalos ya estamos viendo diferencias entre las especies. Es teóricamente posible agregar una tercera dimensión para plotear otra de las variables, e incluso agregar la cuarta variable como "tamaño" de los diferentes puntos, pero dichos plots van a resultar considerablemente mas complejos al momento de leerlos.</p>
<h3 id="problema-a-resolver">Problema a resolver</h3>
<p>En este ejercicio vamos a suponer que alguien apretó el botón equivocado y borró la columna <strong>Species</strong> de dicha tabla. Como nos acordamos de que eran tres especies y que tenían diferencias en sus largos y anchos de pétalos y sépalos, queremos entonces usar métodos de clustering para tratar de recuperar lo mejor que podamos los tres grupos de flores.</p>
<p>Dicho esto vamos a hacer un poco de trampa y vamos a comparar visualmente lo que vamos obteniendo por los métodos de clustering con lo que nosotros sabemos es verdad.</p>
<p>Por último, cómo vamos a tener que hacer varios plots similares, vamos a aprovechar la oportunidad y vamos a usar por primera vez funciones de <strong>R</strong> creadas por nosotros.</p>
<h3 id="guardar-el-plot-en-un-pdf">Guardar el plot en un PDF</h3>
<p>Vamos a crear una función que guarde diferentes plots como PDFs.</p>
<p><strong>2)</strong> Copien el siguiente código y modifiquen las secciones que dicen <code>@@EDITAR@@</code>. Para esto vean el punto <strong>1)</strong> y asígnenle a cada parámetro de la función el valor que tenía en dicho punto, por ejemplo <code>x_colname = "Sepal.Length"</code> (el nombre de las columnas vá entre comillas porque estamos usando <code>aes_string()</code> y no <code>aes()</code>). Una vez hecho esto, corran la función para replicar el plot hecho en el punto <strong>1)</strong> y guardarlo en un archivo llamado <strong>01_Sepal_vs_Petal_Length_per_Species.pdf</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Código</label><label for="__tabbed_1_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#### FUNCIONES AUXILIARES ####</span>
<span class="n">plotData2PDF_wColor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">data_par</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color_colname</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">y_label</span><span class="p">,</span><span class="w"> </span><span class="n">plot_title</span><span class="p">,</span>
<span class="w">                                </span><span class="n">pdf_file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_par</span><span class="p">,</span><span class="w"> </span><span class="nf">aes_string</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_colname</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">xlab</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ylab</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="w">    </span><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="nf">dev.off</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">#### CODIGO PRINCIPAL ####</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="nf">plotData2PDF_wColor</span><span class="p">(</span><span class="n">data_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">color_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">plot_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w">                        </span>
<span class="w">                    </span><span class="n">pdf_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"01_Sepal_vs_Petal_Length_per_Species.pdf"</span><span class="p">)</span><span class="w">    </span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Estoy usando comentarios rodeados de cuatro numerales para delimitar secciones de mi código </span>
<span class="c1">#Esto no es puramente estético, sino que también es aprovechado por *RStudio* para crear una de barra de </span>
<span class="c1">#navegación del código (es la barra horizontal entre el script y la consola)</span>
<span class="c1">#### FUNCIONES AUXILIARES ####</span>
<span class="n">plotData2PDF_wColor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">data_par</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color_colname</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">y_label</span><span class="p">,</span><span class="w"> </span><span class="n">plot_title</span><span class="p">,</span>
<span class="w">                                </span><span class="n">pdf_file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#La función *aes_string()* es similar a *aes()*, solo que en este caso los nombres de las columnas </span>
<span class="w">    </span><span class="c1">#tienen que ser *strings* (recuerden que con *aes()* se escriben sin comillas)</span>
<span class="w">    </span><span class="c1">#Esto es ideal para cuando el nombre de la columna utilizar esta guardado en una variable</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_par</span><span class="p">,</span><span class="w"> </span><span class="nf">aes_string</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_colname</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">xlab</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ylab</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="w">    </span><span class="c1">#*pdf()* "abre" un archivo pdf. Todo lo que se imprima hasta cerrarlo va a ir a él, </span>
<span class="w">    </span><span class="c1">#en vez de a la pestaña *Plots* de *RStudio*</span>
<span class="w">    </span><span class="c1">#8 y 7 indican el ancho y el alto del pdf en pulgadas</span>
<span class="w">    </span><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="c1">#La función *dev.off()* cierra el plot abierto, en este caso el pdf.</span>
<span class="w">    </span><span class="nf">dev.off</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">#### CODIGO PRINCIPAL ####</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="nf">plotData2PDF_wColor</span><span class="p">(</span><span class="n">data_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">color_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">plot_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w">      </span>
<span class="w">                    </span><span class="n">pdf_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"01_Sepal_vs_Petal_Length_per_Species.pdf"</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>3)</strong> Usando la función que acabamos de crear, vean como se distribuyen los puntos al comparar <strong>Sepal.Width</strong> contra <strong>Petal.Width</strong>. Guarden este plot en un archivo llamado <strong>02_Sepal_vs_Petal_Width_per_Species.pdf</strong>.</p>
<h3 id="clustering-jerarquico">Clustering jerárquico</h3>
<p>Lo primero que vamos a hacer entonces es usar un clustering jerárquico para agrupar a las 150 filas en 3 grupos según los valores de las 4 medidas. Un problema que tenemos es que por ahora no hay ninguna forma de identificar a una fila específica, así que le vamos a agregar un ID numérico a cada fila. Debido al orden que tienen las filas de <strong>dt_iris</strong>, los primeros 50 IDs van a corresponder a flores de la especie setosa, los segundos 50 a versicolor y los últimos a virginica (aunque supuestamente esto no lo sabemos).</p>
<p><strong>4)</strong> Corran el siguiente código para crear la matriz de datos que vamos a usar al momento de clusterizar. Lean los comentarios en la segunda pestaña para entender que estamos haciendo.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Código</label><label for="__tabbed_2_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">dt_iris</span><span class="o">$</span><span class="n">row_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">])</span>

<span class="nf">setcolorder</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"row_id"</span><span class="p">))</span>

<span class="n">matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">)],</span><span class="w"> </span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">#Agregamos una nueva columna denominada row_id que tiene un numero entre 1 y 150</span>
<span class="c1">#dt_iris[, .N] es una función de *Data Tables* que me devuelve el numero de filas en la tabla</span>
<span class="c1">#El numero de filas tambien se puede conseguir haciendo nrow(dt_iris)</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">row_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">])</span>

<span class="c1">#Aca estamos cambiando el orden de las columnas a *dt_iris*.</span>
<span class="c1">#No hace falta asignar esto a *dt_iris* ya que *setcolorder* modifica la variable misma </span>
<span class="c1">#Como solo le estamos pasando 1 columna, lo que estamos haciendo es mover esa columna al principio</span>
<span class="c1">#(al usar así *setcolorder* las otras se quedan donde estan)</span>
<span class="nf">setcolorder</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"row_id"</span><span class="p">))</span>

<span class="c1">#Similar a lo que hicimos en el TP anterior, estamos transformando nuestros datos a una matriz</span>
<span class="c1">#donde la primer columna (en este caso *row_id*) va a transformarse en los nombres de las filas</span>
<span class="c1">#Estamos sacando a la columna *Species* ya que queremos simular que no tenemos esta informacion</span>
<span class="c1">#(la columna *Species* va a estar todavia en *dt_iris*, pero no en *matriz_datos*)</span>
<span class="n">matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">)],</span><span class="w"> </span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>5)</strong> Usando la matriz de datos recién creada:</p>
<p><strong>5.1)</strong> Usen la función <code>dist()</code> para crear una matriz de distancias euclidianas que muestre también la diagonal.</p>
<div class="highlight"><pre><span></span><code><span class="n">matriz_distancias</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dist</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"euclidean"</span><span class="p">,</span><span class="w"> </span><span class="n">diag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Donde method = "euclidean" le está diciendo a la función dist que tiene que calcular las distancias euclidianas entre filas y diag = T hace que deje la diagonal de ceros en el output.</p>
<p><strong>5.2)</strong> Creen un clustering jerárquico basado en la matriz de distancias usando el criterio de agregación <em>complete linkage</em>. El <em>clustering jerárquico</em> se hace con la función <code>hclust</code>, la cual se usa:</p>
<div class="highlight"><pre><span></span><code><span class="n">clustering_jerarquico</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hclust</span><span class="p">(</span><span class="n">matriz_distancias</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"complete"</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>method = "complete"</code> está indicándole a la función que criterio de agregación usar al momento de combinar elementos. Pueden usar <code>help(hclust)</code> para ver otros posibles criterios.</p>
<p><strong>5.3)</strong> Usen la función <code>plot</code> para plotear <code>clustering_jerarquico</code>. Usen el parámetro <code>main</code> para cambiarle el título al plot indicando que es un <em>clustering jerárquico</em>, que usa <em>complete linkage</em>.</p>
<p><strong>5.4)</strong> Mirando el plot recién creado, ¿les es fácil distinguir a simple vista los tres grupos de especies en el clustering jerárquico? (recuerden que pueden usar el botón <strong>Zoom</strong> para agrandar el plot).</p>
<h4 id="mejorar-el-plot-del-clustering-jerarquico" markdown="markdown">Mejorar el plot del clustering jerárquico</h4>
<p><strong>6)</strong> Una cosa que vendría bien al momento de leer el plot recién creado sería colorear cada flor dependiendo de su especie. Si bien esto no es posible en este caso usando solo la función <code>plot()</code>, hay paquetes de <strong>R</strong> que nos van a permitir hacer esto:</p>
<p><strong>6.1)</strong> Usen la función <code>install.packages()</code> e instalen la librería <strong>dendextend</strong> (recuerden que al usar <code>install.packages()</code> el nombre del paquete va entre comillas). Luego corran el siguiente código:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Código</label><label for="__tabbed_3_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dendextend</span><span class="p">)</span>

<span class="c1">#Estoy asumiendo que guardaron la salida de *hclust()* en una variable llamada clustering_jerarquico</span>
<span class="c1">#De no ser asi, cambien el nombre de la variable a continuacion por lo que corresponda</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.dendrogram</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">)</span>

<span class="n">colores_especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">)</span>
<span class="n">colors_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">colores_especies</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="nf">labels_colors</span><span class="p">(</span><span class="n">dend</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colors_aux</span><span class="p">[</span><span class="nf">order.dendrogram</span><span class="p">(</span><span class="n">dend</span><span class="p">)]</span>

<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dend</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="s">"labels_cex"</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span>

<span class="n">pdf_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"11_Clustering_jerarquico_complete_linkage.pdf"</span>
<span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dend</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Clustering Jerárquico - Complete Linkage - Color per Species"</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dendextend</span><span class="p">)</span>

<span class="c1">#Estoy asumiendo que guardaron la salida de *hclust()* en una variable llamada clustering_jerarquico</span>
<span class="c1">#De no ser asi, cambien el nombre de la variable a continuacion por lo que corresponda</span>
<span class="c1">#Aca estoy transformando la variable *clustering_jerarquico* que es de tipo *hclust* a un *dendrogram*, </span>
<span class="c1">#que es una variable usada por el paquete *dendextend*</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.dendrogram</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">)</span>

<span class="c1">#La funcion *labels_colors()* me permite asignar a mano los colores para los 150 labels del dendrograma</span>
<span class="c1">#Ahora bien, yo se que originalmente en la tabla las primera 50 filas corresponden al color 1 y asi</span>
<span class="c1">#Lo que estoy haciendo aca es armar una lista de 150 colores ordenada como esta en la tabla original y luego</span>
<span class="c1">#reordenarlas para que coincidan con el orden de los IDs en el dendrograma</span>
<span class="n">colores_especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">)</span>
<span class="n">colors_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">colores_especies</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="nf">labels_colors</span><span class="p">(</span><span class="n">dend</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colors_aux</span><span class="p">[</span><span class="nf">order.dendrogram</span><span class="p">(</span><span class="n">dend</span><span class="p">)]</span>

<span class="c1">#Esto simplemente es para achicar un poco el texto de los labels para que no choquen entre si</span>
<span class="c1">#El simbolo %&gt;% cumple una funcion similar al + en ggplot</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dend</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="s">"labels_cex"</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span>

<span class="c1">#Creo el pdf de salida y guardo el clustering jerárquico</span>
<span class="n">pdf_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"11_Clustering_jerarquico_complete_linkage.pdf"</span>
<span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dend</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Clustering Jerárquico - Complete Linkage - Color per Species"</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>6.2)</strong> Abran el archivo <strong>11_Clustering_jerarquico_complete_linkage.pdf</strong>. ¿Pueden ahora distinguir los tres grupos de especies en el clustering jerárquico? ¿Cuáles especies les parecen mejor agrupadas? (los colores de las especies corresponden al color usado en el plot creado en los puntos <strong>1)</strong> y <strong>2)</strong>)</p>
<h4 id="single-linkage">Single Linkage</h4>
<p><strong>7)</strong> Hasta el momento sólo utilizamos <em>complete linkage</em> al momento de hacer nuestros clustering jerárquicos, pero sería interesante ver como es el dendrograma resultante de hacer el clustering usando otro criterio de agregación, por ejemplo el <em>single linkage</em>. Para esto:</p>
<p><strong>7.1)</strong> Vuelvan a correr la función <code>hclust()</code> como en <strong>5.2)</strong>, pero ahora usen <code>method = "single"</code> y guarden el clustering resultante en una nueva variable. Luego usen el código de <strong>6.1)</strong> editando lo que sea necesario para crear un archivo que contenga al dendrograma hecho a partir del clustering jerárquico que usa <em>single linkage</em> como criterio de agregación. Nombren a este archivo <strong>12_Clustering_jerarquico_single_linkage.pdf</strong>.</p>
<p><strong>7.2)</strong> ¿Qué diferencias ven entre este dendrograma y el creado en <strong>6.2)</strong>? ¿Pueden relacionar estas diferencias con lo que saben de <em>single linkage</em> y <em>complete linkage</em>?</p>
<p><strong>7.3)</strong> Ignorando los colores, ¿cuál les parece el mejor criterio de agregación para este caso donde queremos recuperar tres clusters?</p>
<h4 id="asignando-clusters">Asignando clusters</h4>
<p>Cuando uno mira el árbol creado en el punto <strong>6)</strong> es común detectar que ciertas flores son más similares entre sí que otras, y suponer que entonces pertenecen a un mismo grupo. Esto se puede calcular computacionalmente "cortando" el árbol usando un cierto umbral de similitud y agrupando en un mismo <em>cluster</em> a aquellos elementos que queden por debajo de ese umbral.</p>
<p>Esto se puede hacer de dos formas, o determinando el umbral de similitud o determinando la cantidad de <em>clusters</em> a crear.</p>
<div class="highlight"><pre><span></span><code><span class="n">clusters_porAltura</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cutree</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
<span class="n">clusters_porCantidad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cutree</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>h</code> es el parámetro que recibe la altura de similitud a la cual cortar (eje y en el plot anterior) y <code>k</code> es el parámetro que recibe la cantidad de <em>clusters</em> a crear. Hay que usar uno o el otro.</p>
<h4 id="hacer-clusters-y-plots">Hacer clusters y plots</h4>
<p>Por último vamos a querer recrear el plot generado en los puntos <strong>1)</strong> y <strong>2)</strong>, pero ahora mostrando información tanto de las especies originales (con el color) como de la agrupación resultante del clustering jerárquico (con la forma). Vamos a utilizar los datos del clustering jerárquico que usa el criterio de agregación <em>complete linkage</em>.</p>
<p><strong>8)</strong> Lo primero es entonces agregar la información del clustering jerárquico a nuestro <strong>dt_iris</strong>; para ello:</p>
<p><strong>8.1)</strong> Usen la <code>cutree</code> para dividir a los datos obtenidos en <strong>5.2)</strong> en 3 clusters.</p>
<p><strong>8.2)</strong> Asignen esa información a una nueva columna en la tabla <strong>dt_iris</strong> llamada <strong>CJ_cluster</strong> (como en este caso <code>cutree()</code> devuelve los datos en el mismo orden que están en la tabla se puede hacer directamente con <code>&lt;-</code>, no hace falta usar <code>merge()</code>).</p>
<p><strong>8.3)</strong> Por el momento la variable es numérica, pero para nosotros los números 1, 2 y 3 son categorías que teóricamente corresponden a las especies (aunque no sabemos qué categoría corresponde a que especie). Corran el siguiente código para convertir la columna recién creada en un <em>factor</em>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#En este caso poner los levels a mano no es 100% necesario, pero no viene mal</span>
<span class="c1">#Recuerden que no sabemos que numero corresponde a que especie</span>
<span class="c1">#(porque ademas ya vimos que no hay un match perfecto 1 a 1)</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">CJ_cluster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">dt_iris</span><span class="o">$</span><span class="n">CJ_cluster</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
</code></pre></div>
<p><strong>9)</strong> Ahora queremos hacer un plot similar al creado en el punto <strong>2)</strong>, pero donde la columna <strong>Species</strong> determine el color y la columna <strong>CJ_cluster</strong> determine la forma de los diferentes puntos del plot; para ello:</p>
<p><strong>9.1)</strong> Copien la función <code>plotData2PDF_wColor()</code> y cámbienle en nombre a <code>plotData2PDF_wColorAndShape()</code>. Modifiquen esta nueva función considerando lo siguiente:</p>
<ul>
<li>Agreguen un parámetro a la función el cual va a recibir el nombre de la columna que determina la forma, o <em>shape</em>, de los puntos.</li>
<li>Modifiquen la función <code>aes_string()</code>, agregando la característica <code>shape</code> y asignándole el valor del parámetro agregado.</li>
<li>Agreguen la función <code>scale_shape_manual()</code> a <code>ggplot</code> para definir a mano las tres formas. Usen los valores <code>c(2, 4, 1)</code>.</li>
</ul>
<p><strong>9.2)</strong> Usando la función que acabamos de crear, vean como se distribuyen los puntos al comparar <strong>Sepal.Length</strong> contra <strong>Petal.Length</strong> usando la columna <strong>Species</strong> para determinar el color y la columna <strong>CJ_cluster</strong> para determinar la forma de los diferentes puntos. Guarden este plot en un archivo llamado <strong>21_Sepal_vs_Petal_Length_per_Species_CJ3.pdf</strong>.</p>
<p><strong>9.3)</strong> Abran el archivo recién creado. ¿Cuáles especies les parecen mejor agrupadas? Entre este plot y el dendrograma creado en <strong>11_Clustering_jerarquico_complete_linkage.pdf</strong> ¿Cuál les parece la mejor manera de representar este clustering? ¿Por qué?</p>
<div class="admonition danger">
<p class="admonition-title">Importante - Clustering vs Plot</p>
<p>Tengan en cuenta que al momento de clusterizar estamos usando los datos de las cuatro columnas de la tabla. Sin embargo, en este último plot estamos viendo solo la relación entre dos. Por esta razón, este plot no es realmente representativo del clustering que estamos haciendo.</p>
<p>Dicho todo esto, este plot es útil ya que es mucho más fácil de leer que otros plots más complejos, pero debe tomarse como un análisis exploratorio.</p>
</div>
<h3 id="k-means">K-means</h3>
<p>Otro método muy popular para agrupar elementos es el <em>K-means</em>. A diferencia del <em>clustering jerárquico</em>, éste no crea un árbol de similitud, sino que utiliza un método iterativo para asignar directamente cada elemento a diferentes grupos. Otra característica del <em>K-means</em> es que hay que pasarle el número de clusters a crear.</p>
<p>La función <code>kmeans</code> viene con <strong>R</strong> y se usa:</p>
<p></p><div class="highlight"><pre><span></span><code><span class="c1">#Esta funcion controla el aspecto azaroso de kmeans para que nos de igual a todos</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">#Corro la funcion kmeans para la matriz de datos pidiendole 3 clusters</span>
<span class="n">clustering_kmeans_k3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">kmeans</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">,</span><span class="w"> </span><span class="n">centers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>

<span class="c1">#Extraigo los clusters calculados</span>
<span class="n">clusters_kmeans_k3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">clustering_kmeans_k3</span><span class="o">$</span><span class="n">cluster</span>
</code></pre></div>
Donde <code>centers = 3</code> le está diciendo a la función que cree 3 clusters (lo que estoy indicando en el nombre de la variable con <strong>_k3</strong> para que el nombre de la variable sea descriptivo).
<div class="admonition tip">
<p class="admonition-title">Tip - Predeterminar el azar</p>
<p>La función <code>kmeans()</code> genera la primera posición de sus centros al azar. Esto hace que si la corren varias veces o en diferentes computadoras va a dar diferentes resultados cada vez. Esto se puede controlar con una función de <strong>R</strong> que asigna a mano el valor de la <em>seed</em>, que es el número base que usa <strong>R</strong> al momento de generar azar. Si les interesa hacer esto tienen que ejecutar la siguiente línea antes de usar la función <code>kmeans()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p>P.D.: El azar en las computadoras no existe realmente. Muchos programas usan lista pre-generadas de "números creados al azar" y otras usan cosas como "el quinto decimal de la temperatura del procesador en este momento", lo que se aproxima suficientemente al azar para funcionar bien.</p>
</div>
<p><strong>10)</strong> Comparen los clusters obtenidos utilizando <code>kmeans()</code> contra los clusters a los obtenidos previamente usando <em>clustering jerárquico</em>. Para eso:</p>
<ul>
<li>Usen la función <code>kmeans()</code> para crear un nuevo clustering. Usen la cantidad de <code>centers</code> que consideren necesarios.</li>
<li>Extraigan los clusters del clustering recién creado y asígnenlos a una nueva columna en <strong>dt_iris</strong> llamada <strong>K3_cluster</strong> (como en este caso <code>kmeans()</code> devuelve los datos en el mismo orden que están en la tabla se puede hacer directamente con <code>&lt;-</code>, no hace falta usar <code>merge()</code>).</li>
<li>Transformen dicha columna en un <em>factor</em>.</li>
<li>Usando la función creada en el punto <strong>9)</strong>, vean como se distribuyen los puntos al comparar <strong>Sepal.Length</strong> contra <strong>Petal.Length</strong> usando la columna <strong>Species</strong> para determinar el color y la columna <strong>K3_cluster</strong> para determinar la forma de los diferentes puntos. Guarden este plot en un archivo llamado <strong>22_Sepal_vs_Petal_Length_per_Species_K3.pdf</strong>.</li>
</ul>
<p><strong>10.2)</strong> Abran el archivo recién creado. Basándose solo en lo que pueden observar en este plot, ¿pueden decir algo de si este agrupamiento es mejor, peor o similar al obtenido con el clustering jerárquico? (recuerden que "no" también es una respuesta válida)</p>
<h3 id="silhouette">Silhouette</h3>
<p>Para cada elemento presente en un agrupamiento se puede calcular un <em>Silhouette coeficient</em>, el cual es un número entre -1 y 1 que indica que tan similar es dicho elemento a otros elementos de su mismo <em>cluster</em> y que tan diferente es dicho elemento a los elementos de otros <em>clusters</em>. Cuanto más cerca de 1, mejor asignado esta dicho elemento en su <em>cluster</em>.</p>
<p>Es posible entonces calcular el promedio de los <em>Silhouette coefficients</em> de todos los elementos presentes en un agrupamiento, donde promedios más cercanos a 1 van a indicar que el agrupamiento general es mejor.</p>
<p>Este método tiene bastantes usos, pero uno de los más comunes es definir cuál es el número ideal de clusters a crear con <em>K-means</em>. </p>
<!--
La función `silhouette` no viene por defecto con **R**. Corran el siguiente código para instalar el paquete `cluster`:

<div class="highlight"><pre><span></span><code><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;cluster&quot;</span><span class="p">)</span>
</code></pre></div>
-->

<p>En <strong>R</strong> Esta función se usa:</p>
<p></p><div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span><span class="w"> </span><span class="c1">#paquete que contiene la funcion silhouette()</span>

<span class="c1">#Calculo los silhouette coefficients para los datos agrupados en 3 clusters usando kmeans </span>
<span class="c1">#Tengo que pasarle tambien la matriz de distancias correspondiente para que pueda calcular similitud entre elementos</span>
<span class="n">silhouette_kmeans_k3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">silhouette</span><span class="p">(</span><span class="n">clusters_kmeans_k3</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matriz_distancias</span><span class="p">)</span>

<span class="c1">#La funcion *silhouette* saca los nombres de las filas.</span>
<span class="c1">#Para recuperar los nombres de las filas (o *rownames*) hago lo siguiente</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">silhouette_kmeans_k3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span>

<span class="c1">#Podemos plotear los silhouette coefficients con plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">silhouette_kmeans_k3</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Kmeans - centers = 2"</span><span class="p">)</span>

<span class="c1">#Y podemos extraer el promedio de los *Silhouette coefficients*</span>
<span class="n">promedio_silhouette_kmeans_k3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">silhouette_kmeans_k3</span><span class="p">)[[</span><span class="m">1</span><span class="p">]][[</span><span class="s">"Mean"</span><span class="p">]]</span>
</code></pre></div>
<strong>11)</strong> Corran el código anterior y vean su salida.
<p><strong>11.1)</strong> Supongamos ahora que estamos en un escenario real, por lo que no tenemos información de a que especie corresponde cada punto. Evalúen objetivamente cual es el mejor clustering de los realizados</p>
<h2 id="ejercicios-adicionales">Ejercicios adicionales</h2>
<div class="admonition info">
<p class="admonition-title">Sobre los ejercicios adicionales</p>
<p>Recomendamos hacer los ejercicios extra de este TP!</p>
<p>El primero les enseña a realizar gráficos usando <code>ggplot2</code> y a personalizarlos, por lo que van a aprender un poco mas sobre como mostrar sus datos. </p>
<p>El segundo, es la continuación del TPP 2, donde van a poder aplicar los conceptos de clustering en un estudio de transcriptómica. Es un ejercicio integrador, similar a lo que se haría trabajando en un laboratorio. En este punto pueden que les surjan dudas conceptuales sobre que están haciendo en cada paso, no duden en usar discord!</p>
</div>
<h2 id="ejercicio-adicional-1-mejores-plots-ggplot2"><strong>Ejercicio adicional 1 - Mejores plots: ggplot2</strong></h2>
<p>En el <strong>TPP 1</strong> mencionamos rápidamente al paquete <code>ggplot2</code>, el cual es uno de las formas más populares de hacer plots en <strong>R</strong>. Este paquete es bastante complicado y tiene un sinfín de funcionalidades, pero hoy vamos a darle un vistazo a su funcionalidad básica (el <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> es una forma rápida de ver todas las posibilidades que tiene).</p>
<p>Un ejemplo muy simple de hacer un plot con la función <code>ggplot</code> sería:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Recuerden que *iris* es un *Data Frame* para hacer pruebas que esta siempre cargado en la memoria de R</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><strong>p</strong> es una variable en la que estoy guardando el plot. Cuando la imprimo (usando <code>print</code>) el plot va a aparecer en la pestaña <strong>Plots</strong> en <strong>RStudio</strong> (en el panel de abajo a la derecha).</li>
<li><code>data = iris</code> le está indicando a la función <code>ggplot</code> de que tabla va a sacar la información a plotear. En <code>ggplot</code> se pueden usar <em>Data Frames</em> o <em>Data Tables</em> indistintamente.</li>
<li><code>aes()</code> es una función que se encuentra dentro de la función principal de <code>ggplot</code>. Se va a encargar de relacionar las diferentes columnas de la tabla con las diferentes variables del plot.</li>
<li><code>x = Petal.Length</code> está indicando que la variable X en el plot va a ser los datos de la columna <strong>Petal.Length</strong>.</li>
<li><code>y = Sepal.Length</code> está indicando que la variable Y en el plot va a ser los datos de la columna <strong>Sepal.Length</strong>.</li>
<li><code>geom_point()</code> está indicando el tipo de plot a realizar. Si leen el <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> van a ver que en este caso estamos haciendo un scatter plot.</li>
<li>Ambas funciones del plot están separadas por el símbolo <code>+</code>, lo que les puede resultar un poco extraño (porque lo es), pero así es como funciona <code>ggplot</code>.</li>
</ul>
<p><strong>1)</strong> Corran el código anterior y vean el plot resultante.</p>
<h3 id="cambiar-la-estetica-del-plot-segun-variables" markdown="markdown">Cambiar la estética del plot según variables</h3>
<p>La función <code>aes()</code> recibe su nombre de la palabra en inglés <em>aesthetics</em>, o estética. No es de extrañar entonces que dentro de dicha función es donde podemos poner otras variables que determinen los colores, formas o tamaños de cada punto del plot (entre otras características).</p>
<p><strong>2)</strong> Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>En este código, <code>color = Species</code> le está diciendo a <code>ggplot</code> que modifique el color de los puntos dependiendo del valor de la columna <strong>Species</strong>. Si recuerdan a <strong>iris</strong>, esta columna era una columna categórica (o <em>factor</em>) con 3 valores que podemos ver en el plot. Como le pasamos a <code>color</code> una variable categórica, nos devolvió una escala de colores categórica.</p>
<p><strong>3)</strong> Corran el código anterior, pero ahora reemplacen a <strong>Species</strong> por <strong>Petal.Width</strong>, ¿qué cambios observan?</p>
<p><strong>4)</strong> Es posible también modificar varias de estas características a la vez. Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>En este caso agregamos 2 características nuevas, <code>shape</code> (la forma de los puntos) y <code>size</code> (el tamaño de los puntos) y le asignamos cada uno de ellos a una variable de la tabla. Noten que no hay problema con que una columna modifique más de una característica a la vez.</p>
<p><strong>5)</strong> Tal vez ya lo notaron, pero por el momento no tenemos ningún control sobre que colores o formas le asigna <code>ggplot</code> a mis tres categorías. Vamos a mostrarles como hacerlo para este caso específico, pero sepan que las funciones a usar son ligeramente diferentes dependiendo si la variable pasada es discreta o continua. </p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Los colores se pueden escribir en ingles o en hexadecimal</span>
<span class="c1">#"#FF0000" es el color rojo (se podría haber puesto "red")</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>scale_colour_manual()</code>: me permite modificar a mano una escala discreta de colores. El parámetro <code>values</code> modifica los colores en sí.</li>
<li><code>scale_shape_manual()</code>: me permite modificar a mano una escala discreta de formas. El parámetro <code>values</code> modifica las formas, las cuales corresponden a un número entero (en el tip a continuación se muestran las más comunes).</li>
</ul>
<p>Un detalle importante a destacar es que el orden en que se asignó cada color a cada categoría depende del orden en el que aparecen los <em>Levels</em> de la columna <strong>Species</strong>, la cual es un <em>factor</em> (pueden imprimir <code>iris$Species</code> para ver a lo que nos referimos). </p>
<details class="tip">
<summary>Tip - Posibles valores para <code>shape</code></summary>
<p><figure markdown>
<a class="glightbox" href="img/points-symbols.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ShapeSymbols" max-width="500" src="img/points-symbols.png"></a>
</figure></p>
<p>El color interior las formas 21 a 25 depende de la variable <code>fill</code> que no mencionamos todavía, pero se usa igual que el resto.</p>
</details>
<details class="tip">
<summary>Tip - Colores y daltonismo</summary>
<p>El daltonismo ocurre cuando hay un problema con los pigmentos en ciertas células nerviosas del ojo que perciben el color. Estas células se llaman conos y los hay de tres tipos, los cuales son responsables de ver principalmente al rojo, al verde y al azul respectivamente. </p>
<p><figure markdown>
<a class="glightbox" href="img/colorblind_rainbow.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ColorblindRainbow" src="img/colorblind_rainbow.jpg"></a>  <br>
</figure></p>
<p>La frecuencia del daltonismo es bastante alta, con un 8% de los hombres caucásicos, 5% de los asiáticos y 4% de los africanos presentando problemas para distinguir el color rojo del verde. Como la mayoría de los casos de daltonismo provienen de una mutación de un gen recesivo ligado al cromosoma X, muy pocas mujeres son daltónicas.</p>
<p>Debido al considerable número de personas con daltonismo, es buena ídea tener en cuenta esto al momento de elegir colores para cualquier figura que vaya a ser vistas por el público general. Se pueden encontrar decenas de herramientas online que nos ayudan a crear esto, así como paquetes de <strong>R</strong> o paletas de colores. Un ejemplo de una paleta de colores sería:</p>
<p><figure markdown>
<a class="glightbox" href="img/colorblind_pallete.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ColorblindPallete" src="img/colorblind_pallete.jpg"></a>  <br>
</figure></p>
<p>Pueden leer más información sobre este tema <a href="https://jfly.uni-koeln.de/color/">aca</a>.</p>
</details>
<details class="tip">
<summary>Tip - Asignar colores específicos a cada característica sin depender del orden de los <em>Levels</em></summary>
<p>Si bien el código anterior funciona perfecto, depender del orden de los <em>Levels</em> de un <em>factor</em> al momento de matchear color con un valor dado puede ser peligroso. Una forma de estar seguros que le estamos asignando el color correcto a cada valor es usando vectores con nombres (o <em>named vectors</em>). Algo mencionamos de estos vectores en el pasado, pero básicamente son vectores donde cada posición tiene un nombre (además del índice). En este caso sería:</p>
<div class="highlight"><pre><span></span><code><span class="n">categorias</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"setosa"</span><span class="p">,</span><span class="w"> </span><span class="s">"versicolor"</span><span class="p">,</span><span class="w"> </span><span class="s">"virginica"</span><span class="p">)</span>
<span class="n">colores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">colores</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">categorias</span>

<span class="c1">#Puedo acceder a "blue" haciendo `colores[2]` o `colores["versicolor"]`</span>
</code></pre></div>
<p>De hacer <code>scale_colour_manual(values = colores)</code> en la función <code>ggplot</code> nos aseguraríamos que el primer elemento de <code>categorias</code> va a tener el primer color de <code>colores</code> y así.</p>
</details>
<p><strong>6)</strong> Por último, ¿qué pasa si no queremos cambiar la estética del plot dependiendo del valor de una variable, sino que simplemente queremos cambiarla y que afecte a todos los puntos por igual? En estos casos hay que modificar dicha característica dentro de la función específica del plot.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<h3 id="nombres-y-estilo-de-los-ejes-y-el-plot" markdown="markdown">Nombres y estilo de los ejes y el plot</h3>
<p><strong>7)</strong> Ahora que ya modificamos bastante el estilo de los datos, vamos a modificar el resto del plot. Lo primero que vamos a hacer es cambiar el nombre del eje X, el eje Y y el título del plot.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>xlab()</code>: indica el nombre del eje X</li>
<li><code>ylab()</code>: indica el nombre del eje Y</li>
<li><code>ggtitle()</code>: indica el título del plot</li>
</ul>
<p><strong>8)</strong> Si bien obtuvimos lo deseado, puede ser que queramos cambiar el tamaño de los ejes o centrar el título. Esto lo hacemos con la función <code>theme()</code>:</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
</span><span class="hll"><span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
</span><span class="hll"><span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>theme()</code>: es la función que contiene el estilo del texto de los ejes y del título de un plot.</li>
<li><code>plot.title = element_text(size = 16, hjust = 0.5)</code>: estamos modificando el titulo del plot, donde <code>size</code> modifica el tamaño de letra y <code>hjust = 0.5</code> lo centra horizontalmente.</li>
<li><code>axis.title = element_text(size = 14)</code>: estamos modificando los títulos de los ejes (es decir, los nombre de los ejes).</li>
<li><code>axis.text = element_text(size = 12)</code>: estamos modificando el tamaño de los números de los ejes.</li>
</ul>
<p>Noten que dentro de <code>theme()</code> cada línea se separa con comas, y recién una vez que termina volvemos a usar el símbolo <code>+</code>.</p>
<h3 id="fondo-del-plot">Fondo del plot</h3>
<p><strong>9)</strong> Lo último que nos queda por modificar es el "fondo" del plot, es decir, el color de fondo, las líneas que corresponden a las divisiones de los ejes y el recuadro general del plot. Si bien esto se puede hacer a mano, <strong>ggplot</strong> viene con algunas opciones ya armadas.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">    </span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>theme_bw()</code> es una función que setea varias opciones de <code>theme()</code> a un estilo específico (en este caso un estilo simple en blanco y negro). La tenemos que usar antes de <code>theme()</code> para asegurarnos que cualquier cambio que hagamos a mano en <code>theme()</code> sobrescriba los de <code>theme_bw()</code>.</li>
</ul>
<!--
**10)** Reemplacen a `theme_bw()` por `theme_` y vean la lista de temas que aparecen en el autocompletar de RStudio (si no aparece pueden apretar ++ctrl++ + ++space++). Prueben correr el código anterior con 2 temas que no sean `theme_bw()` y vean como se ve el plot en cada caso.
-->

<h3 id="otros-tipos-de-plots">Otros tipos de plots</h3>
<p>Si bien la mayoría de lo que les mencionamos hasta ahora es aplicable al uso general de <strong>ggplot</strong>, hasta el momento nos enfocamos en un solo tipo de plot, el scatter plot, hecho mediante <code>geom_point()</code>.</p>
<p>Debido a que esto es suficiente para lo que necesitamos hacer hoy,no vamos a hablar hoy de otros tipos de plots, pero si les interesa pueden verlo con mucho detalle en <a href="http://sthda.com/english/wiki/ggplot2-essentials">esta página</a> o ver un vistazo rápido en la <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a>.</p>
<h2 id="ejercicio-adicional-2-analizando-el-efecto-de-dos-inhibidores" markdown="markdown"><strong>Ejercicio adicional 2 - Analizando el efecto de dos inhibidores</strong></h2>
<p>En el <strong>TPP 2</strong> hicimos un ejercicio donde usábamos el equipo <strong>FilterMax F5</strong> para analizar 22 inhibidores de una llamada <strong>Enzima Z</strong>, la cual resulta que era la cruzipaína, es decir, la cisteín proteasa principal de <em>Trypanosoma cruzi</em>, el parásito causante de la enfermedad de Chagas.</p>
<p>En esta segunda fase del experimento se eligieron 2 inhibidores y se realizó un análisis más detallado, estudiando como varía la expresión de miles de genes en presencia o ausencia de dichos inhibidores. Para esto se hizo un estudio de transcriptómica (RNA-seq) donde se extrajo el ARN y se lo analizó con <strong>Illumina</strong>. Luego, cada <em>read</em> encontrado se mapeó contra el genoma de referencia y se llegó a una tabla de conteo para cada uno de las transcriptos del genoma.</p>
<p>Para cada caso (<em>control</em>, <em>droga 1</em> y <em>droga 2</em>) se realizaron 3 réplicas técnicas para obtener resultados más robustos.</p>
<p>Nuestro objetivo va a ser entonces obtener una lista de los genes que son más afectados por cada droga.</p>
<h3 id="leer-los-datos">Leer los datos</h3>
<p><strong>1)</strong> Lean los archivos <strong>control_data.tsv</strong>, <strong>drug1_data.tsv</strong> y <strong>drug2_data.tsv</strong> que se encuentran en sus materiales de trabajo y guárdenlos en diferentes variables llamadas <strong>control_data</strong>, <strong>drug1_data</strong> y <strong>drug2_data</strong> respectivamente. Asegurense que las variables son del tipo <em>Data Table</em></p>
<h3 id="estandarizar-los-datos">Estandarizar los datos</h3>
<p>El conteo de <em>reads</em> no se puede comparar entre genes puesto que la expresión basal de cada uno es distinto, por lo cual encontrar 10 <em>reads</em> de un gen puede ser mucho, y encontrar 1000 de otro puede ser poco. Además cada ensayo de secuenciación puede tener distinta profundidad con lo que tampoco sería viable comparar 10 <em>reads</em> de un ensayo donde en total se mapearon <span class="arithmatex">\(2\text{x}10^8\)</span> <em>reads</em> con los mismos 10 de otro ensayo donde se mapearon <span class="arithmatex">\(1\text{x}10^8\)</span> (es decir, la mitad).</p>
<p>Por esta razón vamos a querer modificar las nueve columnas y transformar el valor a "conteo por millón", cuya fórmula es:</p>
<div class="arithmatex">\[
\text{RPM or CPM} = \frac{ReadsDelGen * 10^6}{ReadsTotales}
\]</div>
<h3 id="combinar-las-replicas">Combinar las réplicas</h3>
<p>Otra cosa que vamos a querer hacer es combinar las tres réplicas para cada caso. Esto lo vamos a hacer simplemente promediando los 3 valores de CPM para cada gen en cada tratamiento.</p>
<p><strong>2)</strong> En base a los TPs anteriores ya tienen los conocimientos para hacer el estandarizado de datos y la combinación de réplicas usando <em>fors</em>, pero para hacerla un poco más fácil les vamos a dar un par de funciones que les van a simplificar bastante este paso (y ya que estamos les mostramos la función <code>apply()</code> en acción):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked id="__tabbed_4_1" name="__tabbed_4" type="radio"><input id="__tabbed_4_2" name="__tabbed_4" type="radio"><div class="tabbed-labels"><label for="__tabbed_4_1">Código</label><label for="__tabbed_4_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">calcularConteoPorMillon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un vector de *reads*, esta funcion lo transforma en CPM y devuelve el vector</span>

<span class="w">    </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1000000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span>

<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">parsearDatos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">dt_par</span><span class="p">,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">nombre_columna_nueva</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un *Data Table*, un vector de *strings* con los nombres de las columnas con *reads* a parsear y</span>
<span class="w">    </span><span class="c1">#un nombre de una columna a crear, esta funcion:</span>
<span class="w">    </span><span class="c1"># - Transforma los *reads* de las columnas a parsear en CPM</span>
<span class="w">    </span><span class="c1"># - Calcula el promedio de los CPM por cada fila y lo guarda en una columna nueva con el nombre dado</span>
<span class="w">    </span><span class="c1"># - Saca las columnas a parsear del *Data Table*</span>
<span class="w">    </span><span class="c1"># - Devuelve el *Data Table* con los cambios</span>

<span class="w">    </span><span class="n">dt_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="n">matrix_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">dt_aux</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">calcularConteoPorMillon</span><span class="p">)</span>

<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">matrix_aux</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]],</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>

<span class="w">    </span><span class="n">dt_par</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">dt_par</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">calcularConteoPorMillon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un vector de *reads*, esta funcion lo transforma en CPM y devuelve el vector</span>

<span class="w">    </span><span class="c1">#Aca estoy asumiendo que sum(vector_cuentas) nunca es 0 (lo que tiene un poco</span>
<span class="w">    </span><span class="c1">#de sentido ya que si es 0 entonces todas los counts son 0)</span>
<span class="w">    </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1000000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span>

<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">parsearDatos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">dt_par</span><span class="p">,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">nombre_columna_nueva</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un *Data Table*, un vector de *strings* con los nombres de las columnas con *reads* a parsear y</span>
<span class="w">    </span><span class="c1">#un nombre de una columna a crear, esta funcion:</span>
<span class="w">    </span><span class="c1"># - Transforma los *reads* de las columnas a parsear en CPM</span>
<span class="w">    </span><span class="c1"># - Calcula el promedio de los CPM por cada fila y lo guarda en una columna nueva con el nombre dado</span>
<span class="w">    </span><span class="c1"># - Saca las columnas a parsear del *Data Table*</span>
<span class="w">    </span><span class="c1"># - Devuelve el *Data Table* con los cambios</span>

<span class="w">    </span><span class="c1">#Creo un nuevo *Data Table* que solo contenga las columnas a parsear (y no el ID del gen)</span>
<span class="w">    </span><span class="n">dt_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="c1">#La funcion *apply* con el parametro 2 va a ejecutar la funcion *calcularConteoPorMillon* para </span>
<span class="w">    </span><span class="c1">#cada COLUMNA de dt_aux (las tres replicas, en este caso)</span>
<span class="w">    </span><span class="n">matrix_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">dt_aux</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">calcularConteoPorMillon</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#La funcion *apply* con el parametro 1 va a ejecutar la funcion *mean* para </span>
<span class="w">    </span><span class="c1">#cada FILA de matrix_aux (cada uno de los genes estudiados)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">matrix_aux</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]],</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Saco las columnas que ya no me interesan de *dt_par*</span>
<span class="w">    </span><span class="n">dt_par</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">dt_par</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>2.1)</strong> Corran las funciones anteriores para cargarlas en memoria, luego úsenlas para estandarizar y combinar las réplicas del control y las drogas 1 y 2. Un ejemplo de correr esta función para el caso de control sería:</p>
<div class="highlight"><pre><span></span><code><span class="n">control_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">parsearDatos</span><span class="p">(</span><span class="n">dt_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control_data</span><span class="p">,</span>
<span class="w">                             </span><span class="n">columnas_a_parsear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"control1"</span><span class="p">,</span><span class="w"> </span><span class="s">"control2"</span><span class="p">,</span><span class="w"> </span><span class="s">"control3"</span><span class="p">),</span>
<span class="w">                             </span><span class="n">nombre_columna_nueva</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"control"</span><span class="p">)</span>
</code></pre></div>
<p><strong>2.2)</strong> Ahora que ya tenemos los datos parseados, usen la función <code>merge()</code> dos veces para combinar los 3 <em>Data Tables</em> en uno solo llamado <strong>full_data</strong> (si todo salió bien debería tener 11.106 filas y 4 columnas).</p>
<h3 id="calcular-el-fold-change">Calcular el Fold Change</h3>
<p><strong>3)</strong> Algo mencionamos antes, pero concluir que "hay 10 CPM más al agregarle la droga" no significa nada en el vacío. Si en el control era solo 1 CPM, entonces 10 más es mucho. Si en el control eran 10.000 CPM, 10 más es insignificante.</p>
<p>Vamos entonces a calcular el fold change, es decir, cuantas veces más (o menos) de CPM fueron observados al agregarle la droga frente a cuando estaba solo el control. Esto lo calculamos como:</p>
<div class="arithmatex">\[
\text{Fold Change} = \frac{\text{CPM Droga}}{\text{CPM Control}}
\]</div>
<p><strong>3.1)</strong> Antes de seguir leyendo ¿Se les ocurre algún caso donde la fórmula anterior nos de problemas?</p>
<details class="tip">
<summary>Respuesta</summary>
<p>Básicamente hay 2 casos donde el cálculo del Fold Change va a dar problemas:</p>
<ul>
<li>Cuando <strong>CPM Control = 0</strong>: La división no se puede hacer (y de hacerla en <strong>R</strong> va a dar infinito)</li>
<li>Cuando <strong>CPM Control ~ 0</strong>: En este caso la división se hace, pero el Fold Change va a dar un número muy grande (y probablemente varios órdenes de magnitud más grande que el resto de los Fold Change calculados). Este Fold Change no se debe a que <strong>CPM Droga</strong> es realmente mayor, sino a que <strong>CPM Control</strong> es muy chico, por lo que no es realmente informativo.</li>
</ul>
</details>
<p>Estos dos problemas se pueden arreglar agregando un número <em>buffer</em>, es decir, un número pequeño que se adiciona al numerador y al denominador. En este caso vamos a usar 0,125 con lo que la fórmula quedaría:</p>
<div class="arithmatex">\[
\text{Fold Change} = \frac{\text{CPM Droga} + 0.125}{\text{CPM Control} + 0.125}
\]</div>
<p><strong>3.2)</strong> ¿Qué pasa ahora en los dos casos problemáticos que estamos tratando resolver? ¿Cómo afecta este <em>buffer</em> a los casos "normales"? (es decir, cuando tanto el numerador como el denominador son números mayores a 1)</p>
<p><strong>3.3)</strong> Usando la fórmula con <em>buffer</em>, calculen el Fold Change para ambas drogas y guárdenlos en nuevas columnas de la tabla <strong>full_data</strong> (pónganles nombres que representen la información que contienen).</p>
<h3 id="transformar-el-fold-change">Transformar el Fold Change</h3>
<p>Ahora bien, vamos a analizar como se distribuyen los valores del Fold Change para todas las proteínas (primera pestaña del plot que está abajo). Podemos ver que si bien el Fold Change llega hasta 20 en algunos casos, la gran mayoría de ellas tienen Fold Changes menores a 4.</p>
<p>En el paso siguiente vamos a querer agrupar nuestros genes por como se comportan frente a las drogas 1 y 2 clusterizando con <code>kmeans()</code> y luego plotearlo en un <em>heatmap</em>. En este momento la mayoría de los datos se encuentran en un pequeño rango del "espectro" de Fold Change, por lo que al momento de agrupar por similitud básicamente van a formar un único gran cluster, lo que no da información.</p>
<p>Por esta razón queremos convertir nuestros datos a una escala logarítmica. Como Fold Change solo llega hasta 20 vamos a usar una escala logarítmica en base 2. En <strong>R</strong> esto se hace usando la función <code>log()</code>. Por defecto esta función usa como base a <span class="arithmatex">\(e\)</span>, es decir, es el logaritmo natural. Sin embargo, se le puede cambiar la base a 2 pasándole el parámetro <code>base = 2</code> (ver la segunda pestaña en el siguiente plot).</p>
<p><strong>4)</strong> Usando la función <code>log()</code> con el parámetro necesario, calculen el logaritmo en base 2 de los Fold Change para ambas drogas y guárdenlos en nuevas columnas de la tabla <strong>full_data</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked id="__tabbed_5_1" name="__tabbed_5" type="radio"><input id="__tabbed_5_2" name="__tabbed_5" type="radio"><div class="tabbed-labels"><label for="__tabbed_5_1">Fold Change para la Droga 1</label><label for="__tabbed_5_2">Log2(Fold Change) para la Droga 1</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
<a class="glightbox" href="img/HistogramaDroga1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HistogramaDroga1" src="img/HistogramaDroga1.png"></a>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
<a class="glightbox" href="img/HistogramaLog2Droga1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HistogramaLog2Droga1" src="img/HistogramaLog2Droga1.png"></a>
</figure></p>
</div>
</div>
</div>
<h3 id="plotear-el-heatmap">Plotear el Heatmap</h3>
<p>El <em>heatmap</em> es un tipo de plot que no vimos hasta el momento, pero que tal vez conozcan. La versión básica del heatmap nos permite graficar valores numéricos como una escala de colores lo que nos permite ver diferencias entre filas rápidamente e incluso encontrar filas similares o patrones.</p>
<p>A continuación mostramos un ejemplo que usa los datos estandarizados del <strong>Ejercicio 2</strong> del <strong>TP 10a</strong> (la tabla ejemplo con los 4 genes, <strong>matriz_datos_ST</strong>):</p>
<figure>
<p><a class="glightbox" href="img/heatmapEjemplo.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HeatmapEjemplo" src="img/heatmapEjemplo.png"></a></p>
</figure>
<p>No solo nos permite ver rápidamente que hay 2 grupos de genes, sino que este paquete de heatmap también va a agrupar las filas por similitud y mostrar un dendrograma de similitud (todo esto se puede poner o sacar con parámetros).</p>
<p><strong>5)</strong> En nuestro caso tenemos miles de genes, por lo que es complicado usar un <em>heatmap</em> que los muestre a todos por separado. Vamos entonces a clusterizarlos por similitud usando <code>kmeans</code>, lo cual en este caso se puede hacer desde el mismo paquete que hace el <em>heatmap</em>. Al momento de definir clusters no sabemos cuántos son, por lo que vamos a elegir un número relativamente grande, sabiendo que eso puede resultar en varios clusters que son muy similares.</p>
<p><strong>5.1)</strong> Instalen en <strong>R</strong> el paquete <strong>pheatmap</strong>.</p>
<p><strong>5.2)</strong> Corran el siguiente código reemplazando <strong>log2_fold_change_drug1_wBuffer</strong> y <strong>log2_fold_change_drug2_wBuffer</strong> por el nombre de las columnas que contienen el logaritmo en base 2 de los Fold Change:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">pheatmap</span><span class="p">)</span>

<span class="c1">#Como *pheatmap* usa kmeans adentro inicializo la seed para que el plot de igual en todos lados siempre</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">#Me quedo solo con las columnas a plotear (en este caso el log 2 de los Fold Change para ambas drogas)</span>
<span class="n">plot_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">full_data</span><span class="p">[,</span><span class="w"> </span><span class="nf">.</span><span class="p">(</span><span class="n">log2_fold_change_drug1_wBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">log2_fold_change_drug2_wBuffer</span><span class="p">)]</span>

<span class="c1">#Uso la funcion *pheatmap* para hacer un heatmap mas lindo</span>
<span class="nf">pheatmap</span><span class="p">(</span><span class="n">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot_data</span><span class="p">,</span><span class="w"> </span><span class="n">kmeans_k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>kmeans_k = 10</code> le está diciendo que agrupe los datos en 10 clusters, similar a correr <code>kmeans(plot_data, centers = 10)</code></li>
<li><code>cluster_col = F</code> le está diciendo que no trate de agrupar las columnas por similitud y que no haga un dendrograma asociado</li>
</ul>
<p><strong>5.3)</strong> Mirando los 10 clusters que acabamos de crear, para que clusters de genes se observa:</p>
<ul>
<li>Fold change alto para ambas drogas</li>
<li>Fold change bajo para ambas drogas</li>
<li>Fold change alto para la droga 1 y bajo la droga 2</li>
<li>Fold change bajo para la droga 1 y alto la droga 2</li>
</ul>
<h3 id="calcular-genes-mas-afectados" markdown="markdown">Calcular genes más afectados</h3>
<p><strong>6)</strong> Si bien el <em>heatmap</em> nos da una idea global de como actuaron las drogas, nuestro objetivo es entender un poco más de su funcionamiento. Para esto, vamos a analizar la lista de genes que se vieron afectados por ellas.</p>
<p>Para obtener esta lista es necesario entonces definir un umbral numérico de Fold Change a partir del cual consideramos que el cambio fue "significativo" para nosotros. Estos umbrales se pueden elegir en base a conocimientos previos, en base a controles positivos y negativos, o mediante prueba y error (analizando qué y cuántos genes quedan por encima del umbral).</p>
<p>Otra cosa a considerar es que en este caso estamos analizando drogas que funcionan como inhibidores, por lo que no nos interesa solo los genes con Fold Change alto, sino que incluso nos interesan más los genes con Fold Change bajo (que debido a como se calculó quiere decir cercanos a 0).</p>
<p>En este caso vamos a quedarnos con aquellos genes que cumplan alguna de las siguientes condiciones:</p>
<ul>
<li><span class="arithmatex">\(log_2(FoldChange) \geq 1.5\)</span> (es decir <span class="arithmatex">\(FoldChange \geq 2.83 = 2^{1.5}\)</span>)</li>
<li><span class="arithmatex">\(log_2(FoldChange) \leq -1.5\)</span> (es decir <span class="arithmatex">\(FoldChange \leq \frac{1}{2.83} = 2^{-1.5}\)</span>)</li>
</ul>
<p>O sea, que nos vamos a quedar con aquellos genes que tienen un CPM 2.83 veces más grande o más chico que el control.</p>
<p><strong>6.1)</strong> Filtren <strong>full_data</strong> para quedarnos con aquellas filas donde el logaritmo en base 2 del Fold Change de la droga 1 sea mayor a 1.5 o menor a -1.5. Guarden la lista de los IDs de las proteínas que cumplen esa condición en una nueva variable. Hagan lo mismo para la droga 2.</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Calcular el valor absoluto</p>
<p>La función <code>abs()</code> nos devuelve el valor absoluto de un número. Si bien es posible filtrar estos datos usando simplemente un <strong>OR</strong>, también lo pueden hacer usando <code>abs()</code>, lo que prefieran.</p>
</div>
<p><strong>6.2)</strong> Usen <code>write.table()</code> para generar un nuevo archivo llamado <strong>affected_genes_drug1</strong> y guarden en él los IDs recién calculados para la droga 1. Tengan en cuenta que queremos solo los IDs, por lo que tienen que cambiar los parámetros de la función para que no haya nombres de las filas, nombres de las columnas ni comillas. Hagan lo mismo para la droga 2.</p>
<h3 id="buscar-nuestros-genes-en-bases-de-datos" markdown="markdown">Buscar nuestros genes en bases de datos</h3>
<div class="admonition info">
<p class="admonition-title">Importante</p>
<p>La base de datos <strong>TriTrypDB</strong> se encuentra discontinuada en este momento (septiembre 2024). Dejamos el ejercicio planteado para cuando la página vuelva a estar activa, y para que vean como era el paso de data mining. Cuando haya una alternativa, vamos a reemplazar este punto con la nueva información.</p>
</div>
<p><strong>7)</strong> Lo último que vamos a hacer con esta información es investigar en bases de datos para tratar de entender un poco más que procesos biológicos están siendo afectados por nuestras drogas. Como estamos trabajando con <em>Trypanosoma cruzi</em> vamos a ir a una página que se especializa en tripanosomátidos llamada <strong>TriTrypDB</strong>.</p>
<p><strong>7.1)</strong> Entren a <a href="https://tritrypdb.org/tritrypdb/app/search/transcript/GeneByLocusTag">este link</a> y copien la lista de IDs que acabamos de crear para la droga 1. Hagan click en <strong>Get Answer</strong>.</p>
<p><strong>7.2)</strong> Una vez que se hayan cargados los datos vayan a <strong>Analyze Results</strong> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg></span> <strong>Gene Onthology Enrichment</strong>, asegúrense que este checkeado <strong>Biological Process</strong> y aprieten <strong>Submit</strong> (disclaimer: esta parte a veces no anda y hay que probar otro día).</p>
<details class="tip">
<summary>Tip - Ubicación del botón <strong>Analyze Results</strong></summary>
<p><figure markdown>
<a class="glightbox" href="img/analyzeResults.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="AnalyzeResults" src="img/analyzeResults.png"></a>
</figure></p>
</details>
<p><strong>7.3)</strong> Esta tabla muestra procesos biológicos relacionados con nuestra lista de genes. A grandes rasgos, ¿qué procesos biológicos parecen estar afectados directa o indirectamente por la droga 1? Para responder esto pueden ordenar la tabla obtenida por la columna <strong>P-value</strong> en forma ascendente o pueden presionar el botón <strong>Show Word Cloud</strong> que se encuentra arriba de la tabla para ver un <em>Word Cloud</em> de los diferentes procesos biológicos.</p>
<p><strong>7.4)</strong> Hagan <strong>7.1)</strong>, <strong>7.2)</strong> y <strong>7.3)</strong> para la droga 2.</p>
<p><strong>7.5)</strong> ¿Que habría que cambiar en lo que hicimos en el punto <strong>6)</strong> si sólo nos interesaran los procesos biológicos que son inhibidos por nuestras drogas?</p>
<h2 id="bibliografia"><strong>Bibliografía</strong></h2>
<!--
### :material-bookshelf: Libros
* Libro 1 
* Libro 2
-->

<!--
### :material-web: Online
* Online 1 
* Online 2 https://en.wikipedia.org/wiki/R_(programming_language)
-->

<h3 id="consola-de-r"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 19v-3h8v3zm-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5z"></path></svg></span> Consola de R</h3>
<ul>
<li>Comando <code>help()</code></li>
</ul></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Area Bioinformática UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>