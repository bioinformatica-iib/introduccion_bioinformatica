
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/introduccion_bioinformatica/practicos/TP12b_Data_Mining/">
      
      <link rel="icon" href="../../img/logo-unsam-negro.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.5.10">
    
    
      
        <title>Index - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cabin";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-12b-data-mining" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../acerca/" class="md-tabs__link">
      Acerca de
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contenidos/" class="md-tabs__link">
      Contenidos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cronograma/" class="md-tabs__link">
      Cronograma
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../docentes/" class="md-tabs__link">
      Docentes
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../teoricas/inicio/" class="md-tabs__link">
        Teóricas
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../inicio/" class="md-tabs__link">
        Prácticos
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../instructivos/inicio/" class="md-tabs__link">
        Instructivos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contenidos/" class="md-nav__link">
        Contenidos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cronograma/" class="md-nav__link">
        Cronograma
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../docentes/" class="md-nav__link">
        Docentes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teóricas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teóricas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teóricas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        Teórica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        Teórica 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/3-Teorica-Tres/" class="md-nav__link">
        Teórica 3
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Prácticos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Prácticos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        TP 1 - Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP02_EMBOSS/" class="md-nav__link">
        TP 2 - EMBOSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP03_Alineamientos/" class="md-nav__link">
        TP 3 - Alineamientos de a pares
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Instructivos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instructivos" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Instructivos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/maquina_virtual/" class="md-nav__link">
        Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/problemasVM/" class="md-nav__link">
        Problemas instalando la Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/tipsVM/" class="md-nav__link">
        Tips and Tricks para usar la Máquina Virtual más cómodos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><p><a class="glightbox" href="img/banner.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img _="," align="left" alt="Image" src="img/banner.jpg" width="250"></a></p>
<h1 id="tp-12b-data-mining" markdown="markdown"><strong>TP 12b</strong>. Data Mining</h1>
<p><br>
<br>
<br></p>
<p><a class="md-button md-button--primary" href="https://drive.google.com/file/d/1rJFe_Q5_oKo5OOoo2HXIsVMqtKlGNheV/view?usp=sharing"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"></path></svg></span> Materiales</a></p>
<!--
Este es el botón para descargar materiales, en (#) hay que agregar el link correspondiente
-->

<h3 id="slides-mostrados-en-la-clase">Slides mostrados en la clase</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"></path></svg></span> <a href="https://drive.google.com/file/d/1jFMlmnG0Aik4L17XbKI2EmzGYo1CH7mJ/view?usp=sharing">Cierre TP</a></li>
</ul>
<h3 id="videos-de-la-clase-grabada">Videos de la clase grabada</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=ID6R3fBj3vo">Introducción al TP</a></li>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=iqwjW6oZKO8">Cierre TP</a></li>
</ul>
<h3 id="software-a-usar">Software a usar</h3>
<ul>
<li>R (ya instalado en la VM).</li>
<li>RStudio (ya instalado en la VM)</li>
</ul>
<h3 id="recursos-online">Recursos Online</h3>
<ul>
<li><a href="https://www.coursera.org/learn/r-programming">Curso online de R de Coursera</a> (se puede hacer gratis) (en ese caso no da certificado)</li>
<li>Data Tables: <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html">Introducción oficial</a> y <a href="https://bookdown.org/paradinas_iosu/CursoR/data-table.html">otra página con más info</a></li>
<li>ggplot2: <a href="https://bookdown.org/paradinas_iosu/CursoR/ggplot2.html">Vistazo rápido</a>, <a href="http://sthda.com/english/wiki/ggplot2-essentials">detalles sobre los tipos de plots</a>, <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> e <a href="https://jfly.uni-koeln.de/color/">información sobre colores y daltonismo</a></li>
<li>dendextend: <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/dendextend.html">Detalle del paquete</a></li>
</ul>
<h3 id="objetivos">Objetivos</h3>
<ul>
<li>Usar métodos de clustering junto con herramientas de programación para resolver problemas biológicos.</li>
<li>Familiarizarse en el paquete <code>ggplot2</code> para hacer plots en <strong>R</strong>.</li>
<li>Introducir paquetes de <strong>R</strong> que permiten plotear dendrogramas y <em>heatmaps</em>.</li>
</ul>
<h2 id="introduccion-al-tema"><strong>Introducción al Tema</strong></h2>
<p>Este TP retoma lo empezado en el <strong>TP 12a</strong>, donde aprendimos métodos de clustering como <em>clustering jerárquico</em> o <em>K-means</em> y los aplicamos a un ejemplo mínimo de una tabla con solo 4 filas.</p>
<p>Vamos ahora a utilizar los mismos métodos para trabajar con data sets más grandes y tratar de ir entendiendo cuándo, cómo y por qué es conveniente agrupar nuestros datos.</p>
<p>A su vez vamos a desarrollar algunos temas de <strong>R</strong> que son muy útiles, pero para los cuales no nos alcanzó el tiempo en los TPs anteriores: plotear usando <code>ggplot2</code> y utilizar funciones creadas por nosotros.</p>
<p>Para hacer esto vamos a utilizar 2 data sets. En el <strong>Ejercicio 1</strong> vamos a trabajar con el ya conocido data set <strong>iris</strong> que tiene 150 filas y viene por defecto con <strong>R</strong>. En el <strong>Ejercicio 2</strong> vamos a trabajar con datos de un estudio de transcriptómica que nos devolvió 9 datos para cada uno de 11.106 genes estudiados. Este trabajo es un segundo paso de lo realizado en el <strong>TP 8b</strong> cuando buscábamos inhibidores para la <strong>Enzima Z</strong>.</p>
<h2 id="mejores-plots-ggplot2"><strong>Mejores plots: ggplot2</strong></h2>
<h3 id="bases-de-ggplot2">Bases de ggplot2</h3>
<p>En el <strong>TP 8a</strong> mencionamos rápidamente al paquete <code>ggplot2</code>, el cual es uno de las formas más populares de hacer plots en <strong>R</strong>. Este paquete es bastante complicado y tiene un sinfín de funcionalidades, pero hoy vamos a darle un vistazo a su funcionalidad básica (el <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> es una forma rápida de ver todas las posibilidades que tiene).</p>
<p>Un ejemplo muy simple de hacer un plot con la función <code>ggplot</code> sería:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Recuerden que *iris* es un *Data Frame* para hacer pruebas que esta siempre cargado en la memoria de R</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><strong>p</strong> es una variable en la que estoy guardando el plot. Cuando la imprimo (usando <code>print</code>) el plot va a aparecer en la pestaña <strong>Plots</strong> en <strong>RStudio</strong> (en el panel de abajo a la derecha).</li>
<li><code>data = iris</code> le está indicando a la función <code>ggplot</code> de que tabla va a sacar la información a plotear. En <code>ggplot</code> se pueden usar <em>Data Frames</em> o <em>Data Tables</em> indistintamente.</li>
<li><code>aes()</code> es una función que se encuentra dentro de la función principal de <code>ggplot</code>. Se va a encargar de relacionar las diferentes columnas de la tabla con las diferentes variables del plot.</li>
<li><code>x = Petal.Length</code> está indicando que la variable X en el plot va a ser los datos de la columna <strong>Petal.Length</strong>.</li>
<li><code>y = Sepal.Length</code> está indicando que la variable Y en el plot va a ser los datos de la columna <strong>Sepal.Length</strong>.</li>
<li><code>geom_point()</code> está indicando el tipo de plot a realizar. Si leen el <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a> van a ver que en este caso estamos haciendo un scatter plot.</li>
<li>Ambas funciones del plot están separadas por el símbolo <code>+</code>, lo que les puede resultar un poco extraño (porque lo es), pero así es como funciona <code>ggplot</code>.</li>
</ul>
<p><strong>1)</strong> Corran el código anterior y vean el plot resultante.</p>
<h3 id="cambiar-la-estetica-del-plot-segun-variables" markdown="markdown">Cambiar la estética del plot según variables</h3>
<p>La función <code>aes()</code> recibe su nombre de la palabra en inglés <em>aesthetics</em>, o estética. No es de extrañar entonces que dentro de dicha función es donde podemos poner otras variables que determinen los colores, formas o tamaños de cada punto del plot (entre otras características).</p>
<p><strong>2)</strong> Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>En este código, <code>color = Species</code> le está diciendo a <code>ggplot</code> que modifique el color de los puntos dependiendo del valor de la columna <strong>Species</strong>. Si recuerdan a <strong>iris</strong>, esta columna era una columna categórica (o <em>factor</em>) con 3 valores que podemos ver en el plot. Como le pasamos a <code>color</code> una variable categórica, nos devolvió una escala de colores categórica.</p>
<p><strong>3)</strong> Corran el código anterior, pero ahora reemplacen a <strong>Species</strong> por <strong>Petal.Width</strong>, ¿qué cambios observan?</p>
<p><strong>4)</strong> Es posible también modificar varias de estas características a la vez. Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>En este caso agregamos 2 características nuevas, <code>shape</code> (la forma de los puntos) y <code>size</code> (el tamaño de los puntos) y le asignamos cada uno de ellos a una variable de la tabla. Noten que no hay problema con que una columna modifique más de una característica a la vez.</p>
<p><strong>5)</strong> Tal vez ya lo notaron, pero por el momento no tenemos ningún control sobre que colores o formas le asigna <code>ggplot</code> a mis tres categorías. Vamos a mostrarles como hacerlo para este caso específico, pero sepan que las funciones a usar son ligeramente diferentes dependiendo si la variable pasada es discreta o continua. </p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Los colores se pueden escribir en ingles o en hexadecimal</span>
<span class="c1">#"#FF0000" es el color rojo (se podría haber puesto "red")</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>scale_colour_manual()</code>: me permite modificar a mano una escala discreta de colores. El parámetro <code>values</code> modifica los colores en sí.</li>
<li><code>scale_shape_manual()</code>: me permite modificar a mano una escala discreta de formas. El parámetro <code>values</code> modifica las formas, las cuales corresponden a un número entero (en el tip a continuación se muestran las más comunes).</li>
</ul>
<p>Un detalle importante a destacar es que el orden en que se asignó cada color a cada categoría depende del orden en el que aparecen los <em>Levels</em> de la columna <strong>Species</strong>, la cual es un <em>factor</em> (pueden imprimir <code>iris$Species</code> para ver a lo que nos referimos). </p>
<details class="tip">
<summary>Tip - Posibles valores para <code>shape</code></summary>
<p><figure markdown>
<a class="glightbox" href="img/points-symbols.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ShapeSymbols" max-width="500" src="img/points-symbols.png"></a>
</figure></p>
<p>El color interior las formas 21 a 25 depende de la variable <code>fill</code> que no mencionamos todavía, pero se usa igual que el resto.</p>
</details>
<details class="tip">
<summary>Tip - Colores y daltonismo</summary>
<p>El daltonismo ocurre cuando hay un problema con los pigmentos en ciertas células nerviosas del ojo que perciben el color. Estas células se llaman conos y los hay de tres tipos, los cuales son responsables de ver principalmente al rojo, al verde y al azul respectivamente. </p>
<p><figure markdown>
<a class="glightbox" href="img/colorblind_rainbow.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ColorblindRainbow" src="img/colorblind_rainbow.jpg"></a>  <br>
</figure></p>
<p>La frecuencia del daltonismo es bastante alta, con un 8% de los hombres caucásicos, 5% de los asiáticos y 4% de los africanos presentando problemas para distinguir el color rojo del verde. Como la mayoría de los casos de daltonismo provienen de una mutación de un gen recesivo ligado al cromosoma X, muy pocas mujeres son daltónicas.</p>
<p>Debido al considerable número de personas con daltonismo, es buena ídea tener en cuenta esto al momento de elegir colores para cualquier figura que vaya a ser vistas por el público general. Se pueden encontrar decenas de herramientas online que nos ayudan a crear esto, así como paquetes de <strong>R</strong> o paletas de colores. Un ejemplo de una paleta de colores sería:</p>
<p><figure markdown>
<a class="glightbox" href="img/colorblind_pallete.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="ColorblindPallete" src="img/colorblind_pallete.jpg"></a>  <br>
</figure></p>
<p>Pueden leer más información sobre este tema <a href="https://jfly.uni-koeln.de/color/">aca</a>.</p>
</details>
<details class="tip">
<summary>Tip - Asignar colores específicos a cada característica sin depender del orden de los <em>Levels</em></summary>
<p>Si bien el código anterior funciona perfecto, depender del orden de los <em>Levels</em> de un <em>factor</em> al momento de matchear color con un valor dado puede ser peligroso. Una forma de estar seguros que le estamos asignando el color correcto a cada valor es usando vectores con nombres (o <em>named vectors</em>). Algo mencionamos de estos vectores en el pasado, pero básicamente son vectores donde cada posición tiene un nombre (además del índice). En este caso sería:</p>
<div class="highlight"><pre><span></span><code><span class="n">categorias</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"setosa"</span><span class="p">,</span><span class="w"> </span><span class="s">"versicolor"</span><span class="p">,</span><span class="w"> </span><span class="s">"virginica"</span><span class="p">)</span>
<span class="n">colores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">colores</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">categorias</span>

<span class="c1">#Puedo acceder a "blue" haciendo `colores[2]` o `colores["versicolor"]`</span>
</code></pre></div>
<p>De hacer <code>scale_colour_manual(values = colores)</code> en la función <code>ggplot</code> nos aseguraríamos que el primer elemento de <code>categorias</code> va a tener el primer color de <code>colores</code> y así.</p>
</details>
<p><strong>6)</strong> Por último, ¿qué pasa si no queremos cambiar la estética del plot dependiendo del valor de una variable, sino que simplemente queremos cambiarla y que afecte a todos los puntos por igual? En estos casos hay que modificar dicha característica dentro de la función específica del plot.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<h3 id="nombres-y-estilo-de-los-ejes-y-el-plot" markdown="markdown">Nombres y estilo de los ejes y el plot</h3>
<p><strong>7)</strong> Ahora que ya modificamos bastante el estilo de los datos, vamos a modificar el resto del plot. Lo primero que vamos a hacer es cambiar el nombre del eje X, el eje Y y el título del plot.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="hll"><span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>xlab()</code>: indica el nombre del eje X</li>
<li><code>ylab()</code>: indica el nombre del eje Y</li>
<li><code>ggtitle()</code>: indica el título del plot</li>
</ul>
<p><strong>8)</strong> Si bien obtuvimos lo deseado, puede ser que queramos cambiar el tamaño de los ejes o centrar el título. Esto lo hacemos con la función <code>theme()</code>:</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
</span><span class="hll"><span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
</span><span class="hll"><span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>theme()</code>: es la función que contiene el estilo del texto de los ejes y del título de un plot.</li>
<li><code>plot.title = element_text(size = 16, hjust = 0.5)</code>: estamos modificando el titulo del plot, donde <code>size</code> modifica el tamaño de letra y <code>hjust = 0.5</code> lo centra horizontalmente.</li>
<li><code>axis.title = element_text(size = 14)</code>: estamos modificando los títulos de los ejes (es decir, los nombre de los ejes).</li>
<li><code>axis.text = element_text(size = 12)</code>: estamos modificando el tamaño de los números de los ejes.</li>
</ul>
<p>Noten que dentro de <code>theme()</code> cada línea se separa con comas, y recién una vez que termina volvemos a usar el símbolo <code>+</code>.</p>
<h3 id="fondo-del-plot">Fondo del plot</h3>
<p><strong>9)</strong> Lo último que nos queda por modificar es el "fondo" del plot, es decir, el color de fondo, las líneas que corresponden a las divisiones de los ejes y el recuadro general del plot. Si bien esto se puede hacer a mano, <strong>ggplot</strong> viene con algunas opciones ya armadas.</p>
<p>Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">    </span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="hll"><span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
</span><span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#FF0000"</span><span class="p">,</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s">"green"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>theme_bw()</code> es una función que setea varias opciones de <code>theme()</code> a un estilo específico (en este caso un estilo simple en blanco y negro). La tenemos que usar antes de <code>theme()</code> para asegurarnos que cualquier cambio que hagamos a mano en <code>theme()</code> sobrescriba los de <code>theme_bw()</code>.</li>
</ul>
<!--
**10)** Reemplacen a `theme_bw()` por `theme_` y vean la lista de temas que aparecen en el autocompletar de RStudio (si no aparece pueden apretar ++ctrl++ + ++space++). Prueben correr el código anterior con 2 temas que no sean `theme_bw()` y vean como se ve el plot en cada caso.
-->

<h3 id="otros-tipos-de-plots">Otros tipos de plots</h3>
<p>Si bien la mayoría de lo que les mencionamos hasta ahora es aplicable al uso general de <strong>ggplot</strong>, hasta el momento nos enfocamos en un solo tipo de plot, el scatter plot, hecho mediante <code>geom_point()</code>.</p>
<p>Debido a que esto es suficiente para lo que necesitamos hacer hoy (y que este TP es de <em>Data Mining</em>) no vamos a hablar hoy de otros tipos de plots, pero si les interesa pueden verlo con mucho detalle en <a href="http://sthda.com/english/wiki/ggplot2-essentials">esta página</a> o ver un vistazo rápido en la <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a>.</p>
<h2 id="ejercicio-1-agrupando-flores-por-especies" markdown="markdown"><strong>Ejercicio 1 - Agrupando flores por especies</strong></h2>
<h3 id="introduccion-al-data-set">Introducción al data set</h3>
<p>En este ejercicio vamos a trabajar una vez más con el data set <strong>iris</strong>, el cual es un set de datos que viene por defecto con <strong>R</strong> y está siempre cargado en memoria.</p>
<p>Este data set contiene las medidas de ancho (<em>width</em>) y largo (<em>length</em>) de los sépalos y los pétalos para 3 especies de flores diferentes: setosa, versicolor, y virginica (todas del Genus <em>Iris</em>). Tiene mediciones de 150 flores, 50 por especie.</p>
<details class="info">
<summary>Sépalo vs pétalo</summary>
<p><figure markdown>
<a class="glightbox" href="img/sepal_vs_petal.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="SepalPetal" max-width="400" src="img/sepal_vs_petal.png"></a>
</figure></p>
</details>
<p>Antes que nada vamos a familiarizarnos un poco con este data set.</p>
<p><strong>1)</strong> Corran el siguiente código y vean el plot resultante:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Transformo a iris en un *Data Table* (que aca realmente no hace falta, pero para despues)</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1">#Hago un plot comparando el largo de los sepalos y los petalos</span>
<span class="c1">#Estoy cambiando la forma y el color segun la especie</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Sepal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Petal Length"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Sepal Length vs Petal Length per Species"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<p>Podemos ver que con solo plotear el largo de los pétalos y los sépalos ya estamos viendo diferencias entre las especies. Es teóricamente posible agregar una tercera dimensión para plotear otra de las variables, e incluso agregar la cuarta variable como "tamaño" de los diferentes puntos, pero dichos plots van a resultar considerablemente mas complejos al momento de leerlos.</p>
<h3 id="problema-a-resolver">Problema a resolver</h3>
<p>En este ejercicio vamos a suponer que alguien apretó el botón equivocado y borró la columna <strong>Species</strong> de dicha tabla. Como nos acordamos de que eran tres especies y que tenían diferencias en sus largos y anchos de pétalos y sépalos, queremos entonces usar métodos de clustering para tratar de recuperar lo mejor que podamos los tres grupos de flores.</p>
<p>Dicho esto vamos a hacer un poco de trampa y vamos a comparar visualmente lo que vamos obteniendo por los métodos de clustering con lo que nosotros sabemos es verdad.</p>
<p>Por último, cómo vamos a tener que hacer varios plots similares, vamos a aprovechar la oportunidad y vamos a usar por primera vez funciones de <strong>R</strong> creadas por nosotros.</p>
<h3 id="guardar-el-plot-en-un-pdf">Guardar el plot en un PDF</h3>
<p>Vamos a crear una función que guarde diferentes plots como PDFs.</p>
<p><strong>2)</strong> Copien el siguiente código y modifiquen las secciones que dicen <code>@@EDITAR@@</code>. Para esto vean el punto <strong>1)</strong> y asígnenle a cada parámetro de la función el valor que tenía en dicho punto, por ejemplo <code>x_colname = "Sepal.Length"</code> (el nombre de las columnas vá entre comillas porque estamos usando <code>aes_string()</code> y no <code>aes()</code>). Una vez hecho esto, corran la función para replicar el plot hecho en el punto <strong>1)</strong> y guardarlo en un archivo llamado <strong>01_Sepal_vs_Petal_Length_per_Species.pdf</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Código</label><label for="__tabbed_1_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#### FUNCIONES AUXILIARES ####</span>
<span class="n">plotData2PDF_wColor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">data_par</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color_colname</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">y_label</span><span class="p">,</span><span class="w"> </span><span class="n">plot_title</span><span class="p">,</span>
<span class="w">                                </span><span class="n">pdf_file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_par</span><span class="p">,</span><span class="w"> </span><span class="nf">aes_string</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_colname</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">xlab</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ylab</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="w">    </span><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="nf">dev.off</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">#### CODIGO PRINCIPAL ####</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="nf">plotData2PDF_wColor</span><span class="p">(</span><span class="n">data_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">color_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">plot_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w">                        </span>
<span class="w">                    </span><span class="n">pdf_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"01_Sepal_vs_Petal_Length_per_Species.pdf"</span><span class="p">)</span><span class="w">    </span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1">#Estoy usando comentarios rodeados de cuatro numerales para delimitar secciones de mi código </span>
<span class="c1">#Esto no es puramente estético, sino que también es aprovechado por *RStudio* para crear una de barra de </span>
<span class="c1">#navegación del código (es la barra horizontal entre el script y la consola)</span>
<span class="c1">#### FUNCIONES AUXILIARES ####</span>
<span class="n">plotData2PDF_wColor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">data_par</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color_colname</span><span class="p">,</span>
<span class="w">                                </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">y_label</span><span class="p">,</span><span class="w"> </span><span class="n">plot_title</span><span class="p">,</span>
<span class="w">                                </span><span class="n">pdf_file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#La función *aes_string()* es similar a *aes()*, solo que en este caso los nombres de las columnas </span>
<span class="w">    </span><span class="c1">#tienen que ser *strings* (recuerden que con *aes()* se escriben sin comillas)</span>
<span class="w">    </span><span class="c1">#Esto es ideal para cuando el nombre de la columna utilizar esta guardado en una variable</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_par</span><span class="p">,</span><span class="w"> </span><span class="nf">aes_string</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_colname</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_colname</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_colname</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">xlab</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ylab</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">              </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">))</span>

<span class="w">    </span><span class="c1">#*pdf()* "abre" un archivo pdf. Todo lo que se imprima hasta cerrarlo va a ir a él, </span>
<span class="w">    </span><span class="c1">#en vez de a la pestaña *Plots* de *RStudio*</span>
<span class="w">    </span><span class="c1">#8 y 7 indican el ancho y el alto del pdf en pulgadas</span>
<span class="w">    </span><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="c1">#La función *dev.off()* cierra el plot abierto, en este caso el pdf.</span>
<span class="w">    </span><span class="nf">dev.off</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">#### CODIGO PRINCIPAL ####</span>
<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="nf">plotData2PDF_wColor</span><span class="p">(</span><span class="n">data_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_iris</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">color_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span>
<span class="w">                    </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">y_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">plot_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"@@EDITAR@@"</span><span class="p">,</span><span class="w">      </span>
<span class="w">                    </span><span class="n">pdf_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"01_Sepal_vs_Petal_Length_per_Species.pdf"</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>3)</strong> Usando la función que acabamos de crear, vean como se distribuyen los puntos al comparar <strong>Sepal.Width</strong> contra <strong>Petal.Width</strong>. Guarden este plot en un archivo llamado <strong>02_Sepal_vs_Petal_Width_per_Species.pdf</strong>.</p>
<h3 id="clustering-jerarquico">Clustering jerárquico</h3>
<p>Lo primero que vamos a hacer entonces es usar un clustering jerárquico para agrupar a las 150 filas en 3 grupos según los valores de las 4 medidas. Un problema que tenemos es que por ahora no hay ninguna forma de identificar a una fila específica, así que le vamos a agregar un ID numérico a cada fila. Debido al orden que tienen las filas de <strong>dt_iris</strong>, los primeros 50 IDs van a corresponder a flores de la especie setosa, los segundos 50 a versicolor y los últimos a virginica (aunque supuestamente esto no lo sabemos).</p>
<p><strong>4)</strong> Corran el siguiente código para crear la matriz de datos que vamos a usar al momento de clusterizar. Lean los comentarios en la segunda pestaña para entender que estamos haciendo.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Código</label><label for="__tabbed_2_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">dt_iris</span><span class="o">$</span><span class="n">row_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">])</span>

<span class="nf">setcolorder</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"row_id"</span><span class="p">))</span>

<span class="n">matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">)],</span><span class="w"> </span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">#Agregamos una nueva columna denominada row_id que tiene un numero entre 1 y 150</span>
<span class="c1">#dt_iris[, .N] es una función de *Data Tables* que me devuelve el numero de filas en la tabla</span>
<span class="c1">#El numero de filas tambien se puede conseguir haciendo nrow(dt_iris)</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">row_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">])</span>

<span class="c1">#Aca estamos cambiando el orden de las columnas a *dt_iris*.</span>
<span class="c1">#No hace falta asignar esto a *dt_iris* ya que *setcolorder* modifica la variable misma </span>
<span class="c1">#Como solo le estamos pasando 1 columna, lo que estamos haciendo es mover esa columna al principio</span>
<span class="c1">#(al usar así *setcolorder* las otras se quedan donde estan)</span>
<span class="nf">setcolorder</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"row_id"</span><span class="p">))</span>

<span class="c1">#Similar a lo que hicimos en el TP anterior, estamos transformando nuestros datos a una matriz</span>
<span class="c1">#donde la primer columna (en este caso *row_id*) va a transformarse en los nombres de las filas</span>
<span class="c1">#Estamos sacando a la columna *Species* ya que queremos simular que no tenemos esta informacion</span>
<span class="c1">#(la columna *Species* va a estar todavia en *dt_iris*, pero no en *matriz_datos*)</span>
<span class="n">matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">)],</span><span class="w"> </span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>5)</strong> Usando lo aprendido en el TP anterior y la matriz de datos recién creada:</p>
<p><strong>5.1)</strong> Usen la función <code>dist()</code> para crear una matriz de distancias euclidianas que muestre también la diagonal.</p>
<p><strong>5.2)</strong> usen la función <code>hclust()</code> para crear un clustering jerárquico basado en su matriz de distancias usando el criterio de agregación <em>complete linkage</em>. </p>
<p><strong>5.3)</strong> Usen la función <code>plot()</code> para plotear el clustering jerárquico.</p>
<p><strong>5.4)</strong> Mirando el plot recién creado, ¿les es fácil distinguir a simple vista los tres grupos de especies en el clustering jerárquico? (recuerden que pueden usar el botón <strong>Zoom</strong> para agrandar el plot).</p>
<h4 id="mejorar-el-plot-del-clustering-jerarquico" markdown="markdown">Mejorar el plot del clustering jerárquico</h4>
<p><strong>6)</strong> Una cosa que vendría bien al momento de leer el plot recién creado sería colorear cada flor dependiendo de su especie. Si bien esto no es posible en este caso usando solo la función <code>plot()</code>, hay paquetes de <strong>R</strong> que nos van a permitir hacer esto:</p>
<p><strong>6.1)</strong> Usen la función <code>install.packages()</code> e instalen la librería <strong>dendextend</strong> (recuerden que al usar <code>install.packages()</code> el nombre del paquete va entre comillas). Luego corran el siguiente código:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Código</label><label for="__tabbed_3_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dendextend</span><span class="p">)</span>

<span class="c1">#Estoy asumiendo que guardaron la salida de *hclust()* en una variable llamada clustering_jerarquico</span>
<span class="c1">#De no ser asi, cambien el nombre de la variable a continuacion por lo que corresponda</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.dendrogram</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">)</span>

<span class="n">colores_especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">)</span>
<span class="n">colors_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">colores_especies</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="nf">labels_colors</span><span class="p">(</span><span class="n">dend</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colors_aux</span><span class="p">[</span><span class="nf">order.dendrogram</span><span class="p">(</span><span class="n">dend</span><span class="p">)]</span>

<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dend</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="s">"labels_cex"</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span>

<span class="n">pdf_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"11_Clustering_jerarquico_complete_linkage.pdf"</span>
<span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dend</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Clustering Jerárquico - Complete Linkage - Color per Species"</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dendextend</span><span class="p">)</span>

<span class="c1">#Estoy asumiendo que guardaron la salida de *hclust()* en una variable llamada clustering_jerarquico</span>
<span class="c1">#De no ser asi, cambien el nombre de la variable a continuacion por lo que corresponda</span>
<span class="c1">#Aca estoy transformando la variable *clustering_jerarquico* que es de tipo *hclust* a un *dendrogram*, </span>
<span class="c1">#que es una variable usada por el paquete *dendextend*</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.dendrogram</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">)</span>

<span class="c1">#La funcion *labels_colors()* me permite asignar a mano los colores para los 150 labels del dendrograma</span>
<span class="c1">#Ahora bien, yo se que originalmente en la tabla las primera 50 filas corresponden al color 1 y asi</span>
<span class="c1">#Lo que estoy haciendo aca es armar una lista de 150 colores ordenada como esta en la tabla original y luego</span>
<span class="c1">#reordenarlas para que coincidan con el orden de los IDs en el dendrograma</span>
<span class="n">colores_especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"#004D40"</span><span class="p">,</span><span class="s">"#D81B60"</span><span class="p">,</span><span class="s">"#FFC107"</span><span class="p">)</span>
<span class="n">colors_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">colores_especies</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="nf">labels_colors</span><span class="p">(</span><span class="n">dend</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colors_aux</span><span class="p">[</span><span class="nf">order.dendrogram</span><span class="p">(</span><span class="n">dend</span><span class="p">)]</span>

<span class="c1">#Esto simplemente es para achicar un poco el texto de los labels para que no choquen entre si</span>
<span class="c1">#El simbolo %&gt;% cumple una funcion similar al + en ggplot</span>
<span class="n">dend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dend</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="s">"labels_cex"</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span>

<span class="c1">#Creo el pdf de salida y guardo el clustering jerárquico</span>
<span class="n">pdf_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"11_Clustering_jerarquico_complete_linkage.pdf"</span>
<span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdf_file</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dend</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Clustering Jerárquico - Complete Linkage - Color per Species"</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>6.2)</strong> Abran el archivo <strong>11_Clustering_jerarquico_complete_linkage.pdf</strong>. ¿Pueden ahora distinguir los tres grupos de especies en el clustering jerárquico? ¿Cuáles especies les parecen mejor agrupadas? (los colores de las especies corresponden al color usado en el plot creado en los puntos <strong>1)</strong> y <strong>2)</strong>)</p>
<h4 id="single-linkage">Single Linkage</h4>
<p><strong>7)</strong> Hasta el momento sólo utilizamos <em>complete linkage</em> al momento de hacer nuestros clustering jerárquicos, pero sería interesante ver como es el dendrograma resultante de hacer el clustering usando otro criterio de agregación, por ejemplo el <em>single linkage</em>. Para esto:</p>
<p><strong>7.1)</strong> Vuelvan a correr la función <code>hclust()</code> como en <strong>5.2)</strong>, pero ahora usen <code>method = "single"</code> y guarden el clustering resultante en una nueva variable. Luego usen el código de <strong>6.1)</strong> editando lo que sea necesario para crear un archivo que contenga al dendrograma hecho a partir del clustering jerárquico que usa <em>single linkage</em> como criterio de agregación. Nombren a este archivo <strong>12_Clustering_jerarquico_single_linkage.pdf</strong>.</p>
<p><strong>7.2)</strong> ¿Qué diferencias ven entre este dendrograma y el creado en <strong>6.2)</strong>? ¿Pueden relacionar estas diferencias con lo que saben de <em>single linkage</em> y <em>complete linkage</em>?</p>
<p><strong>7.3)</strong> Ignorando los colores, ¿cuál les parece el mejor criterio de agregación para este caso donde queremos recuperar tres clusters?</p>
<h4 id="hacer-clusters-y-plots">Hacer clusters y plots</h4>
<p>Por último vamos a querer recrear el plot generado en los puntos <strong>1)</strong> y <strong>2)</strong>, pero ahora mostrando información tanto de las especies originales (con el color) como de la agrupación resultante del clustering jerárquico (con la forma). Vamos a utilizar los datos del clustering jerárquico que usa el criterio de agregación <em>complete linkage</em>.</p>
<p><strong>8)</strong> Lo primero es entonces agregar la información del clustering jerárquico a nuestro <strong>dt_iris</strong>; para ello:</p>
<p><strong>8.1)</strong> Usen la <code>cutree</code> para dividir a los datos obtenidos en <strong>5.2)</strong> en 3 clusters.</p>
<p><strong>8.2)</strong> Asignen esa información a una nueva columna en la tabla <strong>dt_iris</strong> llamada <strong>CJ_cluster</strong> (como en este caso <code>cutree()</code> devuelve los datos en el mismo orden que están en la tabla se puede hacer directamente con <code>&lt;-</code>, no hace falta usar <code>merge()</code>).</p>
<p><strong>8.3)</strong> Por el momento la variable es numérica, pero para nosotros los números 1, 2 y 3 son categorías que teóricamente corresponden a las especies (aunque no sabemos qué categoría corresponde a que especie). Corran el siguiente código para convertir la columna recién creada en un <em>factor</em>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#En este caso poner los levels a mano no es 100% necesario, pero no viene mal</span>
<span class="c1">#Recuerden que no sabemos que numero corresponde a que especie</span>
<span class="c1">#(porque ademas ya vimos que no hay un match perfecto 1 a 1)</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">CJ_cluster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">dt_iris</span><span class="o">$</span><span class="n">CJ_cluster</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
</code></pre></div>
<p><strong>9)</strong> Ahora queremos hacer un plot similar al creado en el punto <strong>2)</strong>, pero donde la columna <strong>Species</strong> determine el color y la columna <strong>CJ_cluster</strong> determine la forma de los diferentes puntos del plot; para ello:</p>
<p><strong>9.1)</strong> Copien la función <code>plotData2PDF_wColor()</code> y cámbienle en nombre a <code>plotData2PDF_wColorAndShape()</code>. Modifiquen esta nueva función considerando lo siguiente:</p>
<ul>
<li>Agreguen un parámetro a la función el cual va a recibir el nombre de la columna que determina la forma, o <em>shape</em>, de los puntos.</li>
<li>Modifiquen la función <code>aes_string()</code>, agregando la característica <code>shape</code> y asignándole el valor del parámetro agregado.</li>
<li>Agreguen la función <code>scale_shape_manual()</code> a <code>ggplot</code> para definir a mano las tres formas. Usen los valores <code>c(2, 4, 1)</code>.</li>
</ul>
<p><strong>9.2)</strong> Usando la función que acabamos de crear, vean como se distribuyen los puntos al comparar <strong>Sepal.Length</strong> contra <strong>Petal.Length</strong> usando la columna <strong>Species</strong> para determinar el color y la columna <strong>CJ_cluster</strong> para determinar la forma de los diferentes puntos. Guarden este plot en un archivo llamado <strong>21_Sepal_vs_Petal_Length_per_Species_CJ3.pdf</strong>.</p>
<p><strong>9.3)</strong> Abran el archivo recién creado. ¿Cuáles especies les parecen mejor agrupadas? Entre este plot y el dendrograma creado en <strong>11_Clustering_jerarquico_complete_linkage.pdf</strong> ¿Cuál les parece la mejor manera de representar este clustering? ¿Por qué?</p>
<div class="admonition danger">
<p class="admonition-title">Importante - Clustering vs Plot</p>
<p>Tengan en cuenta que al momento de clusterizar estamos usando los datos de las cuatro columnas de la tabla. Sin embargo, en este último plot estamos viendo solo la relación entre dos. Por esta razón, este plot no es realmente representativo del clustering que estamos haciendo.</p>
<p>Dicho todo esto, este plot es útil ya que es mucho más fácil de leer que otros plots más complejos, pero debe tomarse como un análisis exploratorio.</p>
</div>
<h3 id="kmeans">Kmeans</h3>
<p><strong>10)</strong> Lo último que vamos a hacer con este data set es volver a crear los clusters pero usando ahora la función <code>kmeans()</code>.</p>
<p><strong>10.1)</strong> Usando lo aprendido en el TP anterior:</p>
<ul>
<li>Usen la función <code>kmeans()</code> para crear un nuevo clustering. Usen la cantidad de <code>centers</code> que consideren necesarios.</li>
<li>Extraigan los clusters del clustering recién creado y asígnenlos a una nueva columna en <strong>dt_iris</strong> llamada <strong>K3_cluster</strong> (como en este caso <code>kmeans()</code> devuelve los datos en el mismo orden que están en la tabla se puede hacer directamente con <code>&lt;-</code>, no hace falta usar <code>merge()</code>).</li>
<li>Transformen dicha columna en un <em>factor</em>.</li>
<li>Usando la función creada en el punto <strong>9)</strong>, vean como se distribuyen los puntos al comparar <strong>Sepal.Length</strong> contra <strong>Petal.Length</strong> usando la columna <strong>Species</strong> para determinar el color y la columna <strong>K3_cluster</strong> para determinar la forma de los diferentes puntos. Guarden este plot en un archivo llamado <strong>22_Sepal_vs_Petal_Length_per_Species_K3.pdf</strong>.</li>
</ul>
<p><strong>10.2)</strong> Abran el archivo recién creado. Basándose solo en lo que pueden observar en este plot, ¿pueden decir algo de si este agrupamiento es mejor, peor o similar al obtenido con el clustering jerárquico? (recuerden que "no" también es una respuesta válida)</p>
<p><strong>10.3)</strong> Supongamos ahora que estamos en un escenario real, por lo que no tenemos información de a que especie corresponde cada punto. En base a lo visto en el TP anterior, ¿se les ocurre alguna forma de evaluar objetivamente cuál de ambos es el mejor clustering?</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Predeterminar el azar</p>
<p>La función <code>kmeans()</code> genera la primera posición de sus centros al azar. Esto hace que si la corren varias veces o en diferentes computadoras va a dar diferentes resultados cada vez. Esto se puede controlar con una función de <strong>R</strong> que asigna a mano el valor de la <em>seed</em>, que es el número base que usa <strong>R</strong> al momento de generar azar. Si les interesa hacer esto tienen que ejecutar la siguiente línea antes de usar la función <code>kmeans()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p>P.D.: El azar en las computadoras no existe realmente. Muchos programas usan lista pre-generadas de "números creados al azar" y otras usan cosas como "el quinto decimal de la temperatura del procesador en este momento", lo que se aproxima suficientemente al azar para funcionar bien.</p>
</div>
<h2 id="ejercicio-2-analizando-el-efecto-de-dos-inhibidores" markdown="markdown"><strong>Ejercicio 2 - Analizando el efecto de dos inhibidores</strong></h2>
<p>En el <strong>TP 8b</strong> hicimos un ejercicio donde usábamos el equipo <strong>FilterMax F5</strong> para analizar 22 inhibidores de una llamada <strong>Enzima Z</strong>, la cual resulta que era la cruzipaína, es decir, la cisteín proteasa principal de <em>Trypanosoma cruzi</em>, el parásito causante de la enfermedad de Chagas.</p>
<p>En esta segunda fase del experimento se eligieron 2 inhibidores y se realizó un análisis más detallado, estudiando como varía la expresión de miles de genes en presencia o ausencia de dichos inhibidores. Para esto se hizo un estudio de transcriptómica (RNA-seq) donde se extrajo el ARN y se lo analizó con <strong>Illumina</strong>. Luego, cada <em>read</em> encontrado se mapeó contra el genoma de referencia y se llegó a una tabla de conteo para cada uno de las transcriptos del genoma.</p>
<p>Para cada caso (<em>control</em>, <em>droga 1</em> y <em>droga 2</em>) se realizaron 3 réplicas técnicas para obtener resultados más robustos.</p>
<p>Nuestro objetivo va a ser entonces obtener una lista de los genes que son más afectados por cada droga.</p>
<h3 id="leer-los-datos">Leer los datos</h3>
<p><strong>1)</strong> Lean los archivos <strong>control_data.tsv</strong>, <strong>drug1_data.tsv</strong> y <strong>drug2_data.tsv</strong> que se encuentran en sus materiales de trabajo y guárdenlos en diferentes variables llamadas <strong>control_data</strong>, <strong>drug1_data</strong> y <strong>drug2_data</strong> respectivamente.</p>
<h3 id="estandarizar-los-datos">Estandarizar los datos</h3>
<p>El conteo de <em>reads</em> no se puede comparar entre genes puesto que la expresión basal de cada uno es distinto, por lo cual encontrar 10 <em>reads</em> de un gen puede ser mucho, y encontrar 1000 de otro puede ser poco. Además cada ensayo de secuenciación puede tener distinta profundidad con lo que tampoco sería viable comparar 10 <em>reads</em> de un ensayo donde en total se mapearon <span class="arithmatex">\(2\text{x}10^8\)</span> <em>reads</em> con los mismos 10 de otro ensayo donde se mapearon <span class="arithmatex">\(1\text{x}10^8\)</span> (es decir, la mitad).</p>
<p>Por esta razón vamos a querer modificar las nueve columnas y transformar el valor a "conteo por millón", cuya fórmula es:</p>
<div class="arithmatex">\[
\text{RPM or CPM} = \frac{ReadsDelGen * 10^6}{ReadsTotales}
\]</div>
<h3 id="combinar-las-replicas">Combinar las réplicas</h3>
<p>Otra cosa que vamos a querer hacer es combinar las tres réplicas para cada caso. Esto lo vamos a hacer simplemente promediando los 3 valores de CPM para cada gen en cada tratamiento.</p>
<p><strong>2)</strong> En base a los TPs anteriores ya tienen los conocimientos para hacer el estandarizado de datos y la combinación de réplicas usando <em>fors</em>, pero para hacerla un poco más fácil les vamos a dar un par de funciones que les van a simplificar bastante este paso (y ya que estamos les mostramos la función <code>apply()</code> en acción):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked id="__tabbed_4_1" name="__tabbed_4" type="radio"><input id="__tabbed_4_2" name="__tabbed_4" type="radio"><div class="tabbed-labels"><label for="__tabbed_4_1">Código</label><label for="__tabbed_4_2">Código con comentarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">calcularConteoPorMillon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un vector de *reads*, esta funcion lo transforma en CPM y devuelve el vector</span>

<span class="w">    </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1000000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">parsearDatos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">dt_par</span><span class="p">,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">nombre_columna_nueva</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un *Data Table*, un vector de *strings* con los nombres de las columnas con *reads* a parsear y</span>
<span class="w">    </span><span class="c1">#un nombre de una columna a crear, esta funcion:</span>
<span class="w">    </span><span class="c1"># - Transforma los *reads* de las columnas a parsear en CPM</span>
<span class="w">    </span><span class="c1"># - Calcula el promedio de los CPM por cada fila y lo guarda en una columna nueva con el nombre dado</span>
<span class="w">    </span><span class="c1"># - Saca las columnas a parsear del *Data Table*</span>
<span class="w">    </span><span class="c1"># - Devuelve el *Data Table* con los cambios</span>

<span class="w">    </span><span class="n">dt_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="n">matrix_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">dt_aux</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">calcularConteoPorMillon</span><span class="p">)</span>

<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">matrix_aux</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]],</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>

<span class="w">    </span><span class="n">dt_par</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">dt_par</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">calcularConteoPorMillon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un vector de *reads*, esta funcion lo transforma en CPM y devuelve el vector</span>

<span class="w">    </span><span class="c1">#Aca estoy asumiendo que sum(vector_cuentas) nunca es 0 (lo que tiene un poco</span>
<span class="w">    </span><span class="c1">#de sentido ya que si es 0 entonces todas los counts son 0)</span>
<span class="w">    </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_cuentas</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1000000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span><span class="w"> </span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">vector_cuentas</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">parsearDatos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">dt_par</span><span class="p">,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">nombre_columna_nueva</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">#Dado un *Data Table*, un vector de *strings* con los nombres de las columnas con *reads* a parsear y</span>
<span class="w">    </span><span class="c1">#un nombre de una columna a crear, esta funcion:</span>
<span class="w">    </span><span class="c1"># - Transforma los *reads* de las columnas a parsear en CPM</span>
<span class="w">    </span><span class="c1"># - Calcula el promedio de los CPM por cada fila y lo guarda en una columna nueva con el nombre dado</span>
<span class="w">    </span><span class="c1"># - Saca las columnas a parsear del *Data Table*</span>
<span class="w">    </span><span class="c1"># - Devuelve el *Data Table* con los cambios</span>

<span class="w">    </span><span class="c1">#Creo un nuevo *Data Table* que solo contenga las columnas a parsear (y no el ID del gen)</span>
<span class="w">    </span><span class="n">dt_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="c1">#La funcion *apply* con el parametro 2 va a ejecutar la funcion *calcularConteoPorMillon* para </span>
<span class="w">    </span><span class="c1">#cada COLUMNA de dt_aux (las tres replicas, en este caso)</span>
<span class="w">    </span><span class="n">matrix_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">dt_aux</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">calcularConteoPorMillon</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#La funcion *apply* con el parametro 1 va a ejecutar la funcion *mean* para </span>
<span class="w">    </span><span class="c1">#cada FILA de matrix_aux (cada uno de los genes estudiados)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">matrix_aux</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w">    </span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">dt_par</span><span class="p">[[</span><span class="n">nombre_columna_nueva</span><span class="p">]],</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Saco las columnas que ya no me interesan de *dt_par*</span>
<span class="w">    </span><span class="n">dt_par</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_par</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="n">columnas_a_parsear</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">dt_par</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>2.1)</strong> Corran las funciones anteriores para cargarlas en memoria, luego úsenlas para estandarizar y combinar las réplicas del control y las drogas 1 y 2. Un ejemplo de correr esta función para el caso de control sería:</p>
<div class="highlight"><pre><span></span><code><span class="n">control_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">parsearDatos</span><span class="p">(</span><span class="n">dt_par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control_data</span><span class="p">,</span>
<span class="w">                             </span><span class="n">columnas_a_parsear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"control1"</span><span class="p">,</span><span class="w"> </span><span class="s">"control2"</span><span class="p">,</span><span class="w"> </span><span class="s">"control3"</span><span class="p">),</span>
<span class="w">                             </span><span class="n">nombre_columna_nueva</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"control"</span><span class="p">)</span>
</code></pre></div>
<p><strong>2.2)</strong> Ahora que ya tenemos los datos parseados, usen la función <code>merge()</code> dos veces para combinar los 3 <em>Data Tables</em> en uno solo llamado <strong>full_data</strong> (si todo salió bien debería tener 11.106 filas y 4 columnas).</p>
<h3 id="calcular-el-fold-change">Calcular el Fold Change</h3>
<p><strong>3)</strong> Algo mencionamos antes, pero concluir que "hay 10 CPM más al agregarle la droga" no significa nada en el vacío. Si en el control era solo 1 CPM, entonces 10 más es mucho. Si en el control eran 10.000 CPM, 10 más es insignificante.</p>
<p>Vamos entonces a calcular el fold change, es decir, cuantas veces más (o menos) de CPM fueron observados al agregarle la droga frente a cuando estaba solo el control. Esto lo calculamos como:</p>
<div class="arithmatex">\[
\text{Fold Change} = \frac{\text{CPM Droga}}{\text{CPM Control}}
\]</div>
<p><strong>3.1)</strong> Antes de seguir leyendo ¿Se les ocurre algún caso donde la fórmula anterior nos de problemas?</p>
<details class="tip">
<summary>Respuesta</summary>
<p>Básicamente hay 2 casos donde el cálculo del Fold Change va a dar problemas:</p>
<ul>
<li>Cuando <strong>CPM Control = 0</strong>: La división no se puede hacer (y de hacerla en <strong>R</strong> va a dar infinito)</li>
<li>Cuando <strong>CPM Control ~ 0</strong>: En este caso la división se hace, pero el Fold Change va a dar un número muy grande (y probablemente varios órdenes de magnitud más grande que el resto de los Fold Change calculados). Este Fold Change no se debe a que <strong>CPM Droga</strong> es realmente mayor, sino a que <strong>CPM Control</strong> es muy chico, por lo que no es realmente informativo.</li>
</ul>
</details>
<p>Estos dos problemas se pueden arreglar agregando un número <em>buffer</em>, es decir, un número pequeño que se adiciona al numerador y al denominador. En este caso vamos a usar 0,125 con lo que la fórmula quedaría:</p>
<div class="arithmatex">\[
\text{Fold Change} = \frac{\text{CPM Droga} + 0.125}{\text{CPM Control} + 0.125}
\]</div>
<p><strong>3.2)</strong> ¿Qué pasa ahora en los dos casos problemáticos que estamos tratando resolver? ¿Cómo afecta este <em>buffer</em> a los casos "normales"? (es decir, cuando tanto el numerador como el denominador son números mayores a 1)</p>
<p><strong>3.3)</strong> Usando la fórmula con <em>buffer</em>, calculen el Fold Change para ambas drogas y guárdenlos en nuevas columnas de la tabla <strong>full_data</strong> (pónganles nombres que representen la información que contienen).</p>
<h3 id="transformar-el-fold-change">Transformar el Fold Change</h3>
<p>Ahora bien, vamos a analizar como se distribuyen los valores del Fold Change para todas las proteínas (primera pestaña del plot que está abajo). Podemos ver que si bien el Fold Change llega hasta 20 en algunos casos, la gran mayoría de ellas tienen Fold Changes menores a 4.</p>
<p>En el paso siguiente vamos a querer agrupar nuestros genes por como se comportan frente a las drogas 1 y 2 clusterizando con <code>kmeans()</code> y luego plotearlo en un <em>heatmap</em>. En este momento la mayoría de los datos se encuentran en un pequeño rango del "espectro" de Fold Change, por lo que al momento de agrupar por similitud básicamente van a formar un único gran cluster, lo que no da información.</p>
<p>Por esta razón queremos convertir nuestros datos a una escala logarítmica. Como Fold Change solo llega hasta 20 vamos a usar una escala logarítmica en base 2. En <strong>R</strong> esto se hace usando la función <code>log()</code>. Por defecto esta función usa como base a <span class="arithmatex">\(e\)</span>, es decir, es el logaritmo natural. Sin embargo, se le puede cambiar la base a 2 pasándole el parámetro <code>base = 2</code> (ver la segunda pestaña en el siguiente plot).</p>
<p><strong>4)</strong> Usando la función <code>log()</code> con el parámetro necesario, calculen el logaritmo en base 2 de los Fold Change para ambas drogas y guárdenlos en nuevas columnas de la tabla <strong>full_data</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked id="__tabbed_5_1" name="__tabbed_5" type="radio"><input id="__tabbed_5_2" name="__tabbed_5" type="radio"><div class="tabbed-labels"><label for="__tabbed_5_1">Fold Change para la Droga 1</label><label for="__tabbed_5_2">Log2(Fold Change) para la Droga 1</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
<a class="glightbox" href="img/HistogramaDroga1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HistogramaDroga1" src="img/HistogramaDroga1.png"></a>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
<a class="glightbox" href="img/HistogramaLog2Droga1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HistogramaLog2Droga1" src="img/HistogramaLog2Droga1.png"></a>
</figure></p>
</div>
</div>
</div>
<h3 id="plotear-el-heatmap">Plotear el Heatmap</h3>
<p>El <em>heatmap</em> es un tipo de plot que no vimos hasta el momento, pero que tal vez conozcan. La versión básica del heatmap nos permite graficar valores numéricos como una escala de colores lo que nos permite ver diferencias entre filas rápidamente e incluso encontrar filas similares o patrones.</p>
<p>A continuación mostramos un ejemplo que usa los datos estandarizados del <strong>Ejercicio 2</strong> del <strong>TP 12a</strong> (la tabla ejemplo con los 4 genes, <strong>matriz_datos_ST</strong>):</p>
<figure>
<p><a class="glightbox" href="img/heatmapEjemplo.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="HeatmapEjemplo" src="img/heatmapEjemplo.png"></a></p>
</figure>
<p>No solo nos permite ver rápidamente que hay 2 grupos de genes, sino que este paquete de heatmap también va a agrupar las filas por similitud y mostrar un dendrograma de similitud (todo esto se puede poner o sacar con parámetros).</p>
<p><strong>5)</strong> En nuestro caso tenemos miles de genes, por lo que es complicado usar un <em>heatmap</em> que los muestre a todos por separado. Vamos entonces a clusterizarlos por similitud usando <code>kmeans</code>, lo cual en este caso se puede hacer desde el mismo paquete que hace el <em>heatmap</em>. Al momento de definir clusters no sabemos cuántos son, por lo que vamos a elegir un número relativamente grande, sabiendo que eso puede resultar en varios clusters que son muy similares.</p>
<p><strong>5.1)</strong> Instalen en <strong>R</strong> el paquete <strong>pheatmap</strong>.</p>
<p><strong>5.2)</strong> Corran el siguiente código reemplazando <strong>log2_fold_change_drug1_wBuffer</strong> y <strong>log2_fold_change_drug2_wBuffer</strong> por el nombre de las columnas que contienen el logaritmo en base 2 de los Fold Change:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">pheatmap</span><span class="p">)</span>

<span class="c1">#Como *pheatmap* usa kmeans adentro inicializo la seed para que el plot de igual en todos lados siempre</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">#Me quedo solo con las columnas a plotear (en este caso el log 2 de los Fold Change para ambas drogas)</span>
<span class="n">plot_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">full_data</span><span class="p">[,</span><span class="w"> </span><span class="nf">.</span><span class="p">(</span><span class="n">log2_fold_change_drug1_wBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">log2_fold_change_drug2_wBuffer</span><span class="p">)]</span>

<span class="c1">#Uso la funcion *pheatmap* para hacer un heatmap mas lindo</span>
<span class="nf">pheatmap</span><span class="p">(</span><span class="n">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot_data</span><span class="p">,</span><span class="w"> </span><span class="n">kmeans_k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>kmeans_k = 10</code> le está diciendo que agrupe los datos en 10 clusters, similar a correr <code>kmeans(plot_data, centers = 10)</code></li>
<li><code>cluster_col = F</code> le está diciendo que no trate de agrupar las columnas por similitud y que no haga un dendrograma asociado</li>
</ul>
<p><strong>5.3)</strong> Mirando los 10 clusters que acabamos de crear, para que clusters de genes se observa:</p>
<ul>
<li>Fold change alto para ambas drogas</li>
<li>Fold change bajo para ambas drogas</li>
<li>Fold change alto para la droga 1 y bajo la droga 2</li>
<li>Fold change bajo para la droga 1 y alto la droga 2</li>
</ul>
<h3 id="calcular-genes-mas-afectados" markdown="markdown">Calcular genes más afectados</h3>
<p><strong>6)</strong> Si bien el <em>heatmap</em> nos da una idea global de como actuaron las drogas, nuestro objetivo es entender un poco más de su funcionamiento. Para esto, vamos a analizar la lista de genes que se vieron afectados por ellas.</p>
<p>Para obtener esta lista es necesario entonces definir un umbral numérico de Fold Change a partir del cual consideramos que el cambio fue "significativo" para nosotros. Estos umbrales se pueden elegir en base a conocimientos previos, en base a controles positivos y negativos, o mediante prueba y error (analizando qué y cuántos genes quedan por encima del umbral).</p>
<p>Otra cosa a considerar es que en este caso estamos analizando drogas que funcionan como inhibidores, por lo que no nos interesa solo los genes con Fold Change alto, sino que incluso nos interesan más los genes con Fold Change bajo (que debido a como se calculó quiere decir cercanos a 0).</p>
<p>En este caso vamos a quedarnos con aquellos genes que cumplan alguna de las siguientes condiciones:</p>
<ul>
<li><span class="arithmatex">\(log_2(FoldChange) \geq 1.5\)</span> (es decir <span class="arithmatex">\(FoldChange \geq 2.83 = 2^{1.5}\)</span>)</li>
<li><span class="arithmatex">\(log_2(FoldChange) \leq -1.5\)</span> (es decir <span class="arithmatex">\(FoldChange \leq \frac{1}{2.83} = 2^{-1.5}\)</span>)</li>
</ul>
<p>O sea, que nos vamos a quedar con aquellos genes que tienen un CPM 2.83 veces más grande o más chico que el control.</p>
<p><strong>6.1)</strong> Filtren <strong>full_data</strong> para quedarnos con aquellas filas donde el logaritmo en base 2 del Fold Change de la droga 1 sea mayor a 1.5 o menor a -1.5. Guarden la lista de los IDs de las proteínas que cumplen esa condición en una nueva variable. Hagan lo mismo para la droga 2.</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Calcular el valor absoluto</p>
<p>La función <code>abs()</code> nos devuelve el valor absoluto de un número. Si bien es posible filtrar estos datos usando simplemente un <strong>OR</strong>, también lo pueden hacer usando <code>abs()</code>, lo que prefieran.</p>
</div>
<p><strong>6.2)</strong> Usen <code>write.table()</code> para generar un nuevo archivo llamado <strong>affected_genes_drug1</strong> y guarden en él los IDs recién calculados para la droga 1. Tengan en cuenta que queremos solo los IDs, por lo que tienen que cambiar los parámetros de la función para que no haya nombres de las filas, nombres de las columnas ni comillas. Hagan lo mismo para la droga 2.</p>
<h3 id="buscar-nuestros-genes-en-bases-de-datos" markdown="markdown">Buscar nuestros genes en bases de datos</h3>
<p><strong>7)</strong> Lo último que vamos a hacer con esta información es investigar en bases de datos para tratar de entender un poco más que procesos biológicos están siendo afectados por nuestras drogas. Como estamos trabajando con <em>Trypanosoma cruzi</em> vamos a ir a una página que se especializa en tripanosomátidos llamada <strong>TriTrypDB</strong>.</p>
<p><strong>7.1)</strong> Entren a <a href="https://tritrypdb.org/tritrypdb/app/search/transcript/GeneByLocusTag">este link</a> y copien la lista de IDs que acabamos de crear para la droga 1. Hagan click en <strong>Get Answer</strong>.</p>
<p><strong>7.2)</strong> Una vez que se hayan cargados los datos vayan a <strong>Analyze Results</strong> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> <strong>Gene Onthology Enrichment</strong>, asegúrense que este checkeado <strong>Biological Process</strong> y aprieten <strong>Submit</strong> (disclaimer: esta parte a veces no anda y hay que probar otro día).</p>
<details class="tip">
<summary>Tip - Ubicación del botón <strong>Analyze Results</strong></summary>
<p><figure markdown>
<a class="glightbox" href="img/analyzeResults.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="AnalyzeResults" src="img/analyzeResults.png"></a>
</figure></p>
</details>
<p><strong>7.3)</strong> Esta tabla muestra procesos biológicos relacionados con nuestra lista de genes. A grandes rasgos, ¿qué procesos biológicos parecen estar afectados directa o indirectamente por la droga 1? Para responder esto pueden ordenar la tabla obtenida por la columna <strong>P-value</strong> en forma ascendente o pueden presionar el botón <strong>Show Word Cloud</strong> que se encuentra arriba de la tabla para ver un <em>Word Cloud</em> de los diferentes procesos biológicos.</p>
<p><strong>7.4)</strong> Hagan <strong>7.1)</strong>, <strong>7.2)</strong> y <strong>7.3)</strong> para la droga 2.</p>
<p><strong>7.5)</strong> ¿Que habría que cambiar en lo que hicimos en el punto <strong>6)</strong> si sólo nos interesaran los procesos biológicos que son inhibidos por nuestras drogas?</p>
<h2 id="bibliografia"><strong>Bibliografía</strong></h2>
<!--
### :material-bookshelf: Libros
* Libro 1 
* Libro 2
-->

<!--
### :material-web: Online
* Online 1 
* Online 2 https://en.wikipedia.org/wiki/R_(programming_language)
-->

<h3 id="consola-de-r"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"></path></svg></span> Consola de R</h3>
<ul>
<li>Comando <code>help()</code></li>
</ul></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Area Bioinformática UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>