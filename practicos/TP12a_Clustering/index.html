
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/2022_introduccion_bioinformatica/practicos/TP12a_Clustering/">
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.15">
    
    
      
        <title>Index - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.c382b1dc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-12a-data-mining-clustering" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../acerca/" class="md-tabs__link">
      Acerca de
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contenidos/" class="md-tabs__link">
      Contenidos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cronograma/" class="md-tabs__link">
      Cronograma
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../docentes/" class="md-tabs__link">
      Docentes
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../teoricas/inicio/" class="md-tabs__link">
        Teoricas
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../inicio/" class="md-tabs__link">
        Prácticos
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../instructivos/inicio/" class="md-tabs__link">
        Instructivos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/favicon.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contenidos/" class="md-nav__link">
        Contenidos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cronograma/" class="md-nav__link">
        Cronograma
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../docentes/" class="md-nav__link">
        Docentes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teoricas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teoricas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teoricas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        Teórica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        Teórica 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/3-Teorica-Tres/" class="md-nav__link">
        Teórica 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/4-Teorica-Cuatro/" class="md-nav__link">
        Teórica 4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/5-Teorica-Cinco/" class="md-nav__link">
        Teórica 5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/6-Teorica-Seis/" class="md-nav__link">
        Teórica 6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/7-Teorica-Siete/" class="md-nav__link">
        Teórica 7
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Prácticos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Prácticos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        TP 1 - Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP02_EMBOSS/" class="md-nav__link">
        TP 2 - EMBOSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP03_Alineamientos/" class="md-nav__link">
        TP 3 - Alineamientos de a pares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP04_Busqueda_por_similitud/" class="md-nav__link">
        TP 4 - Búsqueda por similitud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP05_PSI-BLAST/" class="md-nav__link">
        TP 5 - Perfiles de secuencias
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP06_Filogenia/" class="md-nav__link">
        TP 6 - Filogenias
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Instructivos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instructivos" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Instructivos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/maquina_virtual/" class="md-nav__link">
        Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/problemasVM/" class="md-nav__link">
        Problemas instalando la Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/tipsVM/" class="md-nav__link">
        Tips and Tricks para usar la Máquina Virtual más cómodos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<p><img _="," align="left" alt="Image" src="img/clustering.png" width="250" /></p>
<h1 id="tp-12a-data-mining-clustering" markdown="markdown"><strong>TP 12a</strong>. Data Mining - Clustering</h1>
<p><br>
<br>
<br>
<br>
<br>
<br></p>
<p><a class="md-button md-button--primary" href="#"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M480 352H346.5l-45.25 45.25C289.2 409.3 273.1 416 256 416s-33.16-6.656-45.25-18.75L165.5 352H32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h448c17.67 0 32-14.33 32-32v-96c0-17.7-14.3-32-32-32zm-48 104c-13.2 0-24-10.8-24-24s10.8-24 24-24 24 10.8 24 24-10.8 24-24 24zm-198.6-81.4c6.2 6.3 14.4 9.4 22.6 9.4s16.38-3.125 22.62-9.375l128-128c12.49-12.5 12.49-32.75 0-45.25-12.5-12.5-32.76-12.5-45.25 0L288 274.8V32c0-17.67-14.33-32-32-32-17.7 0-32 14.33-32 32v242.8l-73.4-73.4c-12.49-12.5-32.75-12.5-45.25 0-12.49 12.5-12.49 32.75 0 45.25L233.4 374.6z"/></svg></span> Materiales</a></p>
<!--
Este es el botón para descargar materiales, en (#) hay que agregar el link correspondiente
-->

<h3 id="software-a-usar">Software a usar</h3>
<ul>
<li>R (ya instalado en la VM).</li>
<li>RStudio (ya instalado en la VM)</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>ver si algo mas</p>
</div>
<h3 id="recursos-online">Recursos Online</h3>
<ul>
<li>Introducción a <strong>R</strong>, TP 8 de esta materia: <a href="../TP08a_R">Parte 1</a> y <a href="../TP08b_R">Parte 2</a> </li>
<li>hclust https://www.datanovia.com/en/lessons/agglomerative-hierarchical-clustering/</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>ver si algo mas, rehacer imagen inicial (algo mas grande, mejor definicion)</p>
</div>
<h3 id="objetivos">Objetivos</h3>
<ul>
<li>Familiarizarse con técnicas para analizar grandes conjuntos de datos y encontrar patrones o comportamientos similares entre ellos.</li>
<li>Familiarizarse con el funcionamiento del clustering jerárquico aglomerativo.</li>
<li>Familiarizarse con el método de clustering particional <em>K-means</em>.</li>
<li>Explorar algunas medidas de calidad de los clusters, como la silueta o <em>silhouette</em>.</li>
<li>Aplicar los conocimientos adquiridos para analizar e interpretar un conjunto de datos reales de expresión génica con microarrays.</li>
</ul>
<h2 id="introduccion-al-tema"><strong>Introducción al Tema</strong></h2>
<p>En este TP vamos a retomar el trabajo con <strong>R</strong>. Recomendamos repasar o tener a mano el TP 8 de esta materia por si necesitan recordar como hacer ciertos comandos (<a href="../TP08a_R">Parte 1</a> y <a href="../TP08b_R">Parte 2</a>).</p>
<p>(Agregar algo de Data Mining)</p>
<p>Durante el TP vamos a utilizar técnicas básicas para encontrar conglomerados o clusters en un conjunto de datos biológicos. La idea es identificar agrupamientos naturales en los datos, que presenten un comportamiento similar entre sí, con alguna relevancia biológica.</p>
<p>En particular utilizaremos conjuntos de datos provenientes de medidas de expresión génica generadas mediante experimentos con microarrays con muestras tomadas a diferentes tiempos con el objetivo de identificar grupos o clusters de genes que tengan un perfil de expresión común.</p>
<div class="admonition danger">
<p class="admonition-title">to do</p>
<p>re redactar este ultimo parrafo</p>
</div>
<h2 id="ejercicio-1-clustering-jerarquico-manual" markdown="markdown"><strong>Ejercicio 1 - Clustering Jerárquico Manual</strong></h2>
<p>Para empezar este TP vamos a realizar un pequeño clustering jerárquico a mano para repasar el concepto.</p>
<p>Supongamos que tenemos cuatro genes (A, B, C y D) para los cuales medimos el nivel de expresión a las 0hs, 1hs y 2hs luego de algún tratamiento:</p>
<figure>
<table>
<thead>
<tr>
<th align="center" data-sort-method="none">gen</th>
<th align="center" data-sort-method="none">t_0h</th>
<th align="center" data-sort-method="none">t_1h</th>
<th align="center" data-sort-method="none">t_2h</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">genA</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">genB</td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">-2</td>
</tr>
<tr>
<td align="center">genC</td>
<td align="center">-2</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">genD</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">-6</td>
</tr>
</tbody>
</table>
</figure>
<p>Queremos entonces agrupar a los diferentes genes por como varían sus niveles de expresión cuando se aplica dicho tratamiento. Para hacer esto vamos a:</p>
<ul>
<li>Calcular la distancia euclidiana entre los diferentes genes</li>
<li>Construir una matriz de distancias</li>
<li>Agruparlos usando clustering jerárquico donde el criterio de agregación va a ser "vecino más lejano" o <em>complete linkage</em></li>
<li>Repetir todo lo anterior, pero estandarizando previamente los datos de niveles de expresión</li>
</ul>
<p>Si no entienden algunos de estos conceptos pueden leer un poco más sobre ellos a continuación (y más todavía en la teórica):</p>
<details class="info">
<summary>Distancia euclideana</summary>
<p>Es una de las varias formas de calcular una distancia entre dos vectores de datos, lo cual es necesario al momento de calcular una matriz de distancias. Por ejemplo, suponiendo que tenemos 2 vectores de forma <span class="arithmatex">\(V = (x, y, z)\)</span> la distancia euclideana entre ellos se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclideana(V_1, V_2) = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2}
\]</div>
<p>Aplicando esto a nuestros datos, la distancia entre los genes A y B se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclideana(genA, genB) = \sqrt{(2 - (-1))^2 + (4 - (-1))^2 + (8 - (-2))^2} = 11,58
\]</div>
</details>
<details class="info">
<summary>Matriz de distancias</summary>
<p>Es una matriz donde tanto las filas como las columnas representan un mismo conjunto de elementos y en cada intersección se pone la distancia (en nuestro caso euclideana) entre dos elementos específicos. Es la base de muchos métodos de clustering.</p>
<p>Para nuestros datos la matriz de distancias entre los cuatro genes es:</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center" data-sort-method="none">genA</th>
<th align="center" data-sort-method="none">genB</th>
<th align="center" data-sort-method="none">genC</th>
<th align="center" data-sort-method="none">genD</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">genA</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">genB</td>
<td align="center">11,58</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">genC</td>
<td align="center">9</td>
<td align="center">3,32</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">genD</td>
<td align="center">15</td>
<td align="center">4,12</td>
<td align="center">7,35</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Como el órden de los elementos es igual para las filas que para las columnas, en la diagonal se compara cada elemento contra sí mismo por lo que la distancia es 0. Por otro lado, estamos llenando solo la mitad de la matriz ya que las matrices de distancia son matrices simétricas, es decir, que el triángulo superior derecho de la matriz va a ser un reflejo del triángulo inferior izquierdo.</p>
</details>
<details class="info">
<summary>Clustering jerárquico</summary>
<p>Clustering jerárquico es una forma de agrupar elementos dependiendo de que tan similares son entre ellos. Usa un algoritmo bastante sencillo de entender que se basa en una matriz de distancias:</p>
<ol>
<li>
<p>Sin considerar a la diagonal, encontrar el par de elementos (fila, columna) que son más similares entre sí (el menor número en la matriz de distancias). En nuestra matriz de distancias los elementos más parecidos son <strong>"genB"</strong> y <strong>"genC"</strong> ya que tienen la menor similitud (3,32)</p>
</li>
<li>
<p>Dejar constancia de dicha similitud y reconstruir la matriz, reemplazando ambos elementos por uno nuevo ( saco los elementos <strong>"genB"</strong> y <strong>"genC"</strong> y agrego el elemento <strong>"genB+C"</strong>)</p>
</li>
<li>
<p>Al momento de calcular la nueva distancia entre este nuevo elemento (<strong>"genB+C"</strong>) y el resto de los elementos de la matriz, usar algún criterio de agregación (por ej: <em>single linkage</em>, <em>average linkage</em> o <em>complete linkage</em>)</p>
</li>
<li>
<p>Volver al paso 1 hasta que todos los elementos estén unidos entre sí</p>
</li>
</ol>
<p>Una vez hecho esto puedo dibujar el clustering jerárquico teniendo en cuenta qué elementos se juntaron con qué elementos.</p>
</details>
<details class="info">
<summary>Criterios de agregación</summary>
<p>Los criterios de agregación indican que operación hay que hacer al momento de calcular la distancia entre un nuevo elemento creado en una matriz de distancias y los ya existentes. Cada uno tiene sus ventajas y desventajas.</p>
<p>Siguiendo con nuestro ejemplo, si queremos calcular la distancia entre el nuevo elemento <strong>"genB+C"</strong> y el <strong>"genA"</strong>:</p>
<ul>
<li><strong>Single Linkage:</strong> la nueva distancia es la <strong><em>menor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Complete Linkage:</strong> la nueva distancia es la <strong><em>mayor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Average Linkage:</strong> la nueva distancia es el <strong><em>promedio</em></strong> de las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
</ul>
</details>
<ol>
<li>
<p>Para agilizar un poco este Ejercicio les vamos a dar una planilla de Google Sheets que contiene la base de lo que vamos a necesitar. Abran <a href="https://docs.google.com/spreadsheets/d/1RBQNAsE1N6PPfKLWCqtYuuiYVqlTcPUQeeQX3PZmre8/edit?usp=sharing">esta planilla de Google Sheets</a> y hagan una copia. Leyendo la siguiente información, traten de entender que hace las diferentes partes de dicha planilla (desde ya, hay partes vacías que vamos a completar).</p>
<ul>
<li>
<p>Pestaña <strong>Plot Señal</strong></p>
<ul>
<li><strong>Columnas A - D:</strong> contienen nuestros datos</li>
<li><strong>Columnas F y G:</strong> contienen el promedio y la desviación estandar de cada gen (vacío, ahora lo hacemos)</li>
<li><strong>Columnas I - L:</strong> contienen nuestros datos estandarizados (vacío, ahora lo hacemos)</li>
<li><strong>Plot izquierdo:</strong> plot de la evolución de los niveles de expresión a los 3 tiempos para los 4 genes</li>
<li><strong>Plot derecho:</strong> plot de la evolución de los niveles de expresión estandarizados a los 3 tiempos para los 4 genes (se hace solo al llenar datos)</li>
</ul>
</li>
<li>
<p>Pestaña <strong>Clustering</strong></p>
<ul>
<li><strong>Columnas A - D:</strong> contienen nuestros datos</li>
<li><strong>Columnas F - J:</strong> contienen el cálculo de las distancias euclideanas entre las filas</li>
<li><strong>Columnas L - P:</strong> contienen la matriz de distancias para nuestros datos (y matrices más chicas donde se van a ir escribiendo los varios pasos al hacer el clustering a mano)</li>
</ul>
</li>
<li>
<p>Pestaña <strong>Clustering Estandarizado</strong></p>
<ul>
<li>Igual que <strong>Clustering</strong>, pero para datos estandarizados (vacío, ahora lo hacemos)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Mirando el <strong>Plot izquierdo</strong> de la pestaña <strong>Plot Señal</strong>, ¿de qué forma les parece que se van a agrupar los cuatro genes en el clustering jerárquico?</p>
</li>
<li>
<p>Ahora vamos a calcular el clustering jerárquico:</p>
<ol>
<li>
<p>Vayan a la pestaña <strong>Clustering</strong>. Usando la matriz de distancias ubicada en las <strong>Columnas L - P</strong>, calculen a mano el clustering jerárquico para nuestros datos usando <em>complete linkage</em>.</p>
</li>
<li>
<p>Hagan un esquema del dendrograma o árbol de similitud que resulta de este clustering. Pueden usar la herramienta <strong>Dibujo</strong> de Google Sheets (no se preocupen por el largo de las ramas, solo nos importa como se unen los genes).</p>
</li>
<li>
<p>¿Dió similar a lo que habían propuesto en el punto <strong>2</strong>?</p>
</li>
</ol>
</li>
<li>
<p>Queremos ahora calcular nuestros datos estandarizados donde vamos a estandarizar por gen, restandole a cada dato el promedio de los tres tiempos para ese gen y dividiendo el resultado por la desviación estándar de los tres tiempos para ese gen. Es decir:</p>
<div class="arithmatex">\[
datoEstandarizado(genA, t_0) = \frac{dato(genA, t_0) - promedio(genA)}{desviacionEstandar(genA)}
\]</div>
<p>Para hacer esto:</p>
<ol>
<li>
<p>En la pestaña <strong>Plot Señal</strong>, completen las <strong>columnas F y G</strong> para que calculen el promedio y la desviación estándar para los tres tiempos de cada uno de los cuatro genes.</p>
</li>
<li>
<p>En la pestaña <strong>Plot Señal</strong>, completen las <strong>columnas J a L</strong> para que calculen los valores estandarizados de los datos en base a la fórmula anterior.</p>
<details class="tip">
<summary>Tip - Copiar y pegar una fórmula en Google Sheets manteniendo una parte constante</summary>
<p>En Google Sheets, así como en Excell y otras hojas de cálculo, es posible "arrastrar" una fórmula, por lo que podrían calcular el dato estandarizado para un solo número (por ej celda <strong>J2</strong>) y luego copiar dicha fórmula al resto de las celdas.</p>
<p>Sin embargo, de usar este método para calcular los valores estandarizados tendríamos problemas, ya que se movería también la referencia en la fórmula a las celdas del promedio y la desviación estándar (las cuales queremos que se muevan con la fórmula para abajo, pero no para la derecha).</p>
<p>Por suerte es posible controlar esto agregandole el símbolo <strong>$</strong> adelante de la fila o columna. Es decir, si la fórmula apunta a <strong>F2</strong> y no queremos que se mueva horizontalmente (es decir, no queremos que cambie la <strong>F</strong>), podemos agregar el símbolo <strong>$</strong> en la fórmula con lo que quedaría <strong>$F2</strong>. Si ahora arrastramos (o copiamos y pegamos) dicha fórmula, el <strong>2</strong> puede cambiar, pero la <strong>F</strong> se va a mantener siempre como <strong>F</strong>.</p>
</details>
</li>
<li>
<p>Una vez calculados los datos estandarizados debería aparecerles el plot en el <strong>Plot derecho</strong>. ¿De qué forma les parece que se van a agrupar los cuatro genes en el clustering jerárquico usando los datos estandarizados?</p>
</li>
</ol>
</li>
<li>
<p>El próximo paso es calcular la matriz de distancias para nuestros datos estandarizados:</p>
<ol>
<li>
<p>Copien los datos recien calculados a la pestaña <strong>Clustering Estandarizado</strong> (ojo que queremos los valores, no las fórmulas).</p>
</li>
<li>
<p>En la <strong>columna J</strong>, calculen las distancias euclideanas entre los diferentes genes.</p>
</li>
<li>
<p>Copien a mano las distancias recién calculadas a las posiciones correspondientes de la matriz de distancias en las <strong>Columnas L - P</strong>.</p>
</li>
</ol>
</li>
<li>
<p>Por último vamos a calcular el clustering jerárquico para nuestros datos estandarizados:</p>
<ol>
<li>
<p>Asegurensé que estan en la pestaña <strong>Clustering Estandarizado</strong>. Usando la matriz de distancias ubicada en las<br />
<strong>Columnas L - P</strong>, calculen a mano el clustering jerárquico para nuestros datos estandarizados usando <em>complete linkage</em>.</p>
</li>
<li>
<p>Hagan un esquema del dendrograma o árbol de similitud que resulta de este clustering. Pueden usar la herramienta <strong>Dibujo</strong> de Google Sheets (no se preocupen por el largo de las ramas, solo nos importa como se unen los genes).</p>
</li>
<li>
<p>¿Dió similar a lo que habían propuesto en el punto <strong>4.c</strong>?</p>
</li>
</ol>
</li>
<li>
<p>Comparando los clusterings obtenidos con los datos estandarizados y sin estandarizar.</p>
<ol>
<li>¿Qué similitudes y diferencias observan?</li>
<li>¿Cuál de los dos clusterings les parece mejor para este escenario donde queríamos evaluar como afectaba un tratamiento los niveles de expresión de diferentes genes?</li>
<li>¿Les parece qué es siempre correcto estandarizar los datos de esta forma o se les ocurre escenarios donde no es así?</li>
</ol>
</li>
</ol>
<h2 id="ejercicio-2-clustering-jerarquico-con-r" markdown="markdown"><strong>Ejercicio 2 - Clustering Jerárquico con R</strong></h2>
<p>En este Ejercicio vamos a hacer lo mismo que hicimos en el <strong>Ejercicio 1</strong>, pero ahora lo vamos a hacer en <strong>R</strong>.</p>
<p>Los datos originales los tienene en el archivo <strong>tabla_ejemplo.tsv</strong> que se encuentra en sus materiales de trabajo. </p>
<div class="admonition danger">
<p class="admonition-title">TO DO</p>
<p>seguir de aca, poner codigo, probablemente guiarlos en el normal y estandarizado, que ellos hagan la version estandarizada (que es super copy paste, pero bue), comparacion</p>
<p>ver si hacer cor, silouhette y heatmap en algun lado (o sea, hacerlo, pero ver si conviene hacerlo en este EJ u otro)</p>
<p>lo demas es para 12b</p>
</div>
<h3 id="herramientas-necesarias">Herramientas necesarias</h3>
<h3 id="ejercicio">Ejercicio</h3>
<h3 id="clustering-directo">Clustering directo</h3>
<p>usar fread para leer tabla, que valor hay que pasarle a sep?</p>
<p>dist, matriz de distancias, explicar antes tipo en 8b?</p>
<p>que es una matriz? (tipo variable en R)</p>
<p>clustering jerarquico, hclust</p>
<p>plot, guardar como PDF (basarse en 8b), cambiar titulo?</p>
<h3 id="clustering-normalizado">Clustering normalizado</h3>
<p>estandarizar, usa scale, pero para eso hay que transponer, la otra es apply que hay un ejemplo, pero puede ser complejo, ver que pasa con datatable y transpose</p>
<p>repetir todo lo anterior con transpuesta</p>
<h3 id="heatmap">heatmap</h3>
<p>teoria, hacer heatmaps, comparar con </p>
<h3 id="groups">groups</h3>
<h3 id="correlacion-y-pearson">correlacion y pearson</h3>
<h2 id="ej-3-kmeans">Ej 3 - Kmeans</h2>
<h2 id="ej-4-silhouette">Ej 4 - Silhouette</h2>
<h2 id="ej-5-ej-3">Ej 5 - Ej 3</h2>
<p>cruzipaina creo que era Enzima Z ahora, tengo que ver los archivos para entenderlo bien</p>
<p>lee datos, usa una funcion rara, abrirla y explicarla, tal vez que hagan un poco o todo</p>
<p>los plots no ponerlos aca, dar mejores instrucciones para que los hagan ellos</p>
<p>ver imagenes gene onthology, ver si alargar y hacer propio ej?</p>
<h2 id="ej-6-7-8-hay-como-3-ejs-mas-medio-sueltos-ir-viendo-hay-uno-de-heatmaps-interactivos-ver-si-es-plotly-y-sino-ver-si-vale-la-pena">Ej 6? 7? 8? hay como 3 ejs mas medio sueltos, ir viendo, hay uno de heatmaps interactivos, ver si es plotly y sino ver si vale la pena</h2>
<h2 id="experimento"><strong>Experimento</strong></h2>
<h3 id="objetivo">Objetivo</h3>
<h2 id="bibliografia"><strong>Bibliografía</strong></h2>
<!--
### :material-bookshelf: Libros
* Libro 1 
* Libro 2
-->

<!--
### :material-web: Online
* Online 1 
* Online 2 https://en.wikipedia.org/wiki/R_(programming_language)
-->

<h3 id="consola-de-r"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"/></svg></span> Consola de R</h3>
<ul>
<li>Comando <code>help()</code></li>
</ul>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Area Bioinformatica UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a6c66575.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>