
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/introduccion_bioinformatica/practicos/TP11_HMM_ANN/">
      
      <link rel="icon" href="../../img/logo-unsam-negro.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.5.10">
    
    
      
        <title>TP 11 - HMMs & ANNs - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cabin";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-11-artificial-neural-networks-anns-y-hidden-markov-models-hmms" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TP 11 - HMMs & ANNs
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../acerca/" class="md-tabs__link">
      Acerca de
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contenidos/" class="md-tabs__link">
      Contenidos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cronograma/" class="md-tabs__link">
      Cronograma
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../docentes/" class="md-tabs__link">
      Docentes
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../teoricas/inicio/" class="md-tabs__link">
        Teóricas
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../inicio/" class="md-tabs__link md-tabs__link--active">
        Prácticos
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../instructivos/inicio/" class="md-tabs__link">
        Instructivos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contenidos/" class="md-nav__link">
        Contenidos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cronograma/" class="md-nav__link">
        Cronograma
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../docentes/" class="md-nav__link">
        Docentes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teóricas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teóricas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teóricas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        Teórica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        Teórica 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/3-Teorica-Tres/" class="md-nav__link">
        Teórica 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/4-Teorica-Cuatro/" class="md-nav__link">
        Teórica 4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/5-Teorica-Cinco/" class="md-nav__link">
        Teórica 5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/6-Teorica-Seis/" class="md-nav__link">
        Teórica 6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/7-Teorica-Siete/" class="md-nav__link">
        Teórica 7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/8-Teorica-Ocho/" class="md-nav__link">
        Teórica 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/9-Teorica-Nueve/" class="md-nav__link">
        Teórica 9
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/10-Teorica-Diez/" class="md-nav__link">
        Teórica 10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/11-Teorica-Once/" class="md-nav__link">
        Teórica 11
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Prácticos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Prácticos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        TP 1 - Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP02_EMBOSS/" class="md-nav__link">
        TP 2 - EMBOSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP03_Alineamientos/" class="md-nav__link">
        TP 3 - Alineamientos de a pares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP04_Busqueda_por_similitud/" class="md-nav__link">
        TP 4 - Búsqueda por similitud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP05a_R/" class="md-nav__link">
        TP 5a - R - Introduccion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP05b_R/" class="md-nav__link">
        TP 5b - R - Aplicación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP06_PSI-BLAST/" class="md-nav__link">
        TP 6 - PSI-BLAST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP07_Desorden/" class="md-nav__link">
        TP 7 - Predicción de Desorden
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP08_Motivos/" class="md-nav__link">
        TP 8 - Motivos Lineales
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP09a_Modelado_Por_Homologia/" class="md-nav__link">
        TP 9a - Modelado por Homología
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP09b_AlphaFold/" class="md-nav__link">
        TP 9b - Modelado usando AlphaFold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP10a_Clustering/" class="md-nav__link">
        TP 10a - Clustering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP10b_Data_Mining/" class="md-nav__link">
        TP 10b - Data Mining
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          TP 11 - HMMs & ANNs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        TP 11 - HMMs & ANNs
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#slides-mostrados-en-la-clase" class="md-nav__link">
    Slides mostrados en la clase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#videos-de-la-clase-grabada" class="md-nav__link">
    Videos de la clase grabada
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objetivos" class="md-nav__link">
    Objetivos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parte-i-artificial-neural-networks" class="md-nav__link">
    Parte I. Artificial neural networks
  </a>
  
    <nav class="md-nav" aria-label="Parte I. Artificial neural networks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primera-prueba-comprendiendo-los-resultados-que-indican-el-desempeno-de-la-red" class="md-nav__link">
    Primera prueba: Comprendiendo los resultados que indican el desempeño de la red
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segunda-prueba-cambiando-el-set-de-entrenamiento" class="md-nav__link">
    Segunda prueba: Cambiando el set de entrenamiento
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tercera-prueba-cambiando-la-arquitectura-de-la-ann" class="md-nav__link">
    Tercera prueba: Cambiando la arquitectura de la ANN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cuarta-prueba-empleando-un-esquema-de-validacion-cruzada" class="md-nav__link">
    Cuarta prueba: Empleando un esquema de validación cruzada
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilizando-el-modelo-entrenado" class="md-nav__link">
    Utilizando el modelo entrenado
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parte-ii-hmmer" class="md-nav__link">
    Parte II. HMMer
  </a>
  
    <nav class="md-nav" aria-label="Parte II. HMMer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    Introducción
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construccion-de-un-perfil" class="md-nav__link">
    Construcción de un perfil
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calibracion-del-perfil" class="md-nav__link">
    Calibración del perfil
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#busqueda-en-bases-de-datos" class="md-nav__link">
    Búsqueda en bases de datos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#busqueda-en-bases-de-datos-reales" class="md-nav__link">
    Búsqueda en bases de datos reales
  </a>
  
    <nav class="md-nav" aria-label="Búsqueda en bases de datos reales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modos-de-alineamiento" class="md-nav__link">
    Modos de alineamiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bases-de-datos-de-hmm" class="md-nav__link">
    Bases de datos de HMM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adicional-alineamientos-multiples-con-hmm" class="md-nav__link">
    Adicional: Alineamientos múltiples con HMM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP12_Short-Read-Mapping/" class="md-nav__link">
        TP 12 - Short Read Mapping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP13_Genomica_Comparativa/" class="md-nav__link">
        TP 13 - Genomica Comparativa
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Instructivos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instructivos" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Instructivos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/maquina_virtual/" class="md-nav__link">
        Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/problemasVM/" class="md-nav__link">
        Problemas instalando la Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/tipsVM/" class="md-nav__link">
        Tips and Tricks para usar la Máquina Virtual más cómodos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><p><a class="glightbox" href="img/banner.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img _="," align="left" alt="Image" src="img/banner.jpg" width="250"></a></p>
<h1 id="tp-11-artificial-neural-networks-anns-y-hidden-markov-models-hmms" markdown="markdown"><strong>TP 11</strong>. Artificial Neural Networks (ANNs) y Hidden Markov Models (HMMs)</h1>
<p><br>
<br>
<br></p>
<p><a class="md-button md-button--primary" href="https://drive.google.com/file/d/1rs-ZHYblgmhGAae6JsCNrG26mzTcU6Kb/view?usp=share_link"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"></path></svg></span> Materiales</a></p>
<p><br></p>
<div class="admonition abstract">
<p class="admonition-title">Atención: Este TP NO tiene informe.</p>
</div>
<h3 id="slides-mostrados-en-la-clase">Slides mostrados en la clase</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"></path></svg></span> <a href="https://docs.google.com/presentation/d/1XALgjFolvOZMH-ksATU3YI7YQgU75q8R/edit?usp=sharing&amp;ouid=115287066011570616875&amp;rtpof=true&amp;sd=true">Explicación ANNs</a></li>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"></path></svg></span> <a href="https://docs.google.com/presentation/d/1s62O4NBwBTA1oQ8wTm85rNmqorYB9XWh/edit?usp=sharing&amp;ouid=115287066011570616875&amp;rtpof=true&amp;sd=true">Explicación HMMs</a></li>
</ul>
<h3 id="videos-de-la-clase-grabada">Videos de la clase grabada</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://youtu.be/Z03cj479g_A">Puesta en común ANNs y Ejercicio guiado HMMer</a></li>
</ul>
<h2 id="objetivos">Objetivos</h2>
<ul>
<li>Comprender cómo se entrena y evalúa un modelo basado en redes neuronales.</li>
<li>Familiarizarse con el esquema de validación cruzada para el entrenamiento de dichos modelos.</li>
<li>Construir un perfil basado en HMMs y utilizar el mismo para realizar búsquedas en bases de datos de secuencias.</li>
<li>Crear una base de datos de perfiles de secuencias y utilizar la misma para identificar dominios conservados en secuencias <em>query</em>.</li>
</ul>
<h2 id="parte-i-artificial-neural-networks">Parte I. Artificial neural networks</h2>
<p>En esta sección vamos a utilizar redes neuronales para hacer predicciones como habíamos hecho anteriormente con las PSSM. La idea es similar a la del TP6 donde entrenamos un modelo con péptidos que se unen a MHC. Variaremos los parámetros de modelo para mejorarlo, sensando en cada corrida los indicadores de desempeño del mismo (<strong>Aroc</strong> y <strong>Pearson correlation coefficient</strong>). </p>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Si no recuerdan qué significan las métricas <strong>Aroc</strong> y <strong>Pearson correlation coefficient (PCC)</strong> diríjanse al TP6 para refrescar estos conceptos.</p>
</div>
<p>Para esto vamos a volver a utilizar <a href="https://services.healthtech.dtu.dk/service.php?EasyPred-1.0">EasyPred</a> y los archivos de <strong>Entrenamiento.set</strong> y <strong>Evaluacion.set</strong> en la carpeta del TP (que descargaron al inicio).</p>
<ul>
<li><strong>Entrenamiento.set</strong> contiene 1200 péptidos de longitud 9, con un valor asociado de afinidad de unión a HLA-A*02:01 transformado entre 0 y 1. Recuerde que mientras más cercano a 1 el péptido tiene mayor afinidad de unión y que a partir de 0.426 se considera que el péptido es un ligando. </li>
<li><strong>Evaluacion.set</strong> contiene 66 péptidos, también con sus valores correspondientes de afinidad de unión. </li>
</ul>
<p>Para el entrenamiento del modelo se particionará el archivo <strong>Entrenamiento.set</strong>, de tal manera que una parte se usará para entrenar y la restante se empleará para ir monitoreando el proceso de entrenamiento y así evitar el sobreajuste de los pesos de nuestra red.</p>
<p>Luego el archivo <strong>Evaluacion.set</strong> contiene datos independientes, que se utilizarán para evaluar la capacidad de generalización de nuestro modelo. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Es recomendable abrir los archivos y ver qué es lo que contienen. Esto SIEMPRE es una buena práctica.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A lo largo del TP vamos a mantener el valor de <em>Cutoff for counting an example as a positive example</em> en 0.5.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Vayan corriendo las diferentes pruebas en diferentes pestañas o guarden el reporte de salida para poder compararlo cuando sea necesario.  </p>
</div>
<h3 id="primera-prueba-comprendiendo-los-resultados-que-indican-el-desempeno-de-la-red">Primera prueba: <em>Comprendiendo los resultados que indican el desempeño de la red</em></h3>
<p>Para nuestro primer modelo vamos a ir a <a href="https://services.healthtech.dtu.dk/service.php?EasyPred-1.0">EasyPred</a> y cargamos los archivos en los cuadros correspondientes:</p>
<p><a class="glightbox" href="./img/train_test_upload.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img src="./img/train_test_upload.png" alt="easypred" style="max-width:70%"></a></p>
<p>Luego bajamos hasta la opción <em>Select method</em> dónde vamos a cambiar de <em>Matrix method</em> a <em>Neural Network</em>.  </p>
<p>Allí vamos a poder ver que nos habilita a ingresar otros parametros que están relacionados a la arquitectura y el entrenamiento de la red.</p>
<p>Los parámetros que queremos utilizar en este paso son:</p>
<ul>
<li><em>Number of hidden units</em>: 2  </li>
<li><em>Number iterations (epochs) to run neural network</em>: 300  </li>
<li><em>Fraction of data to train on (the rest is used to avoid overtraining)</em>: 0.8  </li>
<li><em>Learning rate</em>: 0.05  </li>
<li><em>Use top sequences for training</em>  </li>
</ul>
<p>Es decir dejamos los valores por defecto y le damos <em>Submit</em>.</p>
<p>Una vez entrenado el modelo, recuerde que puede chequear el desempeño del mismo iteración a iteración haciendo click en <strong>Output from the neural network program (HOW)</strong> </p>
<p><a class="glightbox" href="./img/log_nn.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img src="./img/log_nn.png" alt="log_nn" style="max-width:70%"></a></p>
<ol>
<li>¿Cuál es el máximo valor de PCC alcanzado sobre el set de prueba? (<em>Maximal test set pearson correlation coefficient sum</em>) </li>
<li>¿En qué iteración se alcanza ese máximo? ¿Qué información le está dando esto sobre el proceso de entrenamiento del modelo?  </li>
<li>¿Cuáles son los valores de desempeño del modelo sobre el set de evaluación? (PCC y Aroc)</li>
<li>¿El PCC obtenido en el punto 3. es mayor o menor al obtenido en el punto 1.? ¿Qué implica este resultado?  </li>
</ol>
<h3 id="segunda-prueba-cambiando-el-set-de-entrenamiento">Segunda prueba: <em>Cambiando el set de entrenamiento</em></h3>
<p>Mantenga los mismos parámetros que en el paso anterior pero esta vez seleccione <em>Use bottom sequences for training</em>. </p>
<ol>
<li>¿Cuál es el máximo valor de PCC alcanzado sobre el set de prueba y en qué iteración ocurre esta vez?</li>
<li>¿Qué valores de desempeño alcanza el modelo aplicado al set de evaluación?</li>
<li>¿A qué se debe que no coincidan con lo obtenido en la primera prueba?</li>
</ol>
<h3 id="tercera-prueba-cambiando-la-arquitectura-de-la-ann">Tercera prueba: <em>Cambiando la arquitectura de la ANN</em></h3>
<p>Repita los parámetros de la <strong>primera prueba</strong> excepto por el número de neuronas en la capa intermedia o <em>hidden layer</em>:</p>
<ul>
<li><em>Number of hidden units</em>: 1</li>
</ul>
<p>Observe el impacto en los parámetros de desempeño del modelo. Guarde los resultados. </p>
<p>Repita el ensayo esta vez con:</p>
<ul>
<li><em>Number of hidden units</em>: 5</li>
</ul>
<p>Responda a las siguientes preguntas para ambos casos estudiados:</p>
<ol>
<li>¿Cómo varía la <em>performance</em> en el set de prueba?  </li>
<li>¿Qué impacto tienen estos cambios en la <em>performance</em> del set de evaluación?  </li>
<li>¿Puede elegir un número óptimo de neuronas para la capa oculta?  </li>
<li>¿Por qué cree que el número de neuronas en la capa oculta tiene tan poco impacto en esta prueba? Piense en el número de datos de entrada y el número de pesos de la red. </li>
</ol>
<h3 id="cuarta-prueba-empleando-un-esquema-de-validacion-cruzada">Cuarta prueba: <em>Empleando un esquema de validación cruzada</em></h3>
<p>Como deberían haber notado en las dos primeras pruebas, la partición de los datos que se utilizan en el entrenamiento/prueba influyen significativamente en el desempeño del modelo. </p>
<p>Como <em>a priori</em> uno no puede establecer cuál es la mejor forma de partir los datos en entrenamiento y <em>test</em> se recurre a una estrategia denominada <em>cross-validation</em>. La técnica de validación cruzada consiste en hacer <em>N</em> particiones (por lo general 5) y rotarlas, utilizando N-1 para entrenar y la N-ésima (es decir la que queda afuera) como set de prueba. Esto resulta en N modelos diferentes, cada uno entrenado y probado en datos diferentes. Para realizar predicciones en nuevos sets, como el de evaluación, se realizan predicciones con los N métodos y se promedian sus predicciones.</p>
<p>Para realizar esta prueba vuelvan a los parámetros de la <strong>Primera prueba</strong> pero modifiquen lo siguiente:</p>
<ul>
<li><em>Number of partitions for cross-validated training</em>: 5</li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Este paso puede llevar varios minutos. Paciencia.</p>
</div>
<ol>
<li>¿Encuentran diferencias entre los desempeños de los 5 modelos? ¿Es esperable? ¿Por qué?</li>
<li>Comparen los resultados obtenidos para el set de evaluación con respecto a la primera prueba.</li>
<li>En este caso se usa el ensamble de los 5 modelos para realizar las predicciones sobre el set de evaluación. ¿Cómo piensa que se obtienen los valores predichos?</li>
</ol>
<h3 id="utilizando-el-modelo-entrenado">Utilizando el modelo entrenado</h3>
<p>Como vimos en el TP de PSSM, una vez que uno entrena un método, puede guardar los valores ajustados (ya sea de la matriz en el caso de la PSSM o los pesos de la red en el caso de ANN) y utilizarlos para hacer predicciones en un set nuevo de datos.</p>
<div class="admonition attention">
<p class="admonition-title">Guardar el modelo entrenado</p>
<p>Para ello vamos a guardar el modelo entrenado en la <strong>Cuarta prueba</strong> haciendo <strong>click derecho</strong> en <em>Parameters for prediction method</em> del reporte de resultados y seleccionando "Guardar enlace como..." (el archivo se guarda como <strong>para.dat</strong>). 
Este modelo será utilizado en el ejercicio a entregar de este TP.</p>
</div>
<h2 id="parte-ii-hmmer">Parte II. HMMer</h2>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Antes de comenzar ejecuten en la terminal de su VM <code>sudo apt install hmmer2</code>, para instalar el programa <code>hmmer2</code>.</p>
</div>
<h3 id="introduccion">Introducción</h3>
<p><strong>HMMer</strong> es un paquete de programas que nuclea varias funciones para realizar búsquedas en bases de datos mediante la utilización de perfiles de secuencias. Está basado en <em>profile Hidden Markov Models</em>, presentados por Anders Krogh (Krogh <em>et al.</em>, 1994). Estos perfiles son una aproximación estadística del consenso de un alineamiento múltiple y utilizan un sistema de puntaje posición-específico, en contraste con métodos ya vistos como BLAST o FASTA en donde la matriz de puntajes utilizada es la misma en cada posición.</p>
<h3 id="construccion-de-un-perfil">Construcción de un perfil</h3>
<p>Supongamos que trabajamos con globinas y queremos buscar homólogos lejanos. Para ello contamos con 50 secuencias de globinas las cuales alineamos y guardamos en el archivo <em>globins50.msf</em>. Como primer paso para realizar la búsqueda debemos generar un <em>profile</em> o perfil que las represente. Para crear el <em>profile</em> utilizamos la función <code>hmm2build</code> de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code>hmm2build<span class="w"> </span>globin.hmm<span class="w"> </span>globins50.msf
</code></pre></div>
<p><code>hmm2build</code> recibe como argumentos el archivo en el cual va a guardar el perfil (<em>globin.hmm</em>) y el archivo con el cual crearlo (<em>globins50.msf</em>). Si bien el contenido del archivo donde se guardó el perfil es legible, su contenido no debería tener sentido para ustedes (más allá del encabezado con información sobre las opciones que se utilizaron para crearlo) porque únicamente almacena los pesos de las transiciones de estado del HMM.</p>
<h3 id="calibracion-del-perfil">Calibración del perfil</h3>
<p>Este paso no es imprescindible pero sí aconsejable. La calibración del perfil le otorga mayor sensibilidad en la búsqueda ya que modifica la estimación del E-value de los <em>hits</em> encontrados. Si recuerdan, la búsqueda contra bases de datos nos devuelve junto con cada alineamiento un score y un E-value, este último nos da una idea sobre la cantidad de <em>hits</em> que esperamos encontrar con ese score en una base de datos construida con secuencias aleatorias y se calcula según la longitud de la secuencia <em>query</em> y <em>subject</em>, el tamaño de la base de datos y la matriz de <em>scoring</em>.</p>
<p>En el caso de HMMer, la estimación del E-value es analítica y resulta muy conservativa, por lo que se dejan de lado posibles <em>hits</em> (como homólogos lejanos). Utilizando <code>hmm2calibrate</code> podemos calibrar el cálculo de E-values de manera empírica incrementando de manera significativa la sensibilidad de la búsqueda.</p>
<p></p><div class="highlight"><pre><span></span><code>hmm2calibrate<span class="w"> </span>globin.hmm
</code></pre></div>
<code>hmm2calibrate</code> lee un archivo con un modelo HMM como <strong>globin.hmm</strong> y puntúa un número grande de secuencias sintetizadas al azar (por default 5000 secuencias) con este modelo. Luego ajusta una EVD (Extreme Value Distribution) al histograma de los puntajes obtenidos y guarda nuevamente el modelo HMM con estos nuevos parámetros.
<p>Como para realizar este cálculo se sintetizan secuencias al azar, estableceremos una semilla (o <em>seed</em>) para poder reproducir nuestros resultados. Entonces el comando se modifica de la siguiente forma, </p>
<div class="highlight"><pre><span></span><code>hmm2calibrate<span class="w"> </span>--seed<span class="w"> </span><span class="m">1</span><span class="w"> </span>globin.hmm<span class="w">  </span>
</code></pre></div>
<h3 id="busqueda-en-bases-de-datos">Búsqueda en bases de datos</h3>
<p>El comando para utilizar nuestro flamante <em>profile</em> en una búsqueda es <code>hmm2search</code>. En este caso lo vamos a utilizar contra el archivo Artemia.fa que contiene una única secuencia de globina en búsqueda de dominios pertenecientes a nuestra familia de interés.</p>
<div class="highlight"><pre><span></span><code>hmm2search<span class="w"> </span>globin.hmm<span class="w"> </span>Artemia.fa
</code></pre></div>
<p>La salida de este comando es más larga que las anteriores, consta de un encabezado con la información sobre el programa y los parámetros que utilizamos en la búsqueda:</p>
<div class="highlight"><pre><span></span><code>hmmsearch - search a sequence database with a profile HMM
HMMER 2.3.2 (Oct 2003)
Copyright (C) 1992-2003 HHMI/Washington University School of Medicine
Freely distributed under the GNU General Public License (GPL)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
HMM file:                   globin.hmm [globins50]
Sequence database:          Artemia.fa
per-sequence score cutoff:  [none]
per-domain score cutoff:    [none]
per-sequence Eval cutoff:   &lt;= 10        
per-domain Eval cutoff:     [none]
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Query HMM:   globins50
Accession:   [none]
Description: [none]
  [HMM has been calibrated; E-values are empirical estimates]
</code></pre></div>
<p>Una lista parecida a la que da BLAST con los <em>hits</em> más importantes ordenados por su E-value:</p>
<div class="highlight"><pre><span></span><code>Scores for complete sequences (score includes all domains):
Sequence Description                                    Score    E-value  N 
-------- -----------                                    -----    ------- ---
S13421   S13421 GLOBIN - BRINE SHRIMP                   120.3    6.2e-37   4
</code></pre></div>
<p>Noten que después del E-value hay un campo que no se encontraba en los otros algoritmos de búsqueda denominado "N". Este valor representa la cantidad de dominios de nuestro profile que fueron encontrados en el hit.</p>
<p>Luego encontramos información sobre los dominios de nuestro <em>profile</em> individualmente. </p>
<div class="highlight"><pre><span></span><code>Parsed for domains:
Sequence Domain  seq-f seq-t    hmm-f hmm-t      score  E-value
-------- ------- ----- -----    ----- -----      -----  -------
S13421     3/4     771  1075 ..     1   333 []    34.0    3e-13
S13421     1/4       1   288 [.     1   333 []    31.9  3.8e-13
S13421     4/4    1085  1390 ..     1   333 []    29.4    5e-13
S13421     2/4     303   607 ..     1   333 []    25.0  8.1e-13
</code></pre></div>
<p>Los campos son:</p>
<ul>
<li>
<p>el nombre del hit </p>
</li>
<li>
<p>el dominio que se alineó (por ej. 2/4 significa que es el dominio Nro 2 de 4 que hay en total en nuestro perfil) </p>
</li>
<li>
<p><strong>seq-f</strong> y <strong>seq-t</strong> son las posiciones del hit donde comienza y termina el alineamiento con ese dominio y el campo siguiente a estos valores (sin nombre) es una codificación de qué parte de la secuencia fue alineada. </p>
</li>
<li>
<p>los corchetes significan extremos y los puntos posiciones en el medio, por lo que:</p>
<ul>
<li>
<p>".." significa que el alineamiento comenzó y terminó en una posición que no es terminal de la secuencia hit</p>
</li>
<li>
<p>"[." significa que el alineamiento empieza al comienzo de la secuencia y termina en alguna posición en medio</p>
</li>
<li>
<p>al revés, ".]" empieza en una posición intermedia y termina en el fin de la secuencia</p>
</li>
<li>
<p>por último "[]" es que el dominio abarca toda la secuencia. </p>
</li>
</ul>
</li>
<li>
<p>Los tres siguientes campos son análogos pero refiriéndose a la secuencia del dominio en nuestro perfil HMM.</p>
</li>
<li>
<p>Luego se reportan el score y el E-value.</p>
</li>
</ul>
<p>La sección siguiente contiene los alineamientos de los dominios que fueron hit en la lista anterior en un formato similar al de BLAST, teniendo como primera secuencia el consenso del <em>profile</em> (noten que hay aminoácidos en mayúsculas, estos se encuentran altamente conservados en el profile). </p>
<p>Al igual que BLAST en medio de ambas secuencias se escriben los aminoácidos que coinciden o "matchean" y signos más (+) en donde hay mismatches con puntaje positivo en la matriz de sustitución.</p>
<div class="highlight"><pre><span></span><code>Alignments of top-scoring domains:
S13421: domain 3 of 4, from 771 to 1075: score 34.0, E = 3e-13
                   *-&gt;viqealvnssShLsaeeKalvkslWygKV..ggnaeeyGaeaLgRlF
                                  L+a eK+ ++++W  + ++ g +++ +++++ RlF
      S13421   771    T-----------LTALEKQSIQDIW-SNLrsTG-LQDLAVKIFTRLF 804  

                   vvYPwTqryFp.hFgdLssldAvkGspkvKAHGkKVltalgdavkhLDdt
                    ++P+ +  F + Fg++     +  ++ +KAH  +Vl+a++ ++  LDd 
      S13421   805 SAHPEYKLLFTgRFGNVDN---INENAPFKAHLHRVLSAFDIVISTLDDS 851  

                   gnlkgalakLSelHAdKLrVDPeNFklLghclivVLAahfgkdFtPevqA
                   + l   l++L+  H + L+ ++ +F +++ +++ V +   +   t     
      S13421   852 EHLIRQLKDLGLFH-TRLGMTRSHFDNFATAFLSVAQDIAPNQLTVLGRE 900  

                   AwdKflagvanaLahKYrelgFQggftviqealvnssShLsaeeKalvks
                   ++ K +++   ++ ++   l      t+           Lsa e a vk+
      S13421   901 SLNKGFKLMHGVIEEGLLQLERINPITG-----------LSAREVAVVKQ 939  

                   lWygKVggnaeeyGaeaLgRlFvvYPwTqryFphFgdLssldAvkGspkv
                   +W   V++++ ++G  ++  lF ++P  q+ Fp+F+d+ +ld + + p v
      S13421   940 TW-NLVKPDLMGVGMRIFKSLFEAFPAYQAVFPKFSDV-PLDKLEDTPAV 987  

                   KAHGkKVltalgdavkhLDdtgnlkgalakLSelHAdKLrVDPeNFklLg
                    +H   V t l++ +  LD   nl+    +L+e H   LrV    Fk +g
      S13421   988 GKHSISVTTKLDELIQTLDEPANLALLARQLGEDH-IVLRVNKPMFKSFG 1036 

                   hclivVLAahfgkdFtPevqAAwdKflagvanaLahKYr&lt;-*
                   ++l+  L   +g  F+  +  +w K++++++  + ++     
      S13421  1037 KVLVRLLENDLGQRFSSFASRSWHKAYDVIVEYIEEGLQ    1075 
</code></pre></div>
<p>Llegando al final encontramos un histograma, similar al que nos mostraba FASTA. En este caso como nuestra "base de datos" tiene una sola secuencia no es informativo en absoluto.</p>
<div class="highlight"><pre><span></span><code>Histogram of all scores:
score    obs    exp  (one = represents 1 sequences)
-----    ---    ---
  120      1      0|=      
</code></pre></div>
<p>Y por último algunos detalles estadísticos que corresponden al ajuste de la EVD, en los cuales no vamos a focalizar. </p>
<div class="highlight"><pre><span></span><code>% Statistical details of theoretical EVD fit:
              mu =  -226.7154
          lambda =     0.1106
chi-sq statistic =     0.0000
  P(chi-square)  =          0

Total sequences searched: 1

Whole sequence top hits:
tophits_s report:
     Total hits:           1
     Satisfying E cutoff:  1
     Total memory:         20K

Domain top hits:
tophits_s report:
     Total hits:           4
     Satisfying E cutoff:  4
     Total memory:         25K
</code></pre></div>
<h3 id="busqueda-en-bases-de-datos-reales">Búsqueda en bases de datos reales</h3>
<p>HMMer puede leer los formatos de la mayoría de las bases de datos conocidas. A diferencia de BLAST no es necesario indexar la base de datos. Si recuerdan de la práctica de BLAST/FASTA, uno podía crear su propia base de datos donde realizar los alineamientos a partir de un archivo multifasta utilizando el comando <strong>formatdb</strong>, el cual crea todo el sistema de índices de <em>ktuplas</em> y demás archivos para facilitar la búsqueda. En este caso HMMer puede realizar la búsqueda directamente sobre el multifasta sin necesidad de más procesamiento. En nuestro servidor podemos realizar la búsqueda utilizando:</p>
<div class="highlight"><pre><span></span><code>hmm2search<span class="w"> </span>globin.hmm<span class="w"> </span>~/Swissprot_db/Swissprot.fasta<span class="w"> </span>&gt;<span class="w"> </span>globin.swissprot.search
less<span class="w"> </span>globin.swissprot.search
</code></pre></div>
<div class="admonition attention">
<p class="admonition-title">Atención</p>
<p>Este comando no les va a funcionar si no tienen a la carpeta Swissprot_db en su home directory.</p>
</div>
<div class="admonition note">
<p class="admonition-title">A tener en cuenta:</p>
<p>Notarán que la búsqueda directa aumenta considerablemente el tiempo de cómputo necesario para obtener un resultado.</p>
</div>
<h4 id="modos-de-alineamiento">Modos de alineamiento</h4>
<p>HMMer no utiliza los métodos clásicos de alineamiento (<em>Smith-Waterman o Needleman-Wunsch</em>) como el resto de los algoritmos de alineamiento sino que el modo de alinear (local o global) está dado por el modelo que construimos. </p>
<p>Por defecto <code>hmm2build</code> lleva a cabo alineamientos que son globales con respecto al HMM y locales con respecto a la secuencia objetivo, permitiendo alinear varios dominios en esa misma secuencia. ¿Qué significa esto? Que cada dominio se intenta alinear <strong>completamente</strong> en alguna porción de la secuencia objetivo. Si queremos recuperar secuencias que contengan alineamientos parciales de dominios podemos agregar a <code>hmm2build</code> la opcion <code>-f</code> .</p>
<h3 id="bases-de-datos-de-hmm">Bases de datos de HMM</h3>
<p>Así como nos es posible realizar búsquedas de <em>profiles</em> contra bases de datos de secuencias, podemos crear una base de datos de <em>profiles</em> y utilizar como <em>query</em> a una secuencia. Este es el caso de la base de datos <strong>PFAM</strong> (Sonnhammer <em>et al.</em>, 1997; Sonnhammer <em>et al.</em>, 1998) que nuclea <em>profiles</em> de una gran variedad de dominios y es una herramienta sumamente utilizada para analizar secuencias de proteínas de las cuales no tenemos información previa.</p>
<p>Como ejemplo, tomemos el producto del gen <em>Sevenless</em> de <em>Drosophila melanogaster</em> que codifica un receptor de <em>tyrosine kinase</em> esencial para el desarrollo de las células R7 del ojo de la mosca. 
La secuencia proteica de este receptor se encuentra en el archivo <strong>7LES_DROME</strong>. Realice una búsqueda de esta secuencia en <a href="http://pfam-legacy.xfam.org/">PFAM</a>. Para esto ingrese en <strong>JUMP TO</strong> el accession number de la secuencia: P13368.
En la tabla de resultados vaya al final y haga click en <em>Show</em> donde dice: <em>Show or hide domain scores.</em></p>
<p>Inspeccione la tabla y conteste:</p>
<ul>
<li>¿Qué dominios fueron identificados en esta proteína y en qué posiciones se encuentran? Recuerde estos resultados para contrastarlo con lo que hará más adelante. </li>
</ul>
<p>Las bases de datos de <em>profiles</em> no son más que múltiples HMMs concatenados, por lo que el comando para construirlas es también <strong>hmm2build</strong>, pero vamos a utilizar la opción <strong>-A</strong> (append) para agregar nuevos <em>profiles</em> a nuestro archivo de HMMs original.</p>
<p>Por ejemplo, si queremos construir una base de datos <strong>"myhmms"</strong> que contiene perfiles de dominios <strong>rrm</strong> de reconocimiento de ARN, <strong>fn3</strong> de fibronectina tipo III y <strong>pkinase</strong> del dominio catalítico de las kinasas podemos realizarlo fácilmente con:</p>
<div class="highlight"><pre><span></span><code>hmm2build<span class="w"> </span>-A<span class="w"> </span>myhmms<span class="w"> </span>rrm.sto
hmm2build<span class="w"> </span>-A<span class="w"> </span>myhmms<span class="w"> </span>fn3.sto
hmm2build<span class="w"> </span>-A<span class="w"> </span>myhmms<span class="w"> </span>pkinase.sto
</code></pre></div>
<p>Para realizar búsquedas en nuestra nueva base de datos utilizamos el comando <code>hmm2pfam</code>. En este caso empleamos nuevamente, como ejemplo, a la proteína codificada por el gen <em>Sevenless</em> de <em>Drosophila melanogaster</em> (archivo <strong>7LES_DROME</strong>):</p>
<div class="highlight"><pre><span></span><code>hmm2pfam<span class="w"> </span>myhmms<span class="w"> </span>7LES_DROME
</code></pre></div>
<p>La salida es muy parecida a la de <strong>hmm2search</strong> pero los hits reportados no serán secuencias sino dominios contenidos en la base de datos. </p>
<p>En nuestro caso particular podrán notar que tenemos un hit contra un dominio RRM aún cuando nuestra proteína query no contiene ningún dominio de este tipo. </p>
<p>Relacionado con esto mismo, ¿recuerdan si la base de datos PFAM identificó este dominio en la proteína de estudio?</p>
<p>Nos podemos dar cuenta que este hit es al menos sospechoso debido a su score negativo y su E-value cercano a 1. Por defecto el límite de E-value, al igual que BLAST es 10, este umbral es extremadamente permisivo y proclive a devolver ruido. Si queremos ser más quisquillosos podemos utilizar la opción <strong>-E</strong> seguida del umbral deseado. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code>hmm2pfam<span class="w"> </span>-E<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span>myhmms<span class="w"> </span>7LES_DROME
</code></pre></div>
<h3 id="adicional-alineamientos-multiples-con-hmm">Adicional: Alineamientos múltiples con HMM</h3>
<p>Otro uso que se les da a los <em>profiles</em> es el de asistir a la hora de llevar a cabo alineamientos múltiples de grandes cantidades de secuencias. En general este proceso suele ser lento y los alineamientos resultantes contienen errores que requieren curarse a mano. Utilizando HMMs construidos a partir de un alineamiento de unas pocas secuencias representativas, se pueden alinear grandes cantidades de secuencias relacionadas fácilmente. </p>
<p>Siguiendo con nuestras globinas, tenemos un archivo (<strong>globins630.fa</strong>), que como habrán deducido, contiene 630 secuencias de globinas que vamos a alinear utilizando el comando <code>hmm2align</code>:</p>
<div class="highlight"><pre><span></span><code>hmm2align<span class="w"> </span>-o<span class="w"> </span>globins630.ali<span class="w"> </span>globin.hmm<span class="w"> </span>globins630.fa
</code></pre></div>
<p>mediante la opción <code>-o</code> indicamos el archivo en el que deseamos guardar el alineamiento (<strong>globins630.ali</strong>), y como argumentos debemos indicar el profile que vamos a utilizar como "semilla" y el archivo con las secuencias a alinear (<strong>globin.hmm</strong> y <strong>globins630.fa</strong> respectivamente). </p>
<p>Noten que también se puede utilizar la opción <code>--outformat</code> para cambiar el formato del alineamiento producido. Por defecto se utiliza el formato <em>Stockholm</em>, pero también puede producir alineamientos en formato <em>MSF</em>, <em>Clustal</em>, <em>Phylip</em> y <em>SELEX</em>.</p>
<!--
## Ejercicio a informar

!!! info 

    <span style="font-weight:bold;">Fecha límite de entrega:</span> Viernes, 10 de Noviembre 2023, 23:59hs.

### Enunciado

Su jefe analizó los resultados de la identificación de ligandos de HLA-A02*01 utilizando una PSSM. Lamentablemente no está muy conforme con los resultados porque considera que hay métodos mejores para realizar esta predicción.

Por lo tanto, usted decide volver a realizar las predicciones, utilizando la red que entrenó en la cuarta prueba del TP11, para las mismas proteínas de la variante de coronavirus que está estudiando actualmente. Recordemos que eran las siguientes: proteína **S** (spike o proteína de glicoproteína de superficie), **E** (proteína de la envoltura), **M** (proteína de membrana) y **N** (fosfoproteína de la nucleocápside).

Para lograr su objetivo utilizará la herramienta **EasyPred**. Como va a realizar una predicción, siga los mismos pasos que realizó para hacer la predicción con la PSSM con la diferencia de que en **Load saved prediction method** debe subir el archivo con los pesos de la red. Seleccione **Sort output on predicted values** y apriete el botón **Submit query**.

1. Interprete la salida que obtiene al correr **Easypred**. ¿Cuántas redes se utilizan para realizar las predicciones?
1. ¿Cuántos péptidos se podrían considerar ligandos en cada caso? Recuerde los umbrales para la clasificación de ligandos que enunciamos en los TP6 y TP11.
1. ¿Cuáles son los péptidos que elegiría para testear en el laboratorio de cada una de las proteínas analizadas? Tenga en cuenta que puede elegir como máximo 5 péptidos en total.
1. Teniendo en cuenta su respuesta al punto 2., ¿tiene sentido este resultado considerando la alta especificidad del MHC analizado?
1. Ingrese a Seq2Logo y genere un logo con todos los péptidos que etiquetó como ligandos. Ajuste los parámetros según su criterio. 
1. En base a los conocimientos adquiridos, ¿le parece razonable el motivo hallado para el alelo HLA-A*02:01? ¿Puede ver claramente las posiciones ancla? ¿Qué aminoácidos son los preferidos para estas posiciones?
1. Compare el logo obtenido con el que construyó para el ejercicio final del TP6 (péptidos con un puntaje predicho mayor a 1).

    * ¿Qué diferencias y similitudes observa? ¿Qué diferencia observa en el information content (eje y), y a qué se lo atribuye?
    * ¿Por qué cree que el motivo generado por redes neuronales es más parecido a lo ya conocido en la literatura que el motivo construído a partir de la PSSM?

1. Ahora compare **todas** las predicciones realizadas con la PSSM con las obtenidas utilizando la red neuronal. Calcule el coeficiente de correlación de Pearson y Spearman entre ambos conjuntos de predicciones. Investigue cuál de estas dos métricas sería la más adecuada para realizar esta comparación (Pista: ¿Notó que las predicciones están en diferentes escalas?). Para completar esta tarea puede usar Excel (ver Extras) o cualquier otro programa de su preferencia. A su jefe le gustan las figuras, así que decide realizar un plot o gráfico de dispersión de los datos, además de calcular las métricas enunciadas anteriormente. 

!!! example "Extras (y por ende opcionales):"

    1. Puede realizar un `for` loop junto con un `awk` para seleccionar los péptidos relevantes de cada una de las proteínas (recuerde que en un TP se realizó un `awk` para seleccionar columnas).

    1. Para completar el punto 8., puede usar R para calcular las métricas y ggplot2 para realizar el gráfico de dispersión. 

    Algunos links que les pueden resultar útiles para resolver el punto 8. y los extras:

    * [Cálculo de coeficientes de correlación en R](https://cran.r-project.org/web/packages/correlation/vignettes/types.html)
    * [Scatterplot en ggplot2](http://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2)/)
-->
<p><br></p></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Pie" >
      
        
        <a href="../TP10b_Data_Mining/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: TP 10b - Data Mining" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              TP 10b - Data Mining
            </div>
          </div>
        </a>
      
      
        
        <a href="../TP12_Short-Read-Mapping/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: TP 12 - Short Read Mapping" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              TP 12 - Short Read Mapping
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Area Bioinformática UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>