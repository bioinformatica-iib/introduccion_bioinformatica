
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/introduccion_bioinformatica/practicos/TP08b_R/">
      
      <link rel="icon" href="../../img/logo-unsam-negro.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.5.10">
    
    
      
        <title>Index - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cabin";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-8b-r-programando-en-biologia-parte-2" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../acerca/" class="md-tabs__link">
      Acerca de
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contenidos/" class="md-tabs__link">
      Contenidos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cronograma/" class="md-tabs__link">
      Cronograma
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../docentes/" class="md-tabs__link">
      Docentes
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../teoricas/inicio/" class="md-tabs__link">
        Teóricas
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../inicio/" class="md-tabs__link">
        Prácticos
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../instructivos/inicio/" class="md-tabs__link">
        Instructivos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contenidos/" class="md-nav__link">
        Contenidos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cronograma/" class="md-nav__link">
        Cronograma
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../docentes/" class="md-nav__link">
        Docentes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teóricas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teóricas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teóricas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        Teórica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        Teórica 2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Prácticos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Prácticos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        TP 1 - Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Instructivos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instructivos" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Instructivos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/maquina_virtual/" class="md-nav__link">
        Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/problemasVM/" class="md-nav__link">
        Problemas instalando la Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/tipsVM/" class="md-nav__link">
        Tips and Tricks para usar la Máquina Virtual más cómodos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><p><a class="glightbox" href="img/banner.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img _="," align="left" alt="Image" src="img/banner.jpg" width="250"></a></p>
<h1 id="tp-8b-r-programando-en-biologia-parte-2" markdown="markdown"><strong>TP 8b</strong>. R - Programando en biología - Parte 2</h1>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<p><a class="md-button md-button--primary" href="https://drive.google.com/file/d/133TQL4mzP8ZNIb3vzP5bbqt1KZa1iWrO/view?usp=sharing"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"></path></svg></span> Materiales</a></p>
<!--
Este es el botón para descargar materiales, en (#) hay que agregar el link correspondiente
-->

<h3 id="videos-de-la-clase-grabada">Videos de la clase grabada</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=MoGWtBkaVIU">Introducción al TP</a></li>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=0KKRWkZDvXw">Puesta en común del TP</a></li>
</ul>
<h3 id="codigos-resueltos">Códigos resueltos</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0v-2.5zm7.5-.188V4.25c0 .138.112.25.25.25h2.688a.252.252 0 0 0-.011-.013l-2.914-2.914a.272.272 0 0 0-.013-.011zM5.72 6.72a.75.75 0 0 0 0 1.06l1.47 1.47-1.47 1.47a.75.75 0 1 0 1.06 1.06l2-2a.75.75 0 0 0 0-1.06l-2-2a.75.75 0 0 0-1.06 0zM3.28 7.78a.75.75 0 0 0-1.06-1.06l-2 2a.75.75 0 0 0 0 1.06l2 2a.75.75 0 0 0 1.06-1.06L1.81 9.25l1.47-1.47z"></path></svg></span> <a href="https://drive.google.com/file/d/1fBpEtMAAMvbx9zmbow4ovosQY7fu9kJc/view?usp=sharing">Códigos completos</a> (tienen que setear el <em>Working Directory</em>) (si corren el 3, 4 y 5 llegan al <strong>PDF</strong>)</li>
</ul>
<h3 id="software-a-usar">Software a usar</h3>
<ul>
<li>R (ya instalado en la VM).</li>
<li>RStudio (ya instalado en la VM)</li>
</ul>
<h3 id="recursos-online">Recursos Online</h3>
<ul>
<li><a href="https://www.coursera.org/learn/r-programming">Curso online de R de Coursera</a> (se puede hacer gratis) (en ese caso no da certificado)</li>
<li><a href="http://www.cookbook-r.com/">Tips de comandos básicos de R</a></li>
<li>Data Tables: <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html">Introducción oficial</a> y <a href="https://bookdown.org/paradinas_iosu/CursoR/data-table.html">otra página con más info</a></li>
<li>ggplot2: <a href="https://bookdown.org/paradinas_iosu/CursoR/ggplot2.html">Vistazo rápido</a>, <a href="http://sthda.com/english/wiki/ggplot2-essentials">otra página con cada plot detallando sus parámetros</a> y <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">cheatsheet</a></li>
</ul>
<h3 id="objetivos">Objetivos</h3>
<ul>
<li>Familiarizarse en el lenguaje de programación <strong>R</strong>.</li>
<li>Ver como los mismos conceptos de programación se trasladan de un lenguaje a otro.</li>
<li>Utilizar herramientas de programación para resolver problemas biológicos.</li>
</ul>
<h2 id="introduccion-al-tema"><strong>Introducción al Tema</strong></h2>
<p>Es muy normal que en trabajos de biología sea necesario trabajar con datos provenientes de servicios o equipos que no generan <em>outputs</em> de formato estándar (separados por tabs, comas, etc). Esto hace que cuando queramos cargar estos <em>outputs</em> en cualquier programa de análisis de datos vamos a tener que darles formato manualmente, algo que puede no ser muy complicado cuando se trata de unos pocos archivos o un solo ensayo, pero se vuelve un problema en grandes cantidades.</p>
<p>En la materia ya vimos varios archivos de salida con patrones propios, por ejemplo los archivos FASTA, donde el marcador <code>&gt;</code> es usado para indicar el comienzo del header una secuencia. Diferentes programas van a tener diferentes patrones de salida, pero suelen haber ciertos caracteres bastante usados como <code>#</code>, <code>!</code>, <code>*</code>, <code>|</code>, etc.</p>
<p>En este trabajo práctico vamos a usar el lenguaje de programación <strong>R</strong> para leer datos generados por un lector de placas de wells. Vamos a parsear dichos datos para que estén en un formato con el que podamos trabajar, y vamos a procesarlos como necesitemos para calcular estadísticos y plots que contengan información sobre el experimento realizado.</p>
<h2 id="experimento"><strong>Experimento</strong></h2>
<h3 id="objetivo">Objetivo</h3>
<p>En el TP de hoy vamos a querer encontrar un compuesto que funcione de inhibidor para una enzima de interés, a la que vamos a denominar <strong>enzima Z</strong>. No solo nos va a interesar que compuestos funcionan como inhibidores para ella, sino que también queremos calcular el <strong>IC 50</strong> de cada uno de dichos compuestos (que en nuestro caso sería la concentración a la cual el inhibidor produce una reacción un 50% más lenta que sin inhibidor).</p>
<p>Por suerte nuestra enzima de interés tiene como producto un compuesto fluorescente. Sabiendo esto podemos estimar la velocidad de la reacción calculando una regresión lineal de la abundancia de dicho producto a lo largo del tiempo (esto lo vamos a explicar un poco más detalladamente cuando lo hagamos). Si un compuesto funciona como inhibidor en algunas de las concentraciones evaluadas, la velocidad de la reacción debería caer.</p>
<h3 id="filtermax">FilterMax</h3>
<p>Una forma de analizar varios compuestos y concentraciones a la vez es usar el equipo <strong>FilterMax F5</strong>, el cual permite hacer mediciones puntuales de absorbancia y fluorescencia (entre otros) en placas de wells de 96, 384 y 1536. Incluso permite hacer mediciones a distintos tiempos (por ejemplo, se le puede programar para hacer mediciones cada ciertos intervalos temporales).</p>
<p>En nuestro ejemplo (datos reales, nombres ficticios), vamos a utilizar el <strong>FilterMax F5</strong> para evaluar varias placas de 384 wells y vamos a hacer 4 evaluaciones por placa, una cada 5 minutos. Cada columna de la placa corresponde compuesto distinto (22 compuestos, 1 por columna) y cada fila tiene concentraciones diferentes de cada compuesto (16 concentraciones, diluciones seriadas). Un esquema de este experimento se puede ver en <a href="https://docs.google.com/spreadsheets/d/1ey-c3nuc2zd4Cqj6B_uYcq1gAx0FPybLJUDCbV56my4/edit?usp=sharing">esta planilla</a>.</p>
<h2 id="paso-1-familiarizarnos-con-el-archivo" markdown="markdown"><strong>Paso 1 - Familiarizarnos con el Archivo</strong></h2>
<p>El primer paso cuando uno empieza a trabajar con un archivo nuevo es siempre mirarlo y deducir su formato. Los resultados reales de este experimento pueden verlos en el archivo <strong>00_datos_filtermax.txt</strong> que se encuentra en sus materiales de trabajo.</p>
<p>Abran el archivo <strong>00_datos_filtermax.txt</strong> con Leafpad, vean su estructura y respondan las siguientes preguntas:</p>
<p><strong>1)</strong> ¿Se parece un poco a algún <strong>.csv</strong> (columnas separadas por comas) o <strong>.tsv</strong> (columnas separadas por tabs) que hayan visto antes? ¿Que diferencias tiene? Teniendo en cuenta esas diferencias y considerando que vamos a querer leerlo como una tabla en <strong>R</strong> ¿Les parece que hay filas que están de más?</p>
<p><strong>2)</strong> Mirando el archivo y la planilla del experimento:</p>
<ul>
<li>
<p>¿Qué hay en la celda A1?</p>
</li>
<li>
<p>¿Qué posiciones contienen las diferentes diluciones del compuesto "Umbrella2"?</p>
</li>
<li>
<p>¿Cuántos datos hay para cada dilución del compuesto "Umbrella2"? ¿Por qué?</p>
</li>
</ul>
<p><strong>3)</strong> Ahora abra el archivo con Gnumeric (Click derecho sobre el archivo <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> Abrir con <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> Oficina <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> Gnumeric). Al final de cada placa hay varias celdas sin datos. ¿Hay algo en la planilla del experimento que explique por qué pasa esto?</p>
<h2 id="paso-2-limpiar-y-parsear-el-archivo" markdown="markdown"><strong>Paso 2 - Limpiar y Parsear el Archivo</strong></h2>
<p>En este paso queremos hacer 2 cosas:</p>
<ul>
<li>
<p>Primero, queremos sacar cualquier fila extra de <strong>00_datos_filtermax.txt</strong> que nos impida leer el archivo usando <code>fread</code>. Si bien en este caso esto se podría hacer a mano, como programadores queremos soluciones que escalen bien con el número de datos, asi que lo vamos a hacer en un <em>script</em>.</p>
</li>
<li>
<p>Segundo, queremos reorganizar los datos para poder trabajar con ellos más fácil, y para eso queremos una tabla con la siguiente estructura:</p>
</li>
</ul>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">time</th>
<th data-sort-method="none" style="text-align: center;">temperature</th>
<th data-sort-method="none" style="text-align: center;">fila</th>
<th data-sort-method="none" style="text-align: center;">columna</th>
<th data-sort-method="none" style="text-align: center;">signal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"00:00:00"</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">"A"</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">417246</td>
</tr>
<tr>
<td style="text-align: center;">"00:04:59"</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">"A"</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">595504</td>
</tr>
<tr>
<td style="text-align: center;">"00:10:00"</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">"A"</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">789920</td>
</tr>
<tr>
<td style="text-align: center;">"00:15:00"</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">"A"</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">985947</td>
</tr>
<tr>
<td style="text-align: center;">"00:00:00"</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">"A"</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">389328</td>
</tr>
<tr>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
</tr>
</tbody>
</table>
</figure>
<p>Si bien este paso es importante, también es bastante específico a la salida del <strong>FilterMax F5</strong>. Por esta razón les vamos a dar el archivo ya parseado para que pasemos directamente al análisis de datos más general. Este es el archivo <strong>02_datos_filtermax_parseados.tsv</strong> que se encuentra en sus materiales de trabajo.</p>
<p>Dicho esto, si completan el resto del TP a tiempo y quieren aprender cómo llegar del archivo original a éste archivo pueden hacer el <strong>Ejercicio Adicional 1</strong> abajo de todo.</p>
<p><strong>1)</strong> Abran el archivo <strong>02_datos_filtermax_parseados.tsv</strong> con Leafpad y vean la columna <strong>signal</strong>. ¿Qué piensan que significan los <strong>NA</strong> en esa columna?</p>
<h2 id="paso-3-agregar-la-informacion-que-necesito" markdown="markdown"><strong>Paso 3 - Agregar la información que necesito</strong></h2>
<p>En este momento tenemos una tabla donde cada fila es una señal independiente, pero tenemos algunos problemas:</p>
<ul>
<li>
<p>No tengo información de los compuestos en la tabla, solo de los números de las columnas</p>
</li>
<li>
<p>No tengo información de las diluciones en la tabla, solo de las letras de las filas</p>
</li>
<li>
<p>Más adelante vamos a querer calcular la <em>velocidad de reacción</em>, es decir, cómo varía la <strong>signal</strong> según el <strong>time</strong>. Sin embargo, acá <strong>time</strong> es un <em>string</em>, por lo que necesito transformarlo a número</p>
</li>
</ul>
<p>Estas son las cosas que queremos arreglar. Por suerte tenemos también otras dos tablas, una indicando que compuesto hay en cada columna (<strong>00_datos_compuestos.tsv</strong>) y otra indicando que dilución hay en cada fila (<strong>00_datos_concentraciones.tsv</strong>).</p>
<p>Esto se podría hacer a mano, pero llevaría mucho tiempo y podría haber errores de tipeo. Por esta razón vamos a crear un programa que haga todo esto por nosotos. Sin embargo, antes de crear este programa necesitamos aprender algunas cosas nuevas:</p>
<h3 id="herramientas-necesarias">Herramientas necesarias</h3>
<h4 id="filtrar-filas-en-data-table">Filtrar filas en <em>Data Table</em></h4>
<p>Algo de esto vimos en el TP anterior, pero es posible filtrar filas de un <em>Data Table</em> según el valor de las diferentes columnas en dicha fila.</p>
<p>Vamos a volver a usar el data set <strong>iris</strong> que está siempre cargado en memoria; sin embargo, <strong>iris</strong> es un <em>Data Frame</em>, por lo que lo vamos a tener que convertir en <em>Data Table</em>.</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w"> </span><span class="c1">#tenemos que cargar el paquete data.table en memoria cada vez que cerramos RStudio</span>

<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</code></pre></div>
<p>Ahora supongamos que queremos solo las filas donde la columna <strong>Species</strong> es <strong>versicolor</strong> ó <strong>virginica</strong>. Hay varias formas de hacer esto y todas les van a ser útiles para lo que tenemos que hacer hoy.</p>
<p><strong>1)</strong> Corran por lo menos dos de las líneas de código siguientes y vean lo que devuelven:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Cualquiera de estas 5 líneas de código devuelve el mismo *Data Table*</span>
<span class="n">dt_iris</span><span class="p">[(</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"versicolor"</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"virginica"</span><span class="p">)]</span>
<span class="n">dt_iris</span><span class="p">[</span><span class="n">Species</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"versicolor"</span><span class="p">,</span><span class="w"> </span><span class="s">"virginica"</span><span class="p">)]</span>
<span class="n">dt_iris</span><span class="p">[</span><span class="n">Species</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">"setosa"</span><span class="p">]</span>
<span class="n">dt_iris</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"setosa"</span><span class="p">)]</span>
<span class="n">dt_iris</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"setosa"</span><span class="p">))]</span>
</code></pre></div>
<h4 id="mergear-data-tables">Mergear <em>Data Tables</em></h4>
<p>Por <em>mergear</em> nos referimos a juntar dos <em>Data Tables</em> horizontalmente, es decir, agregar de alguna forma las columnas de uno al otro. </p>
<p><strong>2)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="n">genes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"ERT2"</span><span class="p">,</span><span class="w"> </span><span class="s">"TTR4"</span><span class="p">,</span><span class="w"> </span><span class="s">"REC1"</span><span class="p">)</span>
<span class="n">esencialidad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
<span class="n">expresiones</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="w"> </span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">10000</span><span class="p">)</span>

<span class="n">dt_info_de_esencialidad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">esencial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">esencialidad</span><span class="p">)</span>
<span class="n">dt_info_de_expresion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">expresion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expresiones</span><span class="p">)</span>

<span class="n">dt_toda_la_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">dt_info_de_esencialidad</span><span class="p">,</span>
<span class="w">                         </span><span class="n">dt_info_de_expresion</span><span class="p">,</span>
<span class="w">                         </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"gen"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dt_toda_la_info</span><span class="p">)</span>
</code></pre></div>
<p>Como ven, la función <code>merge</code> toma 2 <em>Data Tables</em> y los une por la columna definida en el parámetro <code>by</code>. Una cosa interesante es que no es necesario que ambos <em>Data Frames</em> tengan el mismo tamaño.</p>
<p><strong>3)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="n">especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"setosa"</span><span class="p">,</span><span class="w"> </span><span class="s">"virginica"</span><span class="p">,</span><span class="w"> </span><span class="s">"versicolor"</span><span class="p">)</span>
<span class="n">empieza_con_S</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>

<span class="n">dt_info_S</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">especies</span><span class="p">,</span>
<span class="w">                        </span><span class="n">empieza_con_S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">empieza_con_S</span><span class="p">)</span>

<span class="n">nueva_dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">,</span>
<span class="w">                       </span><span class="n">dt_info_S</span><span class="p">,</span>
<span class="w">                       </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Species"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">nueva_dt_iris</span><span class="p">)</span>
</code></pre></div>
<p>Para cada fila de <strong>dt_iris</strong> el <code>merge</code> agrego el valor de <strong>empieza_con_S</strong> según la columna <strong>Species</strong>. Van a ver que se desordenaron las filas y las columnas. Esto sucede ya que <code>merge</code> va a mover a la columna usada en el <code>by</code> al principio. Uno después tiene que reordenarlas como prefiera.</p>
<h4 id="agregar-filas-a-data-tables">Agregar filas a <em>Data Tables</em></h4>
<p>Ahora que aprendimos a agregar columnas en masa también queremos hacer lo mismo con una o más filas.</p>
<p><strong>4)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="n">genes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"ERT2"</span><span class="p">,</span><span class="w"> </span><span class="s">"TTR4"</span><span class="p">,</span><span class="w"> </span><span class="s">"REC1"</span><span class="p">)</span>
<span class="n">esencialidad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
<span class="n">expresiones</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="w"> </span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">10000</span><span class="p">)</span>

<span class="n">dt_toda_la_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">,</span>
<span class="w">                              </span><span class="n">esencial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">esencialidad</span><span class="p">,</span>
<span class="w">                              </span><span class="n">expresion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expresiones</span><span class="p">)</span>

<span class="n">dt_nueva_fila</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"AFK5"</span><span class="p">,</span>
<span class="w">                            </span><span class="n">esencial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span>
<span class="w">                            </span><span class="n">expresion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>

<span class="n">dt_toda_la_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">dt_toda_la_info</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">dt_nueva_fila</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dt_toda_la_info</span><span class="p">)</span>
</code></pre></div>
<p>El comando <code>rbindlist</code> concatena dos <em>Data Tables</em>, donde el segundo puede ser una sola fila o algo más grande. Es importante que ambos <em>Data Tables</em> tengan la misma estructura para que el comando no devuelva errores.</p>
<h4 id="crear-data-table-vacio">Crear <em>Data Table</em> vacío</h4>
<p>Ahora que sabemos agregar filas a un <em>Data Table</em>, puede ser entonces útil tener un <em>Data Table</em> vacío al que le voy a agregando filas que voy calculando (por ejemplo en un ciclo).</p>
<p><strong>5)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="n">dt_toda_la_info_vacio</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">character</span><span class="p">(),</span>
<span class="w">                                    </span><span class="n">esencial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">logical</span><span class="p">(),</span>
<span class="w">                                    </span><span class="n">expresion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">())</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dt_toda_la_info_vacio</span><span class="p">)</span>

<span class="n">dt_nueva_fila</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"AFK5"</span><span class="p">,</span>
<span class="w">                            </span><span class="n">esencial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span>
<span class="w">                            </span><span class="n">expresion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>

<span class="n">dt_toda_la_info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">dt_toda_la_info_vacio</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">dt_nueva_fila</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dt_toda_la_info</span><span class="p">)</span>
</code></pre></div>
<p>Como ven, al crear un <em>Data Table</em> vacío tengo que asignar a cada columna el tipo de datos que va a contener. Aca estoy usando <code>character()</code> (<em>strings</em>), <code>logical()</code> (<em>booleano</em>) y <code>numeric()</code> (números reales). El único otro tipo que puede ser que usen en esta materia es el <code>integer()</code> que son números enteros, pero como dijimos en el TP anterior es común usar <code>numeric()</code> para estos también.</p>
<h4 id="reordenar-columnas-en-data-tables" markdown="markdown">Reordenar columnas en <em>Data Tables</em></h4>
<p>Como mencionamos antes, el <code>merge</code> nos va a desordenar las columnas de la tabla. Además, es posible querer quedarnos con solo algunas de las columnas de una tabla porque ya no tenemos más usos para otras. Una forma de hacer esto es:</p>
<div class="highlight"><pre><span></span><code><span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1">#Los tres siguientes bloques hacen lo mismo, quedándonos solo con las </span>
<span class="c1">#columnas Species, Sepal.Length y Sepal.Width</span>

<span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="nf">.</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">)]</span>

<span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Width"</span><span class="p">)]</span>

<span class="n">columnas_a_quedarnos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Width"</span><span class="p">)</span>
<span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="n">columnas_a_quedarnos</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>
</code></pre></div>
<p>Esto es útil cuando queremos quedarnos con pocas columnas, pero ¿qué pasa cuando tenemos muchas y solo queremos sacar algunas? Ahí podemos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1">#Los dos siguientes bloques hacen lo mismo, sacando las columnas Species, Sepal.Length y Sepal.Width</span>

<span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Width"</span><span class="p">)]</span>

<span class="n">columnas_a_borrar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s">"Sepal.Width"</span><span class="p">)</span>
<span class="n">dt_iris</span><span class="p">[,</span><span class="w"> </span><span class="o">-</span><span class="n">columnas_a_borrar</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">]</span>
</code></pre></div>
<h4 id="splitear-strings">Splitear <em>strings</em></h4>
<p>Hay varias funciones en <strong>R</strong> que nos permiten parsear texto y una de las más fáciles de entender es <code>strsplit</code>. Como su nombre lo indica esta función <em>splitea</em> (o corta) un <em>string</em> (o cadena de caracteres). Veamos un ejemplo:</p>
<p></p><div class="highlight"><pre><span></span><code><span class="n">frase</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"Habia-una-vez"</span>
<span class="n">frase_spliteada</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">strsplit</span><span class="p">(</span><span class="n">frase</span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"-"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">frase_spliteada</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s">"Habia"</span><span class="w"> </span><span class="s">"una"</span><span class="w">   </span><span class="s">"vez"</span>
</code></pre></div>
Como ven la función <code>strsplit</code> toma un <em>string</em> y lo divide en diferentes fragmentos según el parámetro <code>split</code>.
<p>No se si lo recuerdan, pero en el TP anterior hablamos de las variables llamadas listas, que se pueden pensar como vectores que pueden contener variables de distinto tipo dentro de ellas (mientras que todos los elementos de un vector son de un mismo tipo).</p>
<p>Ese <code>[[1]]</code> en el output anterior nos está indicando que <code>strsplit</code> nos está devolviendo una variable de tipo <code>list</code> donde el primer elemento es el vector con la frase <em>spliteada</em>.</p>
<p><strong>6)</strong> Si bien el parámetro <code>split</code> suele ser un caracter, en realidad puede ser un <em>string</em> cualquiera. Prueben el código anterior usando <code>split = "-una-"</code> y vean que pasa.</p>
<p><strong>7)</strong> Vean que pasa cuando usan <code>split = ""</code>.</p>
<p><strong>8)</strong> Pásenle ahora a <code>strsplit</code> el siguiente vector de strings: <code>frases &lt;- c("Aquí me pongo a cantar", "al compás de la vigüela")</code>. Sabiendo que queremos <em>splitear</em> las diferentes palabras, ¿cuál sería el valor de <code>split</code> en este caso? ¿Cuántos elementos tiene la lista que devuelve <code>strsplit</code>? ¿Por qué? ¿Cuál es la tercera palabra de la segunda frase? (imprímanla por pantalla usando <code>print</code>)</p>
<h4 id="eliminar-elementos-repetidos-en-vectores" markdown="markdown">Eliminar elementos repetidos en vectores</h4>
<p>En los <em>Data Tables</em> es común tener columnas con categorías, por ejemplo la columna <strong>Species</strong> en la tabla <strong>iris</strong>. Es normal al momento de programar no saber previamente cuáles van a ser esas categorías (especies en este caso), por lo que muchas veces se extraen de la columna misma. Una forma de hacer esto es usar la función <code>unique()</code>, la cual toma un vector y saca los elementos repetidos, dejando uno de cada uno.</p>
<p><strong>9)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="n">vector_especies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span>

<span class="n">vector_especies_unicas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="n">vector_especies</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">vector_especies</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">vector_especies_unicas</span><span class="p">)</span>
</code></pre></div>
<p>La columna <code>iris$Species</code> es técnicamente un <em>factor</em>, pero estos son simplemente vectores con propiedades extras. La función <code>unique()</code> va a funcionar igual de pasarle un vector de caracteres; de hecho, esta función también puede remover filas repetidas de un <em>Data Table</em>.</p>
<h4 id="usar-fread-con-datos-faltantes" markdown="markdown">Usar <code>fread</code> con datos faltantes</h4>
<p>Es común que un set de datos tenga datos faltantes, lo que en nuestro caso vendría a ser wells sin señal. Diferentes tablas los van a indicar de diferentes maneras, pero es común verlos como <em>nada</em> (o sea veo los separadores de columnas, pero no hay información en el medio), <strong>NaN</strong> (<em>Not a Number</em>), <strong>ND</strong> (<em>No Data</em>) o como <strong>NA</strong> (<em>Not Available</em>). En esta caso vamos a usar <strong>NA</strong>.</p>
<p>Es importante al momento de leer un archivo saber si mi archivo tiene o no estos datos faltantes, ya que de no tenerlo en cuenta puedo terminar leyendo a <strong>NA</strong> como el <em>string</em> "NA", lo cual puede insertar datos falsos y hasta forzar a <strong>R</strong> a leer una columna numérica como si fueran todos <em>strings</em>.</p>
<p>Podemos indicarle a <code>fread</code> si hay celdas sin valores y como están escritas con el parámetro <code>na.strings</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="s">"ARCHIVO_DT"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">na.strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"NA"</span><span class="p">)</span>
</code></pre></div>
<p>En este caso le estamos indicando que hay celdas sin valores y que están escritas en la tabla como "NA" (pueden estar con o sin comillas en el archivo). De querer indicarle a <code>fread</code> que los datos faltantes están como <em>nada</em> se usa <code>na.strings = ""</code>, aunque en este caso cualquier columna con un <em>string</em> vacío también va a ser considerada dato faltante.</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Carga más rápida de los datos</p>
<p>Si estamos seguros que no hay celdas sin valores en nuestros datos, le podemos pasar <code>na.strings = NULL</code> para indicarle que no busque celdas vacías, lo que acelera la carga de la tabla.</p>
</div>
<h4 id="usar-fread-con-decimales-espanoles" markdown="markdown">Usar <code>fread</code> con decimales españoles</h4>
<p>Otro problema común al momento de trabajar con datos es que por alguna <del>diabólica</del> razón el separador de decimales y el separador de miles no son iguales para algunos países que para otros, de hecho, son exactamente al revés.</p>
<p>Es posible entonces que tengan una tabla que hizo alguien en Argentina donde uso comas como separador de decimales, pero que al cargarla en <strong>R</strong>, el cual fue creado en Estados Unidos, piense que dichas comas son separador de miles, lo que rompe completamente los números pasados.</p>
<p>Por suerte algo de consideración tienen y existe un parámetro de <code>fread</code> que nos permite especificar cual es el separador de decimales (que por defecto es el punto):</p>
<div class="highlight"><pre><span></span><code><span class="n">dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="s">"ARCHIVO_DT"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">","</span><span class="p">)</span>
</code></pre></div>
<h3 id="paso-3-ejercicio">Paso 3 - Ejercicio</h3>
<p><strong>10)</strong> Creen un nuevo script de <strong>R</strong>, copien el siguiente código y guardenlo en su carpeta de trabajo. Vayan avanzando por el <em>script</em> y cambien las secciones que dicen <code>@@EDITAR@@</code> por lo que corresponda (esto puede ser un valor, una variable, una operación matemática, una comparación o una función de <strong>R</strong>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning - Working Directory</p>
<p>Cada vez que lean o escriban un archivo recuerden que el path que le pasen debe ser un path absoluto o un path relativo al <em>Working Directory</em>. Para cambiar el <em>Working Directory</em> pueden usar la función <code>setwd()</code> que aprendimos en el TP anterior.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip - Ñ y acentos</p>
<p>Van a ver que en los códigos tratamos de no usar la letra <strong>Ñ</strong> o acentos. Esto es así ya que cuando uno comparte código entre varias personas suele pasar que algunas de esos caracteres se "rompen" y se ven feo (por ejemplo un texto que era <strong>diseño_compuestos</strong> se veía como <strong>diseÃ±o_compuestos</strong> en otra PC).</p>
<p>Si bien es posible poner estándares de codificación de texto en grupos, la realidad es que solemos programar en inglés por lo que el problema se evita solo.</p>
<p>Este tip es <strong><em>especialmente</em></strong> importante para los nombres de las variables. Ahí si que recomendamos nunca usar acentos o <strong>Ñ</strong> (o espacios).</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1">#Aca hay que poner el Path Absoluto que apunta a su carpeta de trabajo</span>
<span class="c1">#Por ej: "/home/ibioinfo/Documentos/data_TP8b"</span>
<span class="nf">setwd</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>

<span class="c1">#Uso fread para cargar los datos parseados teniendo en cuenta que tienen NAs</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#Primero que nada se que las columnas de los wells 23 y 24 estan vacias, asi que saco las filas</span>
<span class="c1">#donde *columna* sea 23 o 24 (o sea, me quedo con las filas donde *columna* es 1 a 22)</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_parsed_data</span><span class="p">[</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">]</span>

<span class="c1">#Ahora, la fila y la columna no me esta dando mucha informacion de lo que esta pasando, </span>
<span class="c1">#por lo que quiero agregar informacion de los compuestos y de concentraciones</span>

<span class="c1">#Agrego informacion compuestos</span>
<span class="n">dt_datos_compuestos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="s">"00_datos_compuestos.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">na.strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">dt_parsed_data</span><span class="p">,</span>
<span class="w">                        </span><span class="n">dt_datos_compuestos</span><span class="p">,</span>
<span class="w">                        </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"columna"</span><span class="p">)</span>

<span class="c1">#Agrego informacion concentraciones (ojo que en *00_datos_concentraciones.tsv* el separador decimal es la coma)</span>
<span class="n">dt_datos_concentraciones</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#Para cada combinacion de compuesto y concentracion quiero saber la velocidad de la reaccion, es decir, </span>
<span class="c1">#la pendiente de la recta que sale de hacer una regresion lineal por los 4 tiempos ensayados</span>

<span class="c1">#El primer problema que tengo es que la variable time es un *string*, por lo que no puedo usarla </span>
<span class="c1">#como X en una ecuacion. Por esta razon vamos a convertir a time en cantidad de segundos</span>

<span class="c1">#Si bien hay 1408 filas, en si solo hay 4 tiempos que se repiten:</span>
<span class="c1">#"00:00:00", "00:04:59", "00:10:00" y "00:15:00"</span>

<span class="c1">#Voy entonces a hacer una tabla llamada dt_times_in_seconds que va a empezar vacía y una vez corrido el </span>
<span class="c1">#siguiente *for* va a tener 4 filas, una por cada uno de los 4 tiempos</span>
<span class="c1">#Esta tabla va a tener dos columnas, la columna *time* indicando el tiempo en string que estamos analizando</span>
<span class="c1">#y la columna *segundos_totales* que contiene ese tiempo transformado en numero y en segundos</span>

<span class="c1">#Extraigo entonces los diferentes tiempos y creo una tabla vacia donde voy a guardar la cantidad de segundos </span>
<span class="c1">#para cada *time*</span>
<span class="n">unique_times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="n">dt_parsed_data</span><span class="o">$</span><span class="n">time</span><span class="p">)</span>
<span class="n">dt_times_in_seconds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">character</span><span class="p">(),</span>
<span class="w">                                  </span><span class="n">segundos_totales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">())</span>
<span class="nf">for </span><span class="p">(</span><span class="n">time_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">unique_times</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Esta siguiente linea comentada la uso para debuggear, es decir, para cuando estoy creando el programa</span>
<span class="w">    </span><span class="c1"># Si la ejecutan a mano (sin el #) pueden entonces ir paso a paso en el *for* viendo que funcione todo</span>
<span class="w">    </span><span class="c1"># Recuerden que pueden usar CTRL + ENTER para ejecutar el codigo seleccionado o ver el valor de una variable</span>

<span class="w">    </span><span class="c1"># time_for &lt;- unique_times[2]</span>

<span class="w">    </span><span class="c1">#Divido las horas, minutos y segundos y las transformo a numeros</span>
<span class="w">    </span><span class="n">time_spliteado</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">strsplit</span><span class="p">(</span><span class="n">time_for</span><span class="p">,</span><span class="w"> </span><span class="s">":"</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#*strsplit* devuelve una lista, que es como un vector, pero mas complicado</span>
<span class="w">    </span><span class="c1">#Voy a sobreescribir la variable quedandome solo con el primer elemento de la lista, que es un vector</span>
<span class="w">    </span><span class="n">time_spliteado</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">time_spliteado</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w"> </span>

<span class="w">    </span><span class="c1">#Guardo cada uno de los tres numeros en otra variable. Como ahora son *strings* uso as.numeric() para</span>
<span class="w">    </span><span class="c1">#convertirlos en numeros</span>
<span class="w">    </span><span class="n">horas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
<span class="w">    </span><span class="n">minutos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
<span class="w">    </span><span class="n">segundos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Calculo los segundos totales, es decir, del paso anterior transformo las horas y los minutos en segundos </span>
<span class="w">    </span><span class="c1">#y sumo las tres variables</span>
<span class="w">    </span><span class="n">segundos_totales</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="w">    </span><span class="c1">#Guardo esta info en la tabla que acabo de crear</span>
<span class="w">    </span><span class="n">dt_new_row_times_in_seconds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">,</span>
<span class="w">                                              </span><span class="n">segundos_totales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="n">dt_times_in_seconds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">dt_times_in_seconds</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">dt_new_row_times_in_seconds</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">#Agrego la informacion de los segundos totales (guardada en dt_times_in_seconds) a mi tabla original</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#Ahora van a ver que las columnas de la tabla parecen estar mezcladas, lo que se debe a los merge</span>
<span class="c1">#Por otro lado hay columnas que ya no vamos a usar</span>
<span class="c1">#Resolvemos las dos cosas a la vez rearmando las columnas de la tabla</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_parsed_data</span><span class="p">[,</span><span class="w"> </span><span class="nf">.</span><span class="p">(</span><span class="n">compuesto</span><span class="p">,</span><span class="w"> </span><span class="n">concentracion</span><span class="p">,</span><span class="w"> </span><span class="n">segundos_totales</span><span class="p">,</span><span class="w"> </span><span class="n">signal</span><span class="p">)]</span>

<span class="c1">#Escribo los datos en una nueva tabla</span>
<span class="nf">write.table</span><span class="p">(</span><span class="n">dt_parsed_data</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"03_datos_filtermax_parseados_y_formateados.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">col.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Si todo salió bien, el archivo <strong>03_datos_filtermax_parseados_y_formateados.tsv</strong> debería ser una tabla del estilo:</p>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">compuesto</th>
<th data-sort-method="none" style="text-align: center;">concentracion</th>
<th data-sort-method="none" style="text-align: center;">segundos_totales</th>
<th data-sort-method="none" style="text-align: center;">signal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">417246</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella2"</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">389328</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella3"</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">225039</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella4"</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">248039</td>
</tr>
<tr>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
</tr>
</tbody>
</table>
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning - Gnumeric transforma visualmente los separadores decimales</p>
<p>Si abren el archivo <strong>03_datos_filtermax_parseados_y_formateados.tsv</strong> con Gnumeric van a ver que parece que el separador decimal de los números sigue siendo la coma. Sin embargo, si abren el archivo usando Leafpad van a ver que en realidad el separador decimal es ahora el punto, por lo que para los próximos ejercicios podemos usar <code>fread</code> sin poner el parámetró <code>dec</code>. Gnumeric cambia los puntos visualmente a comas por estar en español.</p>
</div>
<h2 id="paso-4-calcular-velocidades-de-reaccion" markdown="markdown"><strong>Paso 4 - Calcular velocidades de reacción</strong></h2>
<p>En física la <em>velocidad</em> es la variación de posición por unidad de tiempo. La <em>velocidad de reacción</em> es similar, donde queremos averiguar la variación de señal por unidad de tiempo (en nuestro caso es un segundo).</p>
<p>Para cada dilución de cada compuesto, nosotros tenemos la señal a cuatro puntos en el tiempo (una vez cada 5 minutos, o 300 segundos). Vamos a asumir que la señal varía linealmente con el tiempo, por lo que la forma más directa de conseguir la <em>velocidad de reacción</em> es calcular la pendiente de la recta que pasa por los cuatro puntos que conseguimos experimentalmente.</p>
<p>Es de esperar que los cuatro puntos no se alineen perfectamente, pero hay formas en <strong>R</strong> de calcular y plotear la línea que más se ajusta a ellos (hacer una regresión lineal). A continuación mostramos el ejemplo de "Umbrella1" a concentración 0, es decir, la <em>velocidad de reacción base</em> cuando no hay ningún compuesto.</p>
<figure>
<p><a class="glightbox" href="img/velocidad_reaccion.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="VelocidadReaccion" src="img/velocidad_reaccion.png"></a></p>
</figure>
<p>En este plot vemos que la pendiente de la recta es aproximadamente 1718, lo que quiere decir que cada segundo la señal aumenta en 1718. Nuestro objetivo en este paso del TP es calcular este número para todas las concentraciones de todos los compuestos.</p>
<details class="info">
<summary>Código usado para hacer el plot anterior (para los curiosos)</summary>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">dt_parsed_formatted_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="s">"03_datos_filtermax_parseados_y_formateados.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">na.strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span>

<span class="n">linear_regression_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_parsed_formatted_data</span><span class="p">[</span><span class="n">compuesto</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"Umbrella1"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">concentracion</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">segundos_totales</span><span class="p">)</span>

<span class="c1"># La funcion *sprintf* se usa similar a *paste* ya que permite reemplazar los *%s* en el primer string por las variables que le paso</span>
<span class="c1"># a continuacion</span>
<span class="n">formula_aux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Y = %s * X + %s"</span><span class="p">,</span>
<span class="w">                       </span><span class="nf">round</span><span class="p">(</span><span class="n">linear_regression_aux</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">                       </span><span class="nf">round</span><span class="p">(</span><span class="n">linear_regression_aux</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_parsed_formatted_data</span><span class="p">[</span><span class="n">compuesto</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"Umbrella1"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">concentracion</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">segundos_totales</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signal</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'lm'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">"Tiempo (s)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">"Signal"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">"Velocidad base (sin compuesto)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="s">"text"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2000000</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">formula_aux</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="herramientas-necesarias_1">Herramientas necesarias</h3>
<p>En este ejercicio también vamos a necesitar varias herramientas, pero la buena noticia es que la mayoría ya las vieron en el TP anterior o en el paso anterior.</p>
<h4 id="fors-anidados">Fors anidados</h4>
<p>Es bastante común cuando se trabaja con tablas querer recorrer todas las combinaciones de dos variables categóricas. Una forma de hacer esto es usar <em>fors anidados</em>, es decir, un <em>for</em> adentro de otro <em>for</em>. En este caso el <em>for</em> interno se va a ejecutar completo una vez por cada elemento del <em>for</em> externo. Dentro del <em>for</em> interno es donde vamos a poner el código que queramos hacer con cada combinación de nuestras variables.</p>
<p><strong>1)</strong> Corran el siguiente ejemplo y vean lo que devuelve. ¿Cuántas veces se ejecutó el <code>print</code>? ¿En qué orden se recorrieron los diferentes prefijos y sufijos?</p>
<div class="highlight"><pre><span></span><code><span class="n">vector_prefijos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"veinti"</span><span class="p">,</span><span class="w"> </span><span class="s">"cuarenti"</span><span class="p">,</span><span class="w"> </span><span class="s">"ciento"</span><span class="p">)</span>
<span class="n">vector_sufijos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"cuatro"</span><span class="p">,</span><span class="w"> </span><span class="s">"dos"</span><span class="p">,</span><span class="w"> </span><span class="s">"ocho"</span><span class="p">)</span>

<span class="nf">for </span><span class="p">(</span><span class="n">prefijo_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">vector_prefijos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">sufijo_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">vector_sufijos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">numero_for</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="n">prefijo_for</span><span class="p">,</span><span class="w"> </span><span class="n">sufijo_for</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"-"</span><span class="p">)</span>

<span class="w">        </span><span class="nf">print</span><span class="p">(</span><span class="n">numero_for</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="regresion-lineal">Regresión lineal</h4>
<p>El ajuste de mis datos a una fórmula matemática es un tema súper complejo; sin embargo, en este TP necesitamos la versión más simple de esto, que son las regresiones lineales. Existe una función que viene con <strong>R</strong> llamada <code>lm</code> que nos va a permitir calcular una regresión lineal a partir de dos vectores numéricos.</p>
<div class="highlight"><pre><span></span><code><span class="n">regresion_lineal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">regresion_lineal</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">Call</span><span class="o">:</span>
<span class="nf">lm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span>

<span class="n">Coefficients</span><span class="o">:</span>
<span class="w"> </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">  </span><span class="n">Petal.Length</span><span class="w">  </span>
<span class="w">      </span><span class="m">4.3066</span><span class="w">        </span><span class="m">0.4089</span>
</code></pre></div>
<ul>
<li>El parámetro <code>data</code> nos permite poner un <em>Data Frame</em> o <em>Data Table</em> para luego poder mencionar las columnas directamente (de otra forma habría que hacer <code>iris$Sepal.Length</code>)</li>
<li>El parámetro <code>formula</code> es donde le decimos a <code>lm</code> a que fórmula debe ajustar los datos. Para regresión lineal es <code>Y ~ X</code></li>
<li>De imprimir <code>regresion_lineal</code> por pantalla vemos los coeficientes de la fórmula<ul>
<li><code>(Intercept)</code> es la ordenada al origen y la otra columna (en este caso llamada <code>Petal.Length</code>) es la pendiente</li>
</ul>
</li>
</ul>
<p>Podemos extraer cada uno de estos dos números haciendo:</p>
<div class="highlight"><pre><span></span><code><span class="n">ordenada_al_origen</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regresion_lineal</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="n">pendiente</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regresion_lineal</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">¿Se ajustan mis datos a una recta?</p>
<p>Si bien no lo vamos a usar en este TP, es normal al momento de hacer una regresión querer saber que tan bien se ajustan mis datos a la fórmula que usé. Existen varios estadísticos para analizar esto, pero uno muy usado para regresiones lineales es el <strong>R cuadrado</strong>, que no tiene nada que ver con el lenguaje de programación y es un estadístico que va entre 0 y 1 y cuanto más cerca de 1 es mejor es el ajuste lineal (simplificando infinitamente el tema).</p>
<p>En el ejemplo anterior podemos conseguir el <strong>R cuadrado</strong> haciendo:</p>
<div class="highlight"><pre><span></span><code><span class="n">r_cuadrado</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">regresion_lineal</span><span class="p">)</span><span class="o">$</span><span class="n">r.squared</span>
</code></pre></div>
</div>
<h3 id="paso-4-ejercicio">Paso 4 - Ejercicio</h3>
<p><strong>2)</strong> Creen un nuevo script de <strong>R</strong>, copien el siguiente código y guardenlo en su carpeta de trabajo. Vayan avanzando por el <em>script</em> y cambien las secciones que dicen <code>@@EDITAR@@</code> por lo que corresponda (esto puede ser un valor, una variable, una operación matemática, una comparación o una función de <strong>R</strong>).</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Aca hay que poner el Path Absoluto que apunta a su carpeta de trabajo</span>
<span class="c1">#Por ej: "/home/ibioinfo/Documentos/data_TP8b"</span>
<span class="nf">setwd</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>

<span class="c1">#Leo los datos ya parseados y formateados</span>
<span class="n">dt_parsed_formatted_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fread</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#Para cada combinacion de compuesto y concentracion quiero saber la velocidad de la reaccion, es decir, </span>
<span class="c1">#la pendiente de la recta que sale de hacer una regresion lineal por los 4 tiempos ensayados</span>

<span class="c1">#Creo la tabla vacia donde voy a guardar estos datos</span>
<span class="n">dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">compuesto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">character</span><span class="p">(),</span>
<span class="w">                                         </span><span class="n">concentracion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">(),</span>
<span class="w">                                         </span><span class="n">velocidad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">())</span>

<span class="c1">#Voy a tener que recorrer todas las combinaciones de compuestos y concentraciones</span>
<span class="c1">#Consigo vectores con cada compuesto diferente y con cada concentracion diferente</span>
<span class="n">unique_compuestos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="n">dt_parsed_formatted_data</span><span class="o">$</span><span class="n">compuesto</span><span class="p">)</span>
<span class="n">unique_concentraciones</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="nf">for </span><span class="p">(</span><span class="n">compuesto_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">unique_compuestos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># compuesto_for &lt;- unique_compuestos[1]</span>

<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">concentracion_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">unique_concentraciones</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1"># concentracion_for &lt;- unique_concentraciones[1]</span>

<span class="w">        </span><span class="c1">#Por cada combinacion de compuesto + concentracion quiero calcular la velocidad de reaccion</span>
<span class="w">        </span><span class="c1">#Para eso lo primero que necesito hacer es filtrar los datos de *dt_parsed_formatted_data*, para quedarme solo</span>
<span class="w">        </span><span class="c1">#con aquellas signals que correspondan al compuesto y concentracion de la iteracion actual del *for*</span>
<span class="w">        </span><span class="n">sub_dt_parsed_formatted_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_parsed_formatted_data</span><span class="p">[(</span><span class="n">compuesto</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)]</span>

<span class="w">        </span><span class="c1">#Calculo la regresion lineal usando los datos de *sub_dt_parsed_formatted_data* y considerando a</span>
<span class="w">        </span><span class="c1">#*segundos_totales* como el X y a *signal* como el Y</span>
<span class="w">        </span><span class="n">regresion_lineal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sub_dt_parsed_formatted_data</span><span class="p">,</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">segundos_totales</span><span class="p">)</span><span class="w">        </span>

<span class="w">        </span><span class="c1">#Extraigo la pendiente, que es el segundo elemento del elemento *coefficients*</span>
<span class="w">        </span><span class="n">velocidad_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regresion_lineal</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>

<span class="w">        </span><span class="c1">#Creo una nueva fila para agregar a mi tabla de velocidades de reaccion</span>
<span class="w">        </span><span class="c1">#Esta fila corresponde al compuesto y a la concentracion de esta iteracion de los *fors*, asi como</span>
<span class="w">        </span><span class="c1">#la velocidad que acabo de calcular</span>
<span class="w">        </span><span class="n">new_row_dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">compuesto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">,</span>
<span class="w">                                                         </span><span class="n">concentracion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">,</span>
<span class="w">                                                         </span><span class="n">velocidad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">        </span><span class="c1">#Agrego la nueva fila recien creada a mi tabla en donde guardo todas las velocidades</span>
<span class="w">        </span><span class="n">dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span>
<span class="p">}</span>

<span class="c1">#Escribo los datos en una nueva tabla</span>
<span class="nf">write.table</span><span class="p">(</span><span class="n">dt_velocidades_de_reaccion</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"04_velocidades_de_reaccion.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">col.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Si todo salió bien, el archivo <strong>04_velocidades_de_reaccion.tsv</strong> debería ser una tabla del estilo:</p>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">compuesto</th>
<th data-sort-method="none" style="text-align: left;">concentracion</th>
<th data-sort-method="none" style="text-align: left;">velocidad</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: left;">200</td>
<td style="text-align: left;">633.30896128865</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: left;">133.3333333</td>
<td style="text-align: left;">672.561474192526</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: left;">88.88888889</td>
<td style="text-align: left;">710.350673411048</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: left;">59.25925926</td>
<td style="text-align: left;">630.08948130777</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: left;">39.50617284</td>
<td style="text-align: left;">720.288720371885</td>
</tr>
<tr>
<td style="text-align: center;">...</td>
<td style="text-align: left;">...</td>
<td style="text-align: left;">...</td>
</tr>
</tbody>
</table>
</figure>
<p>(sí, los decimales son horribles, en un ratito los arreglamos)</p>
<h2 id="paso-5-calcular-y-plotear-ic-50" markdown="markdown"><strong>Paso 5 - Calcular y plotear IC 50</strong></h2>
<p>Primero que nada tenemos que definir un par de conceptos:</p>
<p>Vamos a llamar <strong><em>velocidad de reacción base</em></strong> a la <em>velocidad de reacción</em> de la enzima cuando no tiene ningún inhibidor, o lo que es lo mismo, cuando la concentración del inhibidor es 0. En nuestro caso tenemos 22 wells donde la concentración del inhibidor es 0, por lo que vamos a calcular a la <em>velocidad de reacción base</em> como el promedio de las velocidades en esos 22 wells.</p>
<p>Vamos a llamar <strong><em>actividad</em></strong> a la relación entre la <em>velocidad de reacción</em> observada al usar una concentración dada de un compuesto, y la <em>velocidad de reacción base</em>. Es decir:</p>
<div class="arithmatex">\[
actividad = \frac{velocidadReaccion}{velocidadReaccionBase}
\]</div>
<ul>
<li>Si no hay inhibidor o si la concentración del inhibidor es muy baja para que haga efecto <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> <strong>Actividad ~ 1</strong></li>
<li>Si no hay enzima o si estoy usando un inhibidor perfecto <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg></span> <strong>Actividad ~ 0</strong></li>
</ul>
<p>Ahora sí, queremos calcular una curva de dosis-respuesta para ver como es afectada nuestra <strong>enzima Z</strong> por diferentes concentraciones de cada uno de los 22 compuestos. En general es esperable que:</p>
<ul>
<li>A muy bajas concentraciones del compuesto no hay efecto sobre la enzima, por lo que estoy viendo la una <em>actividad</em> cercana a 1. Esto quiere decir que esperamos ver varias concentraciones bajas de un compuesto que muestren la misma <em>actividad</em>.</li>
<li>A muy altas concentraciones del compuesto ya está saturado el efecto que él pueda hacer sobre la enzima (por ejemplo todos los sitios de unión ya están ocupados), por lo que estoy viendo el máximo efecto que puede hacer dicho compuesto a la <em>actividad</em> de la enzima. Esto quiere decir que esperamos ver varias concentraciones altas que muestren la misma <em>actividad</em>.</li>
<li>Las concentraciones intermedias son aquellas en donde una variación en la concentración del compuesto produce un cambio en la <em>actividad</em> de la enzima.</li>
</ul>
<p>Estás tres propiedades hacen que la curva dosis-respuesta tenga una forma sigmoidea, es decir:</p>
<figure>
<p><a class="glightbox" href="img/dose-response-curve-ic50.svg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="CurvaDosisRespuesta" src="img/dose-response-curve-ic50.svg"></a></p>
</figure>
<p>Donde en nuestro caso la respuesta va a ser la <em>actividad</em> y la dosis va a ser la concentración de nuestro compuesto. Dependiendo de las concentraciones elegidas, es normal ver que el eje X de este plot esté en escala logarítmica.</p>
<p>En el plot está marcado el <strong>IC 50</strong>, el cual es la concentración del compuesto a la cual la <em>actividad</em> de la enzima cae al 50% (es decir, cuando la <em>velocidad de reacción</em> es la mitad que la <em>velocidad de reacción base</em>). El <strong>IC 50</strong> da información de donde está el rango de concentraciones de dicho compuesto que hacen variar la <em>actividad</em> enzimática, entre otras cosas.</p>
<h3 id="herramientas">Herramientas</h3>
<h4 id="instalar-paquetes-de-r">Instalar paquetes de <strong>R</strong></h4>
<p>Para calcular el <strong>IC 50</strong> vamos a ajustar nuestros datos a una curva sigmoidea, para lo cual vamos a instalar un paquete de <strong>R</strong> llamado <code>nplr</code> que hace estos cálculos por nosotros.</p>
<p><strong>1)</strong> Para instalar un paquete corran en <strong>R</strong> la línea:</p>
<div class="highlight"><pre><span></span><code><span class="nf">install.packages</span><span class="p">(</span><span class="s">"nplr"</span><span class="p">)</span>
</code></pre></div>
<p>Y recuerden que cuando lo quieran usar tienen que cargarlo usando <code>library(nplr)</code> o <code>library("nplr")</code>. Como es bastante avanzado no vamos a hablar de <code>nplr</code> por ahora y les vamos a dar esa parte del código ya hecha.</p>
<h4 id="crear-y-modificar-columnas">Crear y modificar columnas</h4>
<p>Una cosa más que tenemos que aprender con los <em>Data Tables</em> es como agregar una columna nueva, o como modificar una columna ya existente. Esto se hace simplemente asignándole el nuevo valor a la columna como si fuera una variable o vector, solo que es importante que el nuevo valor sea o un solo elemento o un vector con longitud igual al número de filas de la tabla.</p>
<p><strong>2)</strong> Corran el siguiente ejemplo y vean lo que devuelve.</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>

<span class="n">dt_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1">#Creo nuevas columnas</span>

<span class="c1">#Si le paso un valor solo toda esa columna va a tener ese valor</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">nueva_columna</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>

<span class="c1">#De otra forma tengo que pasarle un vector con longitud igual al numero de filas</span>
<span class="c1">#Este vector puede ser combinacion de otras de las columnas de la tabla</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">otra_nueva_columna</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt_iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>

<span class="c1">#Me arrepenti del valor que cree en la columna al principio</span>
<span class="n">dt_iris</span><span class="o">$</span><span class="n">nueva_columna</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dt_iris</span><span class="p">)</span>
</code></pre></div>
<h4 id="crear-plots-en-pdfs">Crear plots en PDFs</h4>
<p>Nosotros sabemos crear plots en RStudio, pero hay veces donde uno tiene que hacer decenas (o miles) de plots y quiere guardarlos todos en un solo proceso. <strong>R</strong> tiene varias funciones que nos permiten guardar los plots como <strong>.jpg</strong>, <strong>.png</strong>, <strong>.svg</strong>, etc. Acá nos vamos a enfocar en la función que nos permite guardarlos como <strong>.pdf</strong>.</p>
<p><strong>3)</strong> Corran el siguiente ejemplo y vean lo que devuelve (va a crear un archivo en su <em>Working Directory</em>).</p>
<div class="highlight"><pre><span></span><code><span class="nf">pdf</span><span class="p">(</span><span class="s">"test.pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span>
<span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">,</span>
<span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span>
<span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div>
<p>Los parámetros <code>width</code> y <code>height</code> indican el tamaño en pulgadas de cada página en el pdf. Noten que a partir que abren el pdf los plots ya no van a aparecer en la pestaña Plots de RStudio hasta que cierren el pdf (se podría pensar que redirige la salida del plot al archivo pdf).</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Resetear los gráficos</p>
<p>A veces pasa que un pdf queda abierto más de lo que debería y no se cierra bien, o que no se crea como debería. En estos casos pueden usar la función <code>graphics.off()</code> antes y después del código anterior (especialmente antes) para limpiar cualquier cosa abierta. Solo tengan en cuenta que esto va a vaciarles los plots que tengan guardados en el panel Plots de RStudio.</p>
</div>
<h4 id="la-verdad-de-la-funcion-plot">La verdad de la función <code>plot</code></h4>
<p>Nosotros acabamos de ver unos plots hechos con la función <code>plot()</code>, que es la forma de plotear por defecto en <strong>R</strong>. Sin embargo <code>plot</code> no solo plotea cosas pasándole un X y un Y, sino que también es una función que de pasarle ciertos tipos de variables (como puede ser una regresión logística) usa un plot interno de dichas variables. </p>
<p>El paquete <code>nplr</code> trae sus propios plots que se van a hacer mediante <code>plot(regresion_logistica)</code>. Esto no es único de este paquete y existen otras librerías, por ejemplo de filogenia, que tienen este mismo funcionamiento, donde <code>plot</code> hace árboles filogenéticos.</p>
<h4 id="google">Google</h4>
<p>Es muy importante al momento de programar saber buscar funcionalidades que uno quiere usar en sus programas.</p>
<p><strong>4)</strong> Busquen en internet:</p>
<ul>
<li>Cómo se calcula el máximo de los elementos de un vector de números en <strong>R</strong></li>
<li>Cómo se calcula el mínimo de los elementos de un vector de números en <strong>R</strong></li>
<li>Cómo se calcula el promedio de los elementos de un vector de números en <strong>R</strong></li>
<li>Cómo se redondea los decimales de un número en <strong>R</strong></li>
</ul>
<!--
#### Calcular promedio

Es posible calcular el promedio de los números en un vector usando la función `mean`.

<div class="highlight"><pre><span></span><code><span class="n">promedio_sepal_length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">promedio_sepal_length</span><span class="p">)</span>
</code></pre></div>

#### Redondear decimales

Es posible redondear números, lo que es especialmente útil para cuando tenemos números con muchos decimales que realmente no aportan información.

<div class="highlight"><pre><span></span><code><span class="n">numero_base</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">123.456789123456789</span>

<span class="c1">#Aca 2 es la cantidad de decimales</span>
<span class="n">numero_redondeado</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">numero_base</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">numero_redondeado</span><span class="p">)</span>
</code></pre></div>
-->

<h3 id="paso-5-ejercicio">Paso 5 - Ejercicio</h3>
<p><strong>5)</strong> Creen un nuevo script de <strong>R</strong>, copien el siguiente código y guárdenlo en su carpeta de trabajo. Vayan avanzando por el <em>script</em> y cambien las secciones que dicen <code>@@EDITAR@@</code> por lo que corresponda (esto puede ser un valor, una variable, una operación matemática, una comparación o una función de <strong>R</strong>).</p>
<div class="admonition warning">
<p class="admonition-title">Warnings en el código</p>
<p>Al ejecutar el siguiente código les va a aparecer por consola varios <em>Warnings</em> de <code>nplr</code> sobre el fiteo del modelo y la predicción del IC 50. Los <em>Warnings</em> son advertencias, las cuales informan eventos que pueden o no causar problemas. Si bien es importante prestarle atención a estos <em>Warnings</em> cuando aparecen, en este caso ya están contemplados y pueden ignorarlos.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1">#Aca hay que poner el Path Absoluto que apunta a su carpeta de trabajo</span>
<span class="c1">#Por ej: "/home/ibioinfo/Documentos/data_TP8b"</span>
<span class="nf">setwd</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">nplr</span><span class="p">)</span>

<span class="c1">#Leo los datos de las velocidades de reaccion</span>
<span class="n">dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="c1">#Quiero calcular la velocidad de reaccion base, es decir, la velocidad de reaccion sin compuestos</span>
<span class="c1">#Esto es cuando la concentracion del compuesto es 0</span>
<span class="c1">#Nosotros tenemos uno de esos casos para cada compuesto, o sea, tenemos 22 versiones del experimento sin compuesto</span>
<span class="c1">#Vamos a calcular la velocidad de reaccion base como el promedio de esas 22 velocidades</span>
<span class="n">velocidades_reaccion_sin_compuesto</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_velocidades_de_reaccion</span><span class="p">[</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">]</span><span class="o">$</span><span class="n">velocidad</span>
<span class="n">velocidad_reaccion_base</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">velocidades_reaccion_sin_compuesto</span><span class="p">)</span>

<span class="c1">#Ahora que ya las use, voy a sacar las filas que no tengan concentracion de compuesto </span>
<span class="c1">#ya que no tiene sentido analizarlas para el IC 50</span>
<span class="n">dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt_velocidades_de_reaccion</span><span class="p">[</span><span class="n">concentracion</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">]</span>

<span class="c1">#Quiero calcular la actividad para cada combinacion de compuesto y concentracion</span>
<span class="c1">#La actividad es la relacion entre la velocidad de reaccion y la velocidad de reaccion base (es decir, la division)</span>
<span class="n">dt_velocidades_de_reaccion</span><span class="o">$</span><span class="n">actividad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="c1">#El *for* de mas adelante va a tener 2 salidas, un pdf con los plots y un tsv con los datos</span>
<span class="c1">#Tengo que inicializar ambos</span>

<span class="c1">#Abro el pdf (toda imagen que se plotee hasta que se cierre el pdf va a ir a el)</span>
<span class="nf">pdf</span><span class="p">(</span><span class="s">"05_IC50_plots.pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>

<span class="c1">#Creo la tabla vacia</span>
<span class="n">dt_IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">compuesto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">character</span><span class="p">(),</span>
<span class="w">                      </span><span class="n">actividad_minima</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">(),</span>
<span class="w">                      </span><span class="n">actividad_maxima</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">(),</span>
<span class="w">                      </span><span class="n">IC50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">())</span>

<span class="c1">#Recorro todos los compuestos 1 a la vez y calculo el IC 50 para cada uno</span>
<span class="n">unique_compuestos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="nf">for </span><span class="p">(</span><span class="n">compuesto_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">unique_compuestos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># compuesto_for &lt;- unique_compuestos[1]</span>

<span class="w">    </span><span class="c1">#Por cada compuesto quiero calcular el IC 50 y plotearlo</span>
<span class="w">    </span><span class="c1">#Para eso lo primero que necesito hacer es filtrar los datos de *dt_velocidades_de_reaccion*, para quedarme solo</span>
<span class="w">    </span><span class="c1">#con aquellas concentraciones y actividades que correspondan al compuesto de la iteracion actual del *for*</span>
<span class="w">    </span><span class="n">sub_dt_velocidades_de_reaccion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="w">    </span><span class="c1">#Calculo la regresion sigmoidea usando los datos de *sub_dt_parsed_formatted_data* y considerando a</span>
<span class="w">    </span><span class="c1">#*concentracion* como el X y a *actividad* como el Y</span>
<span class="w">    </span><span class="n">regresion_sigmoidea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nplr</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sub_dt_velocidades_de_reaccion</span><span class="o">$</span><span class="n">concentracion</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sub_dt_velocidades_de_reaccion</span><span class="o">$</span><span class="n">actividad</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Esto es una funcion de nplr que calcula el X correspondiente a Y = 0.5, es decir, el IC 50</span>
<span class="w">    </span><span class="n">estimacion_IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">getEstimates</span><span class="p">(</span><span class="n">regresion_sigmoidea</span><span class="p">,</span><span class="w"> </span><span class="n">targets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Hay casos donde no puede calcularlo, pero en vez de devolver NA calcula el X para el Y mas cercano a 0.5</span>
<span class="w">    </span><span class="c1">#Yo no quiero eso, quiero solo los X cuando Y es 0.5, y sino devolver NA</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">estimacion_IC50</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">estimacion_IC50</span><span class="o">$</span><span class="n">x</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">#Aca estoy asignando a mano el valor NA (sin comillas), o sea, el valor "vacio"</span>
<span class="w">        </span><span class="n">IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">#Calculo la actividad minima y maxima para guardarla en el output</span>
<span class="w">    </span><span class="n">actividad_minima</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">sub_dt_velocidades_de_reaccion</span><span class="o">$</span><span class="n">actividad</span><span class="p">)</span>
<span class="w">    </span><span class="n">actividad_maxima</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="w">    </span><span class="c1">#Creo una nueva fila para agregar a mi tabla de IC 50</span>
<span class="w">    </span><span class="c1">#Esta fila corresponde al compuesto de esta iteracion de los *fors*, asi como</span>
<span class="w">    </span><span class="c1">#el IC 50 que acabo de calcular</span>
<span class="w">    </span><span class="n">new_row_dt_IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Agrego la nueva fila recien creada a mi tabla en donde guardo todas las velocidades</span>
<span class="w">    </span><span class="n">dt_IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="w">    </span><span class="c1">#Ploteo la regresion (les recomiendo poner el numero de compuesto y el IC 50 en el titulo)</span>
<span class="w">    </span><span class="n">titulo_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>
<span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">regresion_sigmoidea</span><span class="p">,</span>
<span class="w">         </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">titulo_plot</span><span class="p">,</span>
<span class="w">         </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Log10 Concentracion (micromolar)"</span><span class="p">,</span>
<span class="w">         </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Actividad"</span><span class="p">,</span>
<span class="w">         </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">),</span>
<span class="w">         </span><span class="n">showGOF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span>
<span class="w">         </span><span class="n">xaxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"n"</span><span class="p">)</span>
<span class="w">    </span><span class="c1">#Reescribo el eje X para que se entienda que es logaritmico</span>
<span class="w">    </span><span class="nf">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">1.5</span><span class="p">),</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">2</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c1">#Cierro el pdf</span>
<span class="nf">dev.off</span><span class="p">()</span>

<span class="c1">#Redondeo los decimales extras de los numeros</span>
<span class="n">dt_IC50</span><span class="o">$</span><span class="n">IC50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">dt_IC50</span><span class="o">$</span><span class="n">IC50</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>
<span class="n">dt_IC50</span><span class="o">$</span><span class="n">actividad_minima</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>
<span class="n">dt_IC50</span><span class="o">$</span><span class="n">actividad_maxima</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="c1">#Escribo los datos en una nueva tabla</span>
<span class="nf">write.table</span><span class="p">(</span><span class="n">dt_IC50</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"05_IC50_data.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">col.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Si todo salió bien, el archivo <strong>05_IC50_data.tsv</strong> debería ser una tabla del estilo:</p>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">compuesto</th>
<th data-sort-method="none" style="text-align: center;">actividad_minima</th>
<th data-sort-method="none" style="text-align: center;">actividad_maxima</th>
<th data-sort-method="none" style="text-align: center;">IC50</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"Umbrella1"</td>
<td style="text-align: center;">0.1708</td>
<td style="text-align: center;">0.8627</td>
<td style="text-align: center;">5.2665</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella2"</td>
<td style="text-align: center;">0.3451</td>
<td style="text-align: center;">0.7292</td>
<td style="text-align: center;">2.3456</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella3"</td>
<td style="text-align: center;">0.125</td>
<td style="text-align: center;">0.1688</td>
<td style="text-align: center;">NA</td>
</tr>
<tr>
<td style="text-align: center;">"Umbrella4"</td>
<td style="text-align: center;">0.1595</td>
<td style="text-align: center;">0.7243</td>
<td style="text-align: center;">2.8252</td>
</tr>
<tr>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
</tr>
</tbody>
</table>
</figure>
<details class="info">
<summary>Detrás de escenas del armado de este TP</summary>
<p>Al momento de hacer este TP tuvimos que analizar nosotros los mismos datos que ahora están utilizando ustedes y no teníamos mucha experiencia con <code>nplr</code>.</p>
<p>En las primeras versiones de este TP no estaba la condición <code>if (estimacion_IC50$y == 0.5)</code>, pero mirando los datos de la tabla vs los datos del plot nos dimos cuenta que algo no cerraba. Por ejemplo, el <strong>IC 50</strong> en el "Umbrella22" daba 0.6851, pero miren el plot, no tenía sentido eso.</p>
<p>Fuimos al <em>for</em> y reemplazamos la primera línea comentada por <code># compuesto_for &lt;- unique_compuestos[22]</code>, seleccionamos solo la última parte (sin el <code>#</code>) y la corrimos con <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-enter">Enter</kbd></span>, lo que en este caso hizo que <code>compuesto_for</code> sea "Umbrella22". Ahí fuimos paso a paso por el <em>for</em> viendo que devolvía cada función.</p>
<p>Al ejecutar <code>estimacion_IC50 &lt;- getEstimates(regresion_sigmoidea, targets = 0.5)</code> el programa nos tiró el siguiente Warning:</p>
<div class="highlight"><pre><span></span><code><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="nf">One </span><span class="p">(</span><span class="n">or</span><span class="w"> </span><span class="n">more</span><span class="p">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">estimated</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">asymptote.</span>
<span class="n">These</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">maximal</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">estimate.</span>
</code></pre></div>
<p>Miramos entonces adentro de la variable <code>estimacion_IC50</code> y vimos que <code>estimacion_IC50$y</code> era 0.004, lo que significaba que en esta iteración no estábamos calculando el <strong>IC 50</strong>, sino el <strong>IC 0.4</strong>, que no es lo que queríamos.</p>
<p>A partir de esto pusimos el <code>if</code> y le asignamos <strong>NA</strong> a <strong>IC 50</strong> cuando el <code>y</code> no era 0.5.</p>
<p>Lo comentamos más que nada para mostrar que el análisis de datos es bastante prueba y error y que es importante pensar si lo que están viendo tiene sentido.</p>
<p>Bienvenidos a la Bioinformática <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 352c37.2 0 63.2-17.5 78.4-33.9 8.9-9.7 24.1-10.4 33.9-1.4 9.7 9 10.3 24.2 1.3 33.9C347.7 374.5 309.7 400 256 400c-53.7 0-91.7-25.5-113.6-49.4-9-9.7-9.3-24.9 1.3-33.9 9.8-9 25-8.3 33.9 1.4 15.2 16.4 41.2 33.9 78.4 33.9zm-47.6-144c0 17.7-14.4 32-32 32-17.7 0-32-14.3-32-32s14.3-32 32-32c17.6 0 32 14.3 32 32zm96 0c0-17.7 14.3-32 32-32 17.6 0 32 14.3 32 32s-14.4 32-32 32c-17.7 0-32-14.3-32-32zM512 256c0 141.4-114.6 256-256 256S0 397.4 0 256 114.6 0 256 0s256 114.6 256 256zM256 48C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"></path></svg></span></p>
</details>
<h2 id="paso-6-conclusiones"><strong>Paso 6 - Conclusiones</strong></h2>
<p>Ahora que tenemos todos los datos que necesitamos es momento de analizarlos. Viendo el <strong>.pdf</strong> y la tabla generados en el paso anterior respondan:</p>
<p><strong>1)</strong> ¿Por qué hay casos donde el <strong>IC 50</strong> dió <strong>NA</strong>?</p>
<p><strong>2)</strong> En base a los plots obtenidos, ¿Les parecen suficientes nuestros datos para estar seguros de los <strong>IC 50</strong> calculados? ¿Cuál es un compuesto donde están bastantes seguros de su <strong>IC 50</strong>? ¿Cuál es un compuesto donde desconfían del <strong>IC 50</strong> calculado?</p>
<p><strong>3)</strong> ¿Qué experimentos harían para tener la curva completa en "Umbrella1"? ¿Y en "Umbrella8"?</p>
<p><strong>4)</strong> En base a lo observado, nombren dos o tres compuestos que recomendarían para inhibir a la <strong>enzima Z</strong>. ¿Por qué los eligieron?</p>
<h2 id="ejercicio-adicional-1-paso-2-limpiar-y-parsear-el-archivo" markdown="markdown"><strong>Ejercicio Adicional 1 - Paso 2 - Limpiar y Parsear el Archivo</strong></h2>
<p>Leer el <strong>Paso 2</strong> para entender el objetivo de este ejercicio.</p>
<h3 id="herramientas_1">Herramientas</h3>
<h4 id="leer-y-escribir-texto-plano">Leer y escribir texto plano</h4>
<p>Por "texto plano" nos referimos a leer un archivo de texto que no tiene un formato definido (o sea no es un <strong>.csv</strong> o <strong>.tsv</strong>, por ejemplo). Esto puede ser algo como un libro, notas, o una tabla que por alguna razón no la queremos leer como tabla.</p>
<p>La forma más directa de leer texto plano en <strong>R</strong> es la función <code>readLines()</code>, a la cual hay que pasarle el path del archivo a leer. Esta función va a devolver un vector en el cual cada elemento es una línea del archivo leído. Se usa:</p>
<div class="highlight"><pre><span></span><code><span class="n">nuevo_vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">readLines</span><span class="p">(</span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ARCHIVO"</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
<p>Por otro lado también existe la función inversa, que nos permite escribir un vector en un archivo de texto, donde cada elemento del vector va a ser una línea de texto en el archivo. Esta función es <code>writeLines()</code> y se usa:</p>
<div class="highlight"><pre><span></span><code><span class="nf">writeLines</span><span class="p">(</span><span class="n">vector_con_texto</span><span class="p">,</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ARCHIVO_SALIDA"</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
<p>La función <code>writeLines()</code> también se puede usar de una forma similar a <code>print</code> si no se le pasa el parámetro <code>con</code>.</p>
<h4 id="extraer-nombres-columnas">Extraer nombres columnas</h4>
<p>Hay varias razones por lo cual es útil extraer un vector con el nombre de las columnas de una tabla, pero hoy lo vamos a hacer para extraer información de dichos nombres.</p>
<p>La función <code>colnames()</code> nos devuelve un vector con el nombre de las columnas de una tabla en el orden en el que aparecen en dicha tabla. Por ej:</p>
<div class="highlight"><pre><span></span><code><span class="n">columnas_iris</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">columnas_iris</span><span class="p">)</span>
</code></pre></div>
<h4 id="extraer-substrings">Extraer substrings</h4>
<p>Muchas veces es útil extraer pedazos de <em>strings</em> y ya vimos una forma de hacer esto con <code>split</code>. Sin embargo, hay veces cuando no sabemos el caracter que delimita el texto que queremos extraer, pero sí sabemos su posición en la cadena completa. En estos casos podemos usar la función <code>substring</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">variable_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">"123456789"</span><span class="p">)</span>

<span class="n">segundo_caracter</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">substring</span><span class="p">(</span><span class="n">variable_string</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>

<span class="n">tercer_a_quinto_caracteres</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">substring</span><span class="p">(</span><span class="n">variable_string</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>

<span class="n">septimo_caracter_en_adelante</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">substring</span><span class="p">(</span><span class="n">variable_string</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>
</code></pre></div>
<h4 id="usar-una-variable-para-acceder-a-una-columna-de-un-data-table" markdown="markdown">Usar una variable para acceder a una columna de un Data Table</h4>
<p>A veces pasa que quiero acceder a una variable de una tabla, pero no se previamente a cual. Aca nos va a ser útil otra forma de acceder a las columnas de las tablas, por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Los 3 bloques siguientes devuelven lo mismo</span>

<span class="n">iris</span><span class="o">$</span><span class="n">Species</span>

<span class="n">iris</span><span class="p">[[</span><span class="s">"Species"</span><span class="p">]]</span>

<span class="n">columna</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">"Species"</span>
<span class="n">iris</span><span class="p">[[</span><span class="n">columna</span><span class="p">]]</span>
</code></pre></div>
<!--
#### Filtrar vectores usando booleanos???

Los *booleanos* vistos en el TP anterior también pueden ser usados para filtrar vectores, por ejemplo:

<div class="highlight"><pre><span></span><code><span class="n">vector_numeros</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">)</span>

<span class="n">vector_booleanos1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">vector_palabras</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;hola&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;chau&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hola&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hola&quot;</span><span class="p">)</span>
<span class="n">vector_booleanos2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_palabras</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;hola&quot;</span>

<span class="n">vector_numeros_filtrado1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_numeros</span><span class="p">[</span><span class="n">vector_booleanos1</span><span class="p">]</span>
<span class="n">vector_numeros_filtrado2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_numeros</span><span class="p">[</span><span class="n">vector_booleanos2</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="n">vector_numeros_filtrado1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">vector_numeros_filtrado2</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="n">vector_numeros_filtrado1</span><span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">9</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="n">vector_numeros_filtrado2</span><span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">9</span>
</code></pre></div>

Donde `vector_booleanos1` es un vector de *booleanos* declarado a mano y `vector_booleanos2` se calcula a partir de una comparación en masa.

**7)** Dados los siguientes dos vectores y usando lo que acaban de aprender, impriman por pantalla un vector que contenga los nombres de las personas con mas de 20 años.

<div class="highlight"><pre><span></span><code><span class="c1"># La edad en la posición 1 corresponde al nombre en la posición 1 y así</span>
<span class="n">vector_edad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">78</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">103</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">)</span>
<span class="n">vector_nombres</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;José&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Laura&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pedro&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;María&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Esteban&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ricardo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Clara&quot;</span><span class="p">)</span>
</code></pre></div>
-->

<h3 id="ejercicio">Ejercicio</h3>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#### Paso 2a - LIMPIAR DATOS ####</span>
<span class="c1">#Uso readLines para cargar el archivo de texto plano</span>
<span class="n">plain_text_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">readLines</span><span class="p">(</span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"00_datos_filtermax.txt"</span><span class="p">)</span>

<span class="c1">#La fila 2 es el header</span>
<span class="c1">#Las filas 3 a 6 son los datos</span>
<span class="c1">#Las demas no me interesan</span>
<span class="n">plain_text_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plain_text_data</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">6</span><span class="p">)]</span>

<span class="c1">#Escribo los datos en un nuevo archivo</span>
<span class="nf">writeLines</span><span class="p">(</span><span class="n">plain_text_data</span><span class="p">,</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"01_datos_filtermax_limpios.tsv"</span><span class="p">)</span>

<span class="c1">#### Paso 2b - PARSEAR DATOS ####</span>
<span class="c1">#Uso fread para cargar la tabla con los datos como salen de FilterMax (pero sin lineas extras)</span>
<span class="c1">#Aca es importante recordar que teníamos NAs en nuestros datos y que estaban escritos como *nada*, es decir, ""</span>
<span class="n">clean_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>

<span class="c1">#Viendo clean_data pueden ver una columna extra al final llamada V387 (debido a la cantidad de tabs al final del archivo)</span>
<span class="c1">#Ese es el nombre que le da data.tables por defecto a las columnas sin nombre (esta es la columna 387)</span>
<span class="c1">#Para que no moleste la sacamos</span>
<span class="n">clean_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">clean_data</span><span class="p">[,</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">]</span>

<span class="c1">#Los numeros (columnas de la placa well) son los compuestos</span>
<span class="c1">#Las letras (filas de la placa well) son las diferentes concentraciones</span>
<span class="c1">#Queremos poner los mismos datos en una tabla donde nos sea mas facil filtrar un dato específico</span>
<span class="c1">#Creo la tabla vacia donde voy a guardar estos datos</span>
<span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">,</span>
<span class="w">                             </span><span class="n">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">()</span>
<span class="w">                             </span><span class="n">fila</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">,</span>
<span class="w">                             </span><span class="n">columna</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">numeric</span><span class="p">(),</span>
<span class="w">                             </span><span class="n">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="c1">#Hay varias formas de hacer esto con paquetes extras o con codigos dificiles, pero por ahora vamos a </span>
<span class="c1">#usar una forma un poco menos eficiente pero que se entiende un poco mas</span>

<span class="c1">#Quiero crear una lista con todos los nombres de los wells</span>
<span class="n">wells_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="n">clean_data</span><span class="p">)</span>

<span class="c1">#Ahora tengo lo que necesito, pero las primeras dos posiciones son Time y Temperature</span>
<span class="c1">#Las saco del vector de los nombres</span>
<span class="n">wells_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">wells_names</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)]</span>

<span class="c1">#Voy a recorrer cada nombre de columna y extraer a que fila y a que columna del well corresponde</span>
<span class="c1">#Luego voy a guardar las cuatro signals de esa columna de la tabla con la informacion que acabo de conseguir</span>
<span class="nf">for </span><span class="p">(</span><span class="n">well_name_for</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wells_names</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># well_name_for &lt;- wells_names[1]</span>

<span class="w">    </span><span class="c1">#Uso substring para extraer la letra de la fila en el well</span>
<span class="w">    </span><span class="n">fila_for</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">substring</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Uso substring para extraer el numero de la columna en el well</span>
<span class="w">    </span><span class="c1">#Uso un patrón que funcione para cualquiera de los wells por más que el número tenga 1 o 2 decimales</span>
<span class="w">    </span><span class="n">columna_for</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">substring</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Quiero guardar la columna como numero, asi que transformo la variable character en un numeric</span>
<span class="w">    </span><span class="c1">#Es decir, paso de "1" a 1 (por ej)</span>
<span class="w">    </span><span class="n">columna_for</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">columna_for</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Creo nuevas fila para agregar a mi tabla de datos parseados</span>
<span class="w">    </span><span class="c1">#Aca fila y columna van a ser un valor único</span>
<span class="w">    </span><span class="c1">#Por otro lado, time, temperature y signal van a ser vectores de 4 valores (son las columnas de clean_data)</span>
<span class="w">    </span><span class="c1">#La columna Temperature puede ser que se escriba un poco rara por problemas de caracteres</span>
<span class="w">    </span><span class="n">dt_new_rows_in_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clean_data</span><span class="o">$</span><span class="n">Time</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clean_data</span><span class="o">$</span><span class="n">`Temperature(C)`</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">fila</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fila_for</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">columna</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">columna_for</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>

<span class="w">    </span><span class="c1">#Agrego las nuevas filas recien creadas a mi tabla en donde guardo los datos parseados</span>
<span class="w">    </span><span class="n">dt_parsed_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span>
<span class="p">}</span>

<span class="c1">#Escribo los datos en una nueva tabla llamada "02_datos_filtermax_parseados_NUEVO.tsv"</span>
<span class="nf">write.table</span><span class="p">(</span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
</code></pre></div>
<p>Pueden comparar <strong>02_datos_filtermax_parseados.tsv</strong> con <strong>02_datos_filtermax_parseados_NUEVO.tsv</strong> y si todo salió bien deberían ser idénticos.</p>
<h2 id="bibliografia"><strong>Bibliografía</strong></h2>
<!--
### :material-bookshelf: Libros
* Libro 1 
* Libro 2
-->

<!--
### :material-web: Online
* Online 1 
* Online 2 https://en.wikipedia.org/wiki/R_(programming_language)
-->

<h3 id="consola-de-r"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"></path></svg></span> Consola de R</h3>
<ul>
<li>Comando <code>help()</code></li>
</ul></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Area Bioinformática UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>