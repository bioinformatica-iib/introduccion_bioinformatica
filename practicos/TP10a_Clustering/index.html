
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Sitio Web del Curso Introducción a la Bioinformática">
      
      
      
        <link rel="canonical" href="https://bioinformatica-iib.github.io/introduccion_bioinformatica/practicos/TP10a_Clustering/">
      
      <link rel="icon" href="../../img/logo-unsam-negro.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.5.10">
    
    
      
        <title>Index - Introducción a la Bioinformática</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cabin";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tp-12a-data-mining-clustering" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Introducción a la Bioinformática" class="md-header__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introducción a la Bioinformática
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../acerca/" class="md-tabs__link">
      Acerca de
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contenidos/" class="md-tabs__link">
      Contenidos
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cronograma/" class="md-tabs__link">
      Cronograma
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../docentes/" class="md-tabs__link">
      Docentes
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../teoricas/inicio/" class="md-tabs__link">
        Teóricas
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../inicio/" class="md-tabs__link">
        Prácticos
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../instructivos/inicio/" class="md-tabs__link">
        Instructivos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introducción a la Bioinformática" class="md-nav__button md-logo" aria-label="Introducción a la Bioinformática" data-md-component="logo">
      
  <img src="../../img/logo-unsam-negro.png" alt="logo">

    </a>
    Introducción a la Bioinformática
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../acerca/" class="md-nav__link">
        Acerca de
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contenidos/" class="md-nav__link">
        Contenidos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cronograma/" class="md-nav__link">
        Cronograma
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../docentes/" class="md-nav__link">
        Docentes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teóricas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teóricas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teóricas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/1-Teorica-Uno/" class="md-nav__link">
        Teórica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/2-Teorica-Dos/" class="md-nav__link">
        Teórica 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/3-Teorica-Tres/" class="md-nav__link">
        Teórica 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/4-Teorica-Cuatro/" class="md-nav__link">
        Teórica 4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/5-Teorica-Cinco/" class="md-nav__link">
        Teórica 5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/6-Teorica-Seis/" class="md-nav__link">
        Teórica 6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/7-Teorica-Siete/" class="md-nav__link">
        Teórica 7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/8-Teorica-Ocho/" class="md-nav__link">
        Teórica 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoricas/9-Teorica-Nueve/" class="md-nav__link">
        Teórica 9
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Prácticos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Prácticos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP01_Linux/" class="md-nav__link">
        TP 1 - Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP02_EMBOSS/" class="md-nav__link">
        TP 2 - EMBOSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP03_Alineamientos/" class="md-nav__link">
        TP 3 - Alineamientos de a pares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP04_Busqueda_por_similitud/" class="md-nav__link">
        TP 4 - Búsqueda por similitud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP05a_R/" class="md-nav__link">
        TP 5a - R - Introduccion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP05b_R/" class="md-nav__link">
        TP 5b - R - Aplicación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP06_PSI-BLAST/" class="md-nav__link">
        TP 6 - PSI-BLAST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP07_Desorden/" class="md-nav__link">
        TP 7 - Predicción de Desorden
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP08_Motivos/" class="md-nav__link">
        TP 8 - Motivos Lineales
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP09a_Modelado_Por_Homologia/" class="md-nav__link">
        TP 9a - Modelado por Homología
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TP09b_AlphaFold/" class="md-nav__link">
        TP 9b - Modelado usando AlphaFold
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Instructivos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instructivos" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Instructivos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/inicio/" class="md-nav__link">
        Inicio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/maquina_virtual/" class="md-nav__link">
        Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/problemasVM/" class="md-nav__link">
        Problemas instalando la Máquina Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../instructivos/tipsVM/" class="md-nav__link">
        Tips and Tricks para usar la Máquina Virtual más cómodos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><p><a class="glightbox" href="img/clustering2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img _="," align="left" alt="Image" src="img/clustering2.png" width="250"></a></p>
<h1 id="tp-12a-data-mining-clustering" markdown="markdown"><strong>TP 12a</strong>. Data Mining - Clustering</h1>
<p><br>
<br></p>
<p><a class="md-button md-button--primary" href="https://drive.google.com/file/d/1zT1Qt_BgAxqtDTYxBTRK5uqoIMA1EXRw/view?usp=sharing"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"></path></svg></span> Materiales</a></p>
<!--
Este es el botón para descargar materiales, en (#) hay que agregar el link correspondiente
-->

<h3 id="slides-mostrados-en-la-clase">Slides mostrados en la clase</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"></path></svg></span> <a href="https://drive.google.com/file/d/1Eh_u3qKrqPI8AgOggD_qW_CvXjk_vNfT/view?usp=sharing">Introducción Clustering Jerárquico</a></li>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"></path></svg></span> <a href="https://drive.google.com/file/d/17JlDGAwSoU8ynugUjD-nOSqThE2HOKPC/view?usp=sharing">Cierre TP</a></li>
</ul>
<h3 id="videos-de-la-clase-grabada">Videos de la clase grabada</h3>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=lmfJhns31fo">Introducción al TP</a></li>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 0 1 .379-.215l4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559z"></path></svg></span> <a href="https://www.youtube.com/watch?v=gkZ0wE_vdfA">Cierre TP</a></li>
</ul>
<h3 id="software-a-usar">Software a usar</h3>
<ul>
<li>R (ya instalado en la VM).</li>
<li>RStudio (ya instalado en la VM)</li>
</ul>
<h3 id="recursos-online">Recursos Online</h3>
<ul>
<li>Introducción a <strong>R</strong>, <strong>TP 8</strong> de esta materia: <a href="../TP08a_R">Parte 1</a> y <a href="../TP08b_R">Parte 2</a></li>
<li><a href="https://www.datanovia.com/en/lessons/agglomerative-hierarchical-clustering/">Clustering jerárquico en <strong>R</strong></a></li>
<li><a href="https://www.cienciadedatos.net/documentos/37_clustering_y_heatmaps#Average_silhouette_method">Detalles del cálculo de Silhouette (y mucho más)</a></li>
</ul>
<h3 id="objetivos">Objetivos</h3>
<ul>
<li>Familiarizarse con el funcionamiento del <em>clustering jerárquico aglomerativo</em>.</li>
<li>Familiarizarse con el método de clustering particional <em>K-means</em>.</li>
<li>Explorar algunas medidas de calidad de los clusters, como la silueta o <em>silhouette</em>.</li>
</ul>
<h2 id="introduccion-al-tema"><strong>Introducción al Tema</strong></h2>
<p>Hoy vamos a retomar el trabajo con <strong>R</strong>. Recomendamos repasar o tener a mano el <strong>TP 8</strong> de esta materia por si necesitan recordar como hacer ciertos comandos (<a href="../TP08a_R">Parte 1</a> y <a href="../TP08b_R">Parte 2</a>).</p>
<p>Como mencionamos en el <strong>TP 8</strong>, es cada vez más normal que experimentos biológicos nos permitan analizar miles a millones de interacciones biológicas a la vez, lo que resulta en tablas con millones de datos. Esto hace necesario entonces saber utilizar herramientas que nos permitan extraer, o <em>minar</em>, información de estos enormes conjuntos de datos. A este proceso lo vamos a denominar <em>Data Mining</em>.</p>
<p>En este TP nos vamos a enfocar en métodos de clustering, los cuales nos permiten agrupar elementos analizados en base a datos observados sobre ellos. Esto tiene muchas utilidades, como puede ser entender mejor las diferencias entre grupos conocidos, encontrar diferentes grupos dentro del conjunto datos analizado, o remover datos redundantes, entre otros.</p>
<p>Si bien este TP vamos a enfocarnos más que nada en aprender las técnicas, el objetivo final de este proceso es identificar agrupamientos naturales en los datos con alguna relevancia biológica.</p>
<h2 id="ejercicio-1-clustering-jerarquico-manual" markdown="markdown"><strong>Ejercicio 1 - Clustering Jerárquico Manual</strong></h2>
<p>Para empezar este TP vamos a realizar un pequeño <em>clustering jerárquico</em> a mano para repasar el concepto.</p>
<p>Supongamos que tenemos cuatro genes (A, B, C y D) para los cuales medimos el nivel de expresión a las 0hs, 1hs y 2hs luego de algún tratamiento:</p>
<figure>
<table>
<thead>
<tr>
<th data-sort-method="none" style="text-align: center;">gen</th>
<th data-sort-method="none" style="text-align: center;">t_0h</th>
<th data-sort-method="none" style="text-align: center;">t_1h</th>
<th data-sort-method="none" style="text-align: center;">t_2h</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">genA</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: center;">genB</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-2</td>
</tr>
<tr>
<td style="text-align: center;">genC</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">genD</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-6</td>
</tr>
</tbody>
</table>
</figure>
<p>Queremos entonces agrupar a los diferentes genes por como varían sus niveles de expresión cuando se aplica dicho tratamiento. Para hacer esto vamos a:</p>
<ul>
<li>Calcular la distancia euclidiana entre los diferentes genes</li>
<li>Construir una matriz de distancias</li>
<li>Agruparlos usando <em>clustering jerárquico</em> donde el criterio de agregación va a ser "vecino más lejano" o <em>complete linkage</em></li>
<li>Repetir todo lo anterior, pero estandarizando previamente los datos de niveles de expresión</li>
</ul>
<p>Si no entienden algunos de estos conceptos pueden leer un poco más sobre ellos a continuación (y más todavía en la teórica):</p>
<details class="info">
<summary>Distancia euclidiana</summary>
<p>Es una de las varias formas de calcular una distancia entre dos vectores de datos, lo cual es necesario al momento de calcular una matriz de distancias. Por ejemplo, suponiendo que tenemos 2 vectores de forma <span class="arithmatex">\(V = (x, y, z)\)</span> la distancia euclidiana entre ellos se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclidiana(V_1, V_2) = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2}
\]</div>
<p>Aplicando esto a nuestros datos, la distancia entre los genes A y B se calcula como:</p>
<div class="arithmatex">\[
distanciaEuclidiana(genA, genB) = \sqrt{(2 - (-1))^2 + (4 - (-1))^2 + (8 - (-2))^2} = 11,58
\]</div>
</details>
<details class="info">
<summary>Matriz de distancias</summary>
<p>Es una matriz donde tanto las filas como las columnas representan un mismo conjunto de elementos y en cada intersección se pone la distancia (en nuestro caso euclidiana) entre dos elementos específicos. Es la base de muchos métodos de clustering.</p>
<p>Para nuestros datos la matriz de distancias entre los cuatro genes es:</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th data-sort-method="none" style="text-align: center;">genA</th>
<th data-sort-method="none" style="text-align: center;">genB</th>
<th data-sort-method="none" style="text-align: center;">genC</th>
<th data-sort-method="none" style="text-align: center;">genD</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">genA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genB</td>
<td style="text-align: center;">11,58</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genC</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">3,32</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">genD</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">4,12</td>
<td style="text-align: center;">7,35</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p>Como el orden de los elementos es igual para las filas que para las columnas, en la diagonal se compara cada elemento contra sí mismo por lo que la distancia es 0. Por otro lado, estamos llenando solo la mitad de la matriz ya que las matrices de distancia son matrices simétricas, es decir, que el triángulo superior derecho de la matriz va a ser un reflejo del triángulo inferior izquierdo.</p>
</details>
<details class="info">
<summary>Clustering jerárquico</summary>
<p>El <em>clustering jerárquico</em> es una forma de agrupar elementos dependiendo de que tan similares son entre ellos. Usa un algoritmo bastante sencillo de entender que se basa en una matriz de distancias:</p>
<ol>
<li>
<p>Sin considerar a la diagonal, encontrar el par de elementos (fila, columna) que son más similares entre sí (el menor número en la matriz de distancias). En nuestra matriz de distancias los elementos más parecidos son <strong>"genB"</strong> y <strong>"genC"</strong> ya que tienen la menor similitud (3,32)</p>
</li>
<li>
<p>Dejar constancia de dicha similitud y reconstruir la matriz, reemplazando ambos elementos por uno nuevo (saco los elementos <strong>"genB"</strong> y <strong>"genC"</strong> y agrego el elemento <strong>"genB+C"</strong>)</p>
</li>
<li>
<p>Al momento de calcular la nueva distancia entre este nuevo elemento (<strong>"genB+C"</strong>) y el resto de los elementos de la matriz, usar algún criterio de agregación (por ejemplo: <em>single linkage</em>, <em>average linkage</em> o <em>complete linkage</em>)</p>
</li>
<li>
<p>Volver al paso 1 hasta que todos los elementos estén unidos entre sí</p>
</li>
</ol>
<p>Una vez hecho esto puedo dibujar el <em>clustering jerárquico</em> teniendo en cuenta qué elementos se juntaron con qué elementos.</p>
</details>
<details class="info">
<summary>Criterios de agregación</summary>
<p>Los criterios de agregación indican que operación hay que hacer al momento de calcular la distancia entre un nuevo elemento creado en una matriz de distancias y los ya existentes. Cada uno tiene sus ventajas y desventajas.</p>
<p>Siguiendo con nuestro ejemplo, si queremos calcular la distancia entre el nuevo elemento <strong>"genB+C"</strong> y el <strong>"genA"</strong>:</p>
<ul>
<li><strong>Single Linkage:</strong> la nueva distancia es la <strong><em>menor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Complete Linkage:</strong> la nueva distancia es la <strong><em>mayor</em></strong> entre las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
<li><strong>Average Linkage:</strong> la nueva distancia es el <strong><em>promedio</em></strong> de las distancias <span class="arithmatex">\(dist(genA, genB)\)</span> y <span class="arithmatex">\(dist(genA, genC)\)</span></li>
</ul>
</details>
<ol>
<li>
<p>Para agilizar un poco este Ejercicio les vamos a dar una planilla de Google Sheets que contiene la base de lo que vamos a necesitar. Abran <a href="https://docs.google.com/spreadsheets/d/1RBQNAsE1N6PPfKLWCqtYuuiYVqlTcPUQeeQX3PZmre8/edit?usp=sharing">esta planilla de Google Sheets</a> y hagan una copia. Leyendo la siguiente información, traten de entender que hacen las diferentes partes de dicha planilla (desde ya, hay partes vacías que vamos a completar).</p>
<ul>
<li>
<p>Pestaña <strong>Plot Señal</strong></p>
<ul>
<li><strong>Columnas A - D:</strong> contienen nuestros datos</li>
<li><strong>Columnas F y G:</strong> contienen el promedio y la desviación estándar de cada gen (vacío, ahora lo hacemos)</li>
<li><strong>Columnas I - L:</strong> contienen nuestros datos estandarizados (vacío, ahora lo hacemos)</li>
<li><strong>Plot izquierdo:</strong> plot de la evolución de los niveles de expresión a los 3 tiempos para los 4 genes</li>
<li><strong>Plot derecho:</strong> plot de la evolución de los niveles de expresión estandarizados a los 3 tiempos para los 4 genes (se hace solo al llenar datos)</li>
</ul>
</li>
<li>
<p>Pestaña <strong>Clustering</strong></p>
<ul>
<li><strong>Columnas A - D:</strong> contienen nuestros datos</li>
<li><strong>Columnas F - J:</strong> contienen el cálculo de las distancias euclidianas entre las filas</li>
<li><strong>Columnas L - P:</strong> contienen la matriz de distancias para nuestros datos (y matrices más chicas donde se van a ir escribiendo los varios pasos al hacer el clustering a mano)</li>
</ul>
</li>
<li>
<p>Pestaña <strong>Clustering Estandarizado</strong></p>
<ul>
<li>Igual que <strong>Clustering</strong>, pero para datos estandarizados (vacío, ahora lo hacemos)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Mirando el <strong>Plot izquierdo</strong> de la pestaña <strong>Plot Señal</strong>, ¿de qué forma les parece que se van a agrupar los cuatro genes en el <em>clustering jerárquico</em>?</p>
</li>
<li>
<p>Ahora vamos a calcular el <em>clustering jerárquico</em>:</p>
<ol>
<li>
<p>Vayan a la pestaña <strong>Clustering</strong>. Usando la matriz de distancias ubicada en las <strong>Columnas L - P</strong>, calculen a mano el <em>clustering jerárquico</em> para nuestros datos usando <em>complete linkage</em>.</p>
</li>
<li>
<p>Hagan un esquema del dendrograma o árbol de similitud que resulta de este clustering. Pueden usar la herramienta <strong>Dibujo</strong> de Google Sheets (no se preocupen por el largo de las ramas, solo nos importa cómo se unen los genes).</p>
</li>
<li>
<p>¿Dio similar a lo que habían propuesto en el punto <strong>2</strong>?</p>
</li>
</ol>
</li>
<li>
<p>Queremos ahora calcular nuestros datos estandarizados donde vamos a estandarizar por gen, restándole a cada dato el promedio de los tres tiempos para ese gen y dividiendo el resultado por la desviación estándar de los tres tiempos para ese gen. Es decir:</p>
<div class="arithmatex">\[
datoEstandarizado(genA, t_0) = \frac{dato(genA, t_0) - promedio(genA)}{desviacionEstandar(genA)}
\]</div>
<p>Para hacer esto:</p>
<ol>
<li>
<p>En la pestaña <strong>Plot Señal</strong>, completen las <strong>columnas F y G</strong> para que calculen el promedio y la desviación estándar para los tres tiempos de cada uno de los cuatro genes.</p>
</li>
<li>
<p>En la pestaña <strong>Plot Señal</strong>, completen las <strong>columnas J a L</strong> para que calculen los valores estandarizados de los datos en base a la fórmula anterior.</p>
<details class="tip">
<summary>Tip - Copiar y pegar una fórmula en Google Sheets manteniendo una parte constante</summary>
<p>En Google Sheets, así como en Excell y otras hojas de cálculo, es posible "arrastrar" una fórmula, por lo que podrían calcular el dato estandarizado para un solo número (por ejemplo celda <strong>J2</strong>) y luego copiar dicha fórmula al resto de las celdas.</p>
<p>Sin embargo, de usar este método para calcular los valores estandarizados tendríamos problemas, ya que se movería también la referencia en la fórmula a las celdas del promedio y la desviación estándar (las cuales queremos que se muevan con la fórmula para abajo, pero no para la derecha).</p>
<p>Por suerte es posible controlar esto agregándole el símbolo <strong>$</strong> adelante de la fila o columna. Es decir, si la fórmula apunta a <strong>F2</strong> y no queremos que se mueva horizontalmente (es decir, no queremos que cambie la <strong>F</strong>), podemos agregar el símbolo <strong>$</strong> en la fórmula con lo que quedaría <strong>$F2</strong>. Si ahora arrastramos (o copiamos y pegamos) dicha fórmula, el <strong>2</strong> puede cambiar, pero la <strong>F</strong> se va a mantener siempre como <strong>F</strong>.</p>
</details>
</li>
<li>
<p>Una vez calculados los datos estandarizados debería aparecerles el plot en el <strong>Plot derecho</strong>. ¿De qué forma les parece que se van a agrupar los cuatro genes en el <em>clustering jerárquico</em> usando los datos estandarizados?</p>
</li>
</ol>
</li>
<li>
<p>El próximo paso es calcular la matriz de distancias para nuestros datos estandarizados:</p>
<ol>
<li>
<p>Copien los datos recién calculados a la pestaña <strong>Clustering Estandarizado</strong> (tengan en cuenta al copiar y pegar los datos que queremos los valores, no las fórmulas).</p>
</li>
<li>
<p>En la <strong>columna J</strong>, calculen las distancias euclidianas entre los diferentes genes.</p>
</li>
<li>
<p>Copien a mano las distancias recién calculadas a las posiciones correspondientes de la matriz de distancias en las <strong>Columnas L - P</strong>.</p>
</li>
</ol>
</li>
<li>
<p>Por último vamos a calcular el <em>clustering jerárquico</em> para nuestros datos estandarizados:</p>
<ol>
<li>
<p>Asegúrense que están en la pestaña <strong>Clustering Estandarizado</strong>. Usando la matriz de distancias ubicada en las<br>
<strong>Columnas L - P</strong>, calculen a mano el <em>clustering jerárquico</em> para nuestros datos estandarizados usando <em>complete linkage</em>.</p>
</li>
<li>
<p>Hagan un esquema del dendrograma o árbol de similitud que resulta de este clustering. Pueden usar la herramienta <strong>Dibujo</strong> de Google Sheets (no se preocupen por el largo de las ramas, solo nos importa cómo se unen los genes).</p>
</li>
<li>
<p>¿Dio similar a lo que habían propuesto en el punto <strong>4.c</strong>?</p>
</li>
</ol>
</li>
<li>
<p>Comparando los clusterings obtenidos con los datos estandarizados y sin estandarizar.</p>
<ol>
<li>¿Qué diferencias observan?</li>
<li>¿Cuál de los dos clusterings les parece mejor para este escenario donde queríamos evaluar cómo afecta un tratamiento los niveles de expresión de diferentes genes?</li>
<li>¿Les parece qué es siempre correcto estandarizar los datos de esta forma o se les ocurre escenarios donde no es así?</li>
</ol>
</li>
</ol>
<h2 id="ejercicio-2-clustering-jerarquico-con-r" markdown="markdown"><strong>Ejercicio 2 - Clustering Jerárquico con R</strong></h2>
<p>En este Ejercicio vamos a hacer lo mismo que hicimos en el <strong>Ejercicio 1</strong>, pero ahora lo vamos a hacer usando <strong>R</strong>. Les recomendamos que creen un script nuevo donde vayan poniendo las diferentes líneas de código que van ejecutando.</p>
<h3 id="datos-sin-estandarizar">Datos sin estandarizar</h3>
<h4 id="leer-los-datos">Leer los datos</h4>
<p>Los datos originales los tienen en el archivo <strong>tabla_ejemplo.tsv</strong> que se encuentra en sus materiales de trabajo.</p>
<p><strong>1)</strong> Usen la función <code>fread</code> para cargar los datos de <strong>tabla_ejemplo.tsv</strong> en una nueva variable llamada <code>dt_tabla_ejemplo</code> (recuerden que van a tener que cargar el paquete <code>data.table</code> y setear el <em>working directory</em>)</p>
<h4 id="pasar-los-datos-a-una-matriz" markdown="markdown">Pasar los datos a una matriz</h4>
<p>Queremos crear una matriz de distancias, las cuales se calculan usando la función <code>dist</code>. Para que la matriz de distancias tenga los nombres de los genes en las filas y columnas necesitamos que la tabla que le pasemos también cumpla esta condición, cosa que los <em>Data Tables</em> no hacen (ya que no pueden tener nombres en las filas).</p>
<p>Por esta razón vamos a transformar nuestro <em>Data Table</em> en una matriz. En <strong>R</strong> las matrices son un tipo de variable (<em>matrix</em>) y son básicamente vectores de dos dimensiones. Hay varias formas de crear una matriz, por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="n">matriz_ejemplo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>

<span class="c1">#Si quisieramos ver por consola algun dato de la matriz podemos hacer:</span>
<span class="n">matriz_ejemplo</span><span class="w"> </span><span class="c1">#imprimo toda la matriz</span>
<span class="n">matriz_ejemplo</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1">#imprimo la primera fila</span>
<span class="n">matriz_ejemplo</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="c1">#imprimo la primera columna</span>
<span class="n">matriz_ejemplo</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="c1">#imprimo el elemento ubicado en la fila 2 y la columna 3</span>
</code></pre></div>
<p>Ahora bien, en nuestro caso no queremos crear una matriz de 0, sino que queremos transformar nuestro <em>Data Table</em> en una matriz, para lo cual tenemos que hacer:</p>
<div class="highlight"><pre><span></span><code><span class="n">matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dt_tabla_ejemplo</span><span class="p">,</span><span class="w"> </span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>rownames = 1</code> le está indicando a <strong>R</strong> que los valores de la primera columna de <code>dt_tabla_ejemplo</code> van a ser usados como los nombres de cada fila de la matriz.</p>
<p><strong>2)</strong> Corran el código anterior (sin el ejemplo) e impriman <code>matriz_datos</code> por consola. Van a ver que es similar a como se imprimía el <em>Data Table</em>, solo que las filas tienen nombre. Traten ahora de acceder a los valores de la primera columna de <code>matriz_datos</code>, ¿cómo tienen que hacer para lograrlo?</p>
<h4 id="crear-la-matriz-de-distancias" markdown="markdown">Crear la matriz de distancias</h4>
<p>Ahora que tenemos una matriz con los nombres de los genes en las filas y las columnas, queremos usar la función <code>dist</code> para calcular la matriz de distancias. El código es:</p>
<div class="highlight"><pre><span></span><code><span class="n">matriz_distancias</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dist</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"euclidean"</span><span class="p">,</span><span class="w"> </span><span class="n">diag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>method = "euclidean"</code> le está diciendo a la función <code>dist</code> que tiene que calcular las distancias euclidianas entre filas y <code>diag = T</code> hace que deje la diagonal de ceros en el output.</p>
<p><strong>3)</strong> Corran el código anterior e impriman <code>matriz_distancias</code> por consola. ¿Coinciden los datos con la matriz de distancias vista en el <strong>Ejercicio 1</strong>?</p>
<h4 id="hacer-el-clustering-jerarquico" markdown="markdown">Hacer el clustering jerárquico</h4>
<p>El <em>clustering jerárquico</em> se hace con la función <code>hclust</code>, la cual se usa:</p>
<div class="highlight"><pre><span></span><code><span class="n">clustering_jerarquico</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hclust</span><span class="p">(</span><span class="n">matriz_distancias</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"complete"</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>method = "complete"</code> está indicándole a la función que criterio de agregación usar al momento de combinar elementos. Pueden usar <code>help(hclust)</code> para ver otros posibles criterios.</p>
<p><strong>4)</strong> Corran el código anterior e impriman <code>clustering_jerarquico</code> por consola. ¿Da alguna información útil a simple vista?</p>
<p><strong>5)</strong> Usen la función <code>plot</code> para plotear <code>clustering_jerarquico</code>. Usen el parámetro <code>main</code> para cambiarle el título al plot indicando que es un <em>clustering jerárquico</em>, que usa <em>complete linkage</em> y que usa datos sin estandarizar.</p>
<h4 id="asignando-clusters">Asignando clusters</h4>
<p>Cuando uno mira el árbol creado en el punto <strong>5)</strong> es común detectar que ciertos genes son más similares entre sí que otros y suponer que entonces pertenecen a un mismo grupo. Esto se puede calcular computacionalmente "cortando" el árbol usando un cierto umbral de similitud y agrupando en un mismo <em>cluster</em> a aquellos elementos que queden por debajo de ese umbral.</p>
<p>Esto se puede hacer de dos formas, o determinando el umbral de similitud o determinando la cantidad de <em>clusters</em> a crear.</p>
<div class="highlight"><pre><span></span><code><span class="n">clusters_porAltura</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cutree</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
<span class="n">clusters_porCantidad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cutree</span><span class="p">(</span><span class="n">clustering_jerarquico</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@@</span><span class="n">EDITAR</span><span class="o">@@</span><span class="p">)</span>
</code></pre></div>
<p>Donde <code>h</code> es el parámetro que recibe la altura de similitud a la cual cortar (eje y en el plot anterior) y <code>k</code> es el parámetro que recibe la cantidad de <em>clusters</em> a crear. Hay que usar uno o el otro.</p>
<p><strong>6)</strong> Basándose en el plot creado en el punto <strong>5)</strong>, corran el código anterior cambiando <code>@@EDITAR@@</code> por el número correspondiente para agrupar los genes como le parezca mejor. Impriman las variables <code>clusters_porAltura</code> y <code>clusters_porCantidad</code> para confirmar que los genes se agruparon como ustedes querían.</p>
<details class="info">
<summary>Extraer esta información a un Data Table</summary>
<p>La variable <code>clusters_porAltura</code> es un vector con nombres, por lo que si quisiéramos extraer su información y guardarla en un <em>Data Table</em>, tendríamos que hacer:</p>
<div class="highlight"><pre><span></span><code><span class="n">dt_clusters_porAltura</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.table</span><span class="p">(</span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">genes_clusters_porAltura</span><span class="p">),</span>
<span class="w">                                    </span><span class="n">cluster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes_clusters_porAltura</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="datos-estandarizados">Datos estandarizados</h3>
<h4 id="estandarizar-los-datos">Estandarizar los datos</h4>
<p>El primer paso para trabajar con estos datos es estandarizarlos como hicimos en el <strong>Ejercicio 1</strong>. Si bien podríamos calcular a mano el promedio (función <code>mean</code>) y la desviación estandar (función <code>sd</code>) de cada fila y luego hacer las cuentas, existe ya en <strong>R</strong> una función que hace esta estandarización por nosotros.</p>
<p>Esta función es <code>scale</code>, pero un problema que tenemos es que dicha función estandariza por columna, no por fila. Por suerte es bastante fácil en <strong>R</strong> transponer una matriz (lo que básicamente cambia filas por columnas y viceversa). Esto se hace usando la función <code>t</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Transpongo la matriz de datos</span>
<span class="n">t_matriz_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span><span class="w"> </span>

<span class="c1">#Estandarizo los datos por columna (que ahora son los tres tiempos de cada gen)</span>
<span class="c1">#*scale* va a devolver una variable que tiene mas informacion que una matriz, pero funciona como matriz</span>
<span class="n">t_matriz_datos_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">t_matriz_datos</span><span class="p">)</span><span class="w"> </span>

<span class="c1">#Vuelvo a transponer la matriz, lo cual la pone en el orden de antes, ahora estandarizada</span>
<span class="n">matriz_datos_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">t_matriz_datos_ST</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
<p><strong>7)</strong> Corran el código anterior e impriman <code>matriz_datos_ST</code> por consola. ¿Coinciden los datos estandarizados con los obtenidos en el <strong>Ejercicio 1</strong>?</p>
<h4 id="hacer-el-resto-del-analisis">Hacer el resto del análisis</h4>
<p><strong>8)</strong> Vuelvan a hacer los pasos <strong>3)</strong> a <strong>6)</strong> usando la nueva matriz de datos estandarizados, <code>matriz_datos_ST</code>. Vayan creando nuevas variables en cada caso para no sobrescribir las anteriores (recomendamos usar los mismos nombres y agregarles el sufijo <code>_ST</code>).</p>
<h2 id="ejercicio-3-k-means-y-silhouette" markdown="markdown"><strong>Ejercicio 3 - K-means y Silhouette</strong></h2>
<h3 id="k-means">K-means</h3>
<p>Otro método muy popular para agrupar elementos es el <em>K-means</em>. A diferencia del <em>clustering jerárquico</em>, éste no crea un árbol de similitud, sino que utiliza un método iterativo para asignar directamente cada elemento a diferentes grupos. Otra característica del <em>K-means</em> es que hay que pasarle el número de clusters a crear.</p>
<p>La función <code>kmeans</code> viene con <strong>R</strong> y se usa:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Esta funcion controla el aspecto azaroso de kmeans para que nos de igual a todos</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">#Corro la funcion kmeans para los datos sin estandarizar pidiendole 2 clusters</span>
<span class="n">clustering_kmeans_k2_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">kmeans</span><span class="p">(</span><span class="n">matriz_datos_ST</span><span class="p">,</span><span class="w"> </span><span class="n">centers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>

<span class="c1">#Extraigo los clusters calculados</span>
<span class="n">clusters_kmeans_k2_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">clustering_kmeans_k2_ST</span><span class="o">$</span><span class="n">cluster</span>
</code></pre></div>
<p>Donde <code>centers = 2</code> le está diciendo a la función que cree 2 clusters (lo que estoy indicando en el nombre de la variable con <strong>_k2</strong> para que no haya confusión más adelante).</p>
<div class="admonition tip">
<p class="admonition-title">Tip - Predeterminar el azar</p>
<p>La función <code>kmeans()</code> genera la primera posición de sus centros al azar. Esto hace que si la corren varias veces o en diferentes computadoras va a dar diferentes resultados cada vez. Esto se puede controlar con una función de <strong>R</strong> que asigna a mano el valor de la <em>seed</em>, que es el número base que usa <strong>R</strong> al momento de generar azar. Si les interesa hacer esto tienen que ejecutar la siguiente línea antes de usar la función <code>kmeans()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p>P.D.: El azar en las computadoras no existe realmente. Muchos programas usan lista pre-generadas de "números creados al azar" y otras usan cosas como "el quinto decimal de la temperatura del procesador en este momento", lo que se aproxima suficientemente al azar para funcionar bien.</p>
</div>
<p><strong>1)</strong> Corran el código anterior y comparen estos clusters a los obtenidos para los datos estandarizados en el <strong>Ejercicio 2</strong> usando <em>clustering jerárquico</em>.</p>
<h3 id="silhouette">Silhouette</h3>
<p>Para cada elemento presente en un agrupamiento se puede calcular un <em>Silhouette coeficient</em>, el cual es un número entre -1 y 1 que indica que tan similar es dicho elemento a otros elementos de su mismo <em>cluster</em> y que tan diferente es dicho elemento a los elementos de otros <em>clusters</em>. Cuanto más cerca de 1, mejor asignado esta dicho elemento en su <em>cluster</em>.</p>
<p>Es posible entonces calcular el promedio de los <em>Silhouette coefficients</em> de todos los elementos presentes en un agrupamiento, donde promedios más cercanos a 1 van a indicar que el agrupamiento general es mejor.</p>
<p>Este método tiene bastantes usos, pero uno de los más comunes es definir cuál es el número ideal de clusters a crear con <em>K-means</em>. </p>
<!--
La función `silhouette` no viene por defecto con **R**. Corran el siguiente código para instalar el paquete `cluster`:

<div class="highlight"><pre><span></span><code><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;cluster&quot;</span><span class="p">)</span>
</code></pre></div>
-->

<p>En <strong>R</strong> Esta función se usa:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span><span class="w"> </span><span class="c1">#paquete que contiene la funcion silhouette()</span>

<span class="c1">#Calculo los silhouette coefficients para los datos estandarizados agrupados en 2 clusters usando kmeans </span>
<span class="c1">#Tengo que pasarle tambien la matriz de distancias correspondiente para que pueda calcular similitud entre elementos</span>
<span class="n">silhouette_kmeans_k2_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">silhouette</span><span class="p">(</span><span class="n">clusters_kmeans_k2_ST</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matriz_distancias_ST</span><span class="p">)</span>

<span class="c1">#La funcion *silhouette* saca los nombres de las filas, por lo cual ahora mis genes estan como numeros</span>
<span class="c1">#Para recuperar los nombres de las filas (o *rownames*) hago lo siguiente</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">silhouette_kmeans_k2_ST</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">matriz_datos_ST</span><span class="p">)</span>

<span class="c1">#Podemos plotear los silhouette coefficients con plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">silhouette_kmeans_k2_ST</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"STD - Kmeans - centers = 2"</span><span class="p">)</span>

<span class="c1">#Y podemos extraer el promedio de los *Silhouette coefficients*</span>
<span class="n">promedio_silhouette_kmeans_k2_ST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">silhouette_kmeans_k2_ST</span><span class="p">)[[</span><span class="m">1</span><span class="p">]][[</span><span class="s">"Mean"</span><span class="p">]]</span>
</code></pre></div>
<p><strong>2)</strong> Corran el código anterior y vean su salida.</p>
<p><strong>3)</strong> Basándose en los códigos usados en <strong>1)</strong> y en <strong>2)</strong>, vuelvan a agrupar a los cuatro genes en base a sus datos estandarizados pero ahora en 3 clusters. Luego ploteen los <em>Silhouette coefficients</em> de este agrupamiento y calculen su promedio. Guarden estos nuevos datos en variables con diferentes nombres que las anteriores.</p>
<p><strong>4)</strong> Comparando lo obtenido en los puntos anteriores, ¿qué número de <em>clusters</em> resulta en un mejor promedio para los <em>Silhouette coefficients</em>? ¿coincide esto con lo observado en el dendrograma hecho a partir del <em>clustering jerárquico</em>?</p>
<h2 id="bibliografia"><strong>Bibliografía</strong></h2>
<!--
### :material-bookshelf: Libros
* Libro 1 
* Libro 2
-->

<!--
### :material-web: Online
* Online 1 
* Online 2 https://en.wikipedia.org/wiki/R_(programming_language)
-->

<h3 id="consola-de-r"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"></path></svg></span> Consola de R</h3>
<ul>
<li>Comando <code>help()</code></li>
</ul></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Area Bioinformática UNSAM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.tracking", "navigation.tabs", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>